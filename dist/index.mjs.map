{"version":3,"sources":["../src/schemas.ts","../src/auth.ts","../src/capture.ts","../src/compare.ts","../src/session.ts","../src/report.ts","../src/consistency.ts","../src/crawl.ts","../src/integration.ts","../src/index.ts"],"names":["chromium","mkdir","dirname","readFile","writeFile","join","browser","URL","path","page","stat"],"mappings":"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","file":"index.mjs","sourcesContent":["import { z } from 'zod';\n\n/**\n * Viewport configuration for screenshot capture\n * Supports predefined names or custom dimensions\n */\nexport const ViewportSchema = z.object({\n  name: z.string().min(1).max(50),\n  width: z.number().min(320).max(3840),\n  height: z.number().min(480).max(2160),\n});\n\n/**\n * Predefined viewport configurations\n */\nexport const VIEWPORTS = {\n  desktop: { name: 'desktop', width: 1920, height: 1080 },\n  'desktop-lg': { name: 'desktop-lg', width: 2560, height: 1440 },\n  'desktop-sm': { name: 'desktop-sm', width: 1440, height: 900 },\n  laptop: { name: 'laptop', width: 1366, height: 768 },\n  tablet: { name: 'tablet', width: 768, height: 1024 },\n  'tablet-landscape': { name: 'tablet-landscape', width: 1024, height: 768 },\n  mobile: { name: 'mobile', width: 375, height: 667 },\n  'mobile-lg': { name: 'mobile-lg', width: 414, height: 896 },\n  'iphone-14': { name: 'iphone-14', width: 390, height: 844 },\n  'iphone-14-pro-max': { name: 'iphone-14-pro-max', width: 430, height: 932 },\n} as const;\n\n/**\n * Main configuration for InterfaceBuiltRight\n */\nexport const ConfigSchema = z.object({\n  baseUrl: z.string().url('Must be a valid URL'),\n  outputDir: z.string().default('./.ibr'),\n  viewport: ViewportSchema.default(VIEWPORTS.desktop),\n  viewports: z.array(ViewportSchema).optional(), // Multi-viewport support\n  threshold: z.number().min(0).max(100).default(1.0),\n  fullPage: z.boolean().default(true),\n  waitForNetworkIdle: z.boolean().default(true),\n  timeout: z.number().min(1000).max(120000).default(30000),\n});\n\n/**\n * Session query options\n */\nexport const SessionQuerySchema = z.object({\n  route: z.string().optional(),\n  url: z.string().optional(),\n  status: z.enum(['baseline', 'compared', 'pending']).optional(),\n  name: z.string().optional(),\n  createdAfter: z.date().optional(),\n  createdBefore: z.date().optional(),\n  viewport: z.string().optional(),\n  limit: z.number().min(1).max(100).default(50),\n});\n\n/**\n * Comparison result from pixelmatch\n */\nexport const ComparisonResultSchema = z.object({\n  match: z.boolean(),\n  diffPercent: z.number(),\n  diffPixels: z.number(),\n  totalPixels: z.number(),\n  threshold: z.number(),\n});\n\n/**\n * Changed region detected in comparison\n */\nexport const ChangedRegionSchema = z.object({\n  location: z.enum(['top', 'bottom', 'left', 'right', 'center', 'full']),\n  bounds: z.object({\n    x: z.number(),\n    y: z.number(),\n    width: z.number(),\n    height: z.number(),\n  }),\n  description: z.string(),\n  severity: z.enum(['expected', 'unexpected', 'critical']),\n});\n\n/**\n * Analysis verdict types\n */\nexport const VerdictSchema = z.enum([\n  'MATCH',\n  'EXPECTED_CHANGE',\n  'UNEXPECTED_CHANGE',\n  'LAYOUT_BROKEN',\n]);\n\n/**\n * Analysis result\n */\nexport const AnalysisSchema = z.object({\n  verdict: VerdictSchema,\n  summary: z.string(),\n  changedRegions: z.array(ChangedRegionSchema),\n  unexpectedChanges: z.array(ChangedRegionSchema),\n  recommendation: z.string().nullable(),\n});\n\n/**\n * Session status\n */\nexport const SessionStatusSchema = z.enum(['baseline', 'compared', 'pending']);\n\n/**\n * Visual session\n */\nexport const SessionSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  url: z.string().url(),\n  viewport: ViewportSchema,\n  status: SessionStatusSchema,\n  createdAt: z.string().datetime(),\n  updatedAt: z.string().datetime(),\n  comparison: ComparisonResultSchema.optional(),\n  analysis: AnalysisSchema.optional(),\n});\n\n/**\n * Full comparison report\n */\nexport const ComparisonReportSchema = z.object({\n  sessionId: z.string(),\n  sessionName: z.string(),\n  url: z.string(),\n  timestamp: z.string().datetime(),\n  viewport: ViewportSchema,\n  comparison: ComparisonResultSchema,\n  analysis: AnalysisSchema,\n  files: z.object({\n    baseline: z.string(),\n    current: z.string(),\n    diff: z.string(),\n  }),\n  webViewUrl: z.string().optional(),\n});\n\n/**\n * Element interactivity detection\n */\nexport const InteractiveStateSchema = z.object({\n  hasOnClick: z.boolean(),\n  hasHref: z.boolean(),\n  isDisabled: z.boolean(),\n  tabIndex: z.number(),\n  cursor: z.string(),\n  // Framework-specific detection\n  hasReactHandler: z.boolean().optional(),\n  hasVueHandler: z.boolean().optional(),\n  hasAngularHandler: z.boolean().optional(),\n});\n\n/**\n * Accessibility attributes\n */\nexport const A11yAttributesSchema = z.object({\n  role: z.string().nullable(),\n  ariaLabel: z.string().nullable(),\n  ariaDescribedBy: z.string().nullable(),\n  ariaHidden: z.boolean().optional(),\n});\n\n/**\n * Element bounds\n */\nexport const BoundsSchema = z.object({\n  x: z.number(),\n  y: z.number(),\n  width: z.number(),\n  height: z.number(),\n});\n\n/**\n * Enhanced element with interactivity and accessibility\n */\nexport const EnhancedElementSchema = z.object({\n  // Identity\n  selector: z.string(),\n  tagName: z.string(),\n  id: z.string().optional(),\n  className: z.string().optional(),\n  text: z.string().optional(),\n\n  // Position\n  bounds: BoundsSchema,\n\n  // Styles (subset)\n  computedStyles: z.record(z.string()).optional(),\n\n  // Interactivity\n  interactive: InteractiveStateSchema,\n\n  // Accessibility\n  a11y: A11yAttributesSchema,\n\n  // Source hints for debugging\n  sourceHint: z.object({\n    dataTestId: z.string().nullable(),\n  }).optional(),\n});\n\n/**\n * Element issue detected during audit\n */\nexport const ElementIssueSchema = z.object({\n  type: z.enum([\n    'NO_HANDLER',           // Interactive-looking but no handler\n    'PLACEHOLDER_LINK',     // href=\"#\" without handler\n    'TOUCH_TARGET_SMALL',   // < 44px on mobile\n    'MISSING_ARIA_LABEL',   // Interactive without label\n    'DISABLED_NO_VISUAL',   // Disabled but no visual indication\n  ]),\n  severity: z.enum(['error', 'warning', 'info']),\n  message: z.string(),\n});\n\n/**\n * Audit result for a captured page\n */\nexport const AuditResultSchema = z.object({\n  totalElements: z.number(),\n  interactiveCount: z.number(),\n  withHandlers: z.number(),\n  withoutHandlers: z.number(),\n  issues: z.array(ElementIssueSchema),\n});\n\n// Type exports - auto-generated from schemas\nexport type Viewport = z.infer<typeof ViewportSchema>;\nexport type Config = z.infer<typeof ConfigSchema>;\nexport type SessionQuery = z.infer<typeof SessionQuerySchema>;\nexport type ComparisonResult = z.infer<typeof ComparisonResultSchema>;\nexport type ChangedRegion = z.infer<typeof ChangedRegionSchema>;\nexport type Verdict = z.infer<typeof VerdictSchema>;\nexport type Analysis = z.infer<typeof AnalysisSchema>;\nexport type SessionStatus = z.infer<typeof SessionStatusSchema>;\nexport type Session = z.infer<typeof SessionSchema>;\nexport type ComparisonReport = z.infer<typeof ComparisonReportSchema>;\nexport type InteractiveState = z.infer<typeof InteractiveStateSchema>;\nexport type A11yAttributes = z.infer<typeof A11yAttributesSchema>;\nexport type Bounds = z.infer<typeof BoundsSchema>;\nexport type EnhancedElement = z.infer<typeof EnhancedElementSchema>;\nexport type ElementIssue = z.infer<typeof ElementIssueSchema>;\nexport type AuditResult = z.infer<typeof AuditResultSchema>;\n\n/**\n * Rule severity levels\n */\nexport const RuleSeveritySchema = z.enum(['off', 'warn', 'error']);\n\n/**\n * Individual rule setting\n */\nexport const RuleSettingSchema = z.union([\n  RuleSeveritySchema,\n  z.tuple([RuleSeveritySchema, z.record(z.unknown())]),\n]);\n\n/**\n * Rules configuration (user's .ibr/rules.json)\n */\nexport const RulesConfigSchema = z.object({\n  extends: z.array(z.string()).optional(),\n  rules: z.record(RuleSettingSchema).optional(),\n});\n\n/**\n * Violation detected by a rule\n */\nexport const ViolationSchema = z.object({\n  ruleId: z.string(),\n  ruleName: z.string(),\n  severity: z.enum(['warn', 'error']),\n  message: z.string(),\n  element: z.string().optional(),  // Selector of violating element\n  bounds: BoundsSchema.optional(),\n  fix: z.string().optional(),       // Suggested fix\n});\n\n/**\n * Full audit report with rule violations\n */\nexport const RuleAuditResultSchema = z.object({\n  url: z.string(),\n  timestamp: z.string(),\n  elementsScanned: z.number(),\n  violations: z.array(ViolationSchema),\n  summary: z.object({\n    errors: z.number(),\n    warnings: z.number(),\n    passed: z.number(),\n  }),\n});\n\n// Rule-related type exports\nexport type RuleSeverity = z.infer<typeof RuleSeveritySchema>;\nexport type RuleSetting = z.infer<typeof RuleSettingSchema>;\nexport type RulesConfig = z.infer<typeof RulesConfigSchema>;\nexport type Violation = z.infer<typeof ViolationSchema>;\nexport type RuleAuditResult = z.infer<typeof RuleAuditResultSchema>;\n","import { chromium } from 'playwright';\nimport { mkdir, access, readFile, writeFile, unlink, chmod, stat } from 'fs/promises';\nimport { join, dirname, resolve } from 'path';\nimport { existsSync, readFileSync } from 'fs';\nimport { userInfo, homedir } from 'os';\nimport { createHash, randomBytes } from 'crypto';\nimport type { LoginOptions } from './types.js';\n\nconst AUTH_STATE_FILE = 'auth.json';\n\n/**\n * Auth state with metadata for security\n */\ninterface StoredAuthState {\n  state: object; // Playwright storage state\n  metadata: {\n    createdAt: number;\n    expiresAt: number;\n    username: string;\n    projectPath: string;\n  };\n}\n\n/**\n * Check if running in a CI/CD or deployed environment\n * Auth operations should be blocked in these environments\n */\nexport function isDeployedEnvironment(): boolean {\n  return !!(\n    process.env.VERCEL ||\n    process.env.NETLIFY ||\n    process.env.CI ||\n    process.env.GITHUB_ACTIONS ||\n    process.env.GITLAB_CI ||\n    process.env.CIRCLECI ||\n    process.env.JENKINS_URL ||\n    process.env.TRAVIS ||\n    process.env.HEROKU ||\n    process.env.AWS_LAMBDA_FUNCTION_NAME ||\n    process.env.AZURE_FUNCTIONS_ENVIRONMENT\n  );\n}\n\n/**\n * Get the path to the auth state file\n * Uses per-user isolation to prevent credential sharing\n */\nexport function getAuthStatePath(outputDir: string): string {\n  const username = userInfo().username;\n  // Include username in filename for user isolation\n  return join(outputDir, `auth.${username}.json`);\n}\n\n/**\n * Get a secure auth path in user's home directory (alternative)\n * This keeps auth completely outside the project directory\n */\nexport function getSecureAuthPath(projectPath: string): string {\n  const username = userInfo().username;\n  // Hash project path to create unique identifier\n  const projectHash = createHash('sha256')\n    .update(resolve(projectPath))\n    .digest('hex')\n    .substring(0, 16);\n\n  return join(\n    homedir(),\n    '.config',\n    'ibr',\n    'auth',\n    `${projectHash}.${username}.json`\n  );\n}\n\n/**\n * Check if .gitignore properly excludes .ibr directory\n */\nfunction validateGitignore(projectDir: string): void {\n  const gitignorePath = join(projectDir, '.gitignore');\n\n  if (existsSync(gitignorePath)) {\n    const gitignore = readFileSync(gitignorePath, 'utf-8');\n    const lines = gitignore.split('\\n').map(l => l.trim());\n\n    const hasIbrIgnore = lines.some(line =>\n      line === '.ibr/' ||\n      line === '.ibr' ||\n      line === '**/.ibr/' ||\n      line === '**/.ibr'\n    );\n\n    if (!hasIbrIgnore) {\n      console.warn('\\n  WARNING: .ibr/ is not in .gitignore!');\n      console.warn('   Add \".ibr/\" to .gitignore to prevent credential leaks.\\n');\n    }\n  } else {\n    console.warn('\\n  No .gitignore found. Create one with \".ibr/\" entry.\\n');\n  }\n}\n\n/**\n * Check if auth state exists\n */\nexport async function hasAuthState(outputDir: string): Promise<boolean> {\n  try {\n    await access(getAuthStatePath(outputDir));\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Load auth state if it exists and is valid\n */\nexport async function loadAuthState(outputDir: string): Promise<object | null> {\n  // Block in deployed environments\n  if (isDeployedEnvironment()) {\n    console.warn('  Deployed environment detected. Auth state not available.');\n    return null;\n  }\n\n  try {\n    const authPath = getAuthStatePath(outputDir);\n    const content = await readFile(authPath, 'utf-8');\n    const stored: StoredAuthState = JSON.parse(content);\n\n    // Validate metadata exists\n    if (!stored.metadata) {\n      console.warn('  Legacy auth format detected. Please re-authenticate with `ibr login`.');\n      return null;\n    }\n\n    // Check user matches\n    const currentUser = userInfo().username;\n    if (stored.metadata.username !== currentUser) {\n      console.warn(`  Auth state belongs to different user (${stored.metadata.username}).`);\n      return null;\n    }\n\n    // Check expiration\n    if (Date.now() > stored.metadata.expiresAt) {\n      console.warn('  Auth state expired. Please re-authenticate with `ibr login`.');\n      await clearAuthState(outputDir);\n      return null;\n    }\n\n    // Warn if auth is getting old (> 24 hours)\n    const ageHours = (Date.now() - stored.metadata.createdAt) / (1000 * 60 * 60);\n    if (ageHours > 24) {\n      console.warn(`  Auth state is ${Math.floor(ageHours)} hours old. Consider re-authenticating.`);\n    }\n\n    return stored.state;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Open a browser for manual login and save the state\n *\n * This opens a visible browser window where the user can:\n * 1. Navigate to login page\n * 2. Enter credentials\n * 3. Complete any 2FA or other auth steps\n *\n * When done, close the browser or press Ctrl+C to save the state.\n */\nexport async function performLogin(options: LoginOptions): Promise<string> {\n  const { url, outputDir, timeout = 300000 } = options; // 5 min default timeout\n\n  // Block in deployed environments\n  if (isDeployedEnvironment()) {\n    throw new Error(\n      'Authentication cannot be performed in deployed environments.\\n' +\n      'Run `ibr login` locally on your development machine.'\n    );\n  }\n\n  // Validate .gitignore before storing credentials\n  validateGitignore(process.cwd());\n\n  // Ensure output directory exists with restricted permissions\n  await mkdir(outputDir, { recursive: true, mode: 0o700 }); // rwx------\n\n  // Fix permissions on existing directory\n  try {\n    await chmod(outputDir, 0o700);\n  } catch {\n    // Ignore if chmod fails (e.g., on Windows)\n  }\n\n  const authStatePath = getAuthStatePath(outputDir);\n  const currentUser = userInfo().username;\n\n  console.log('\\n Opening browser for login...');\n  console.log(`   User: ${currentUser}`);\n  console.log('   Navigate to your login page and complete authentication.');\n  console.log('   When finished, close the browser window to save your session.\\n');\n\n  const browser = await chromium.launch({\n    headless: false, // Visible browser for manual login\n  });\n\n  const context = await browser.newContext({\n    viewport: { width: 1280, height: 800 },\n  });\n\n  const page = await context.newPage();\n\n  try {\n    // Navigate to the provided URL\n    await page.goto(url, {\n      waitUntil: 'domcontentloaded',\n      timeout: 30000,\n    });\n\n    // Wait for browser to close (user manually closes it after login)\n    // or timeout after the specified duration\n    await Promise.race([\n      new Promise<void>((resolve) => {\n        browser.on('disconnected', () => resolve());\n      }),\n      new Promise<void>((_, reject) => {\n        setTimeout(() => reject(new Error('Login timeout exceeded')), timeout);\n      }),\n    ]);\n\n  } catch (error) {\n    // If browser is still open, save the state before closing\n    if (browser.isConnected()) {\n      await saveAuthState(context, authStatePath, outputDir);\n      await browser.close();\n    }\n\n    // Check if it was a timeout or browser close\n    if (error instanceof Error && error.message.includes('timeout')) {\n      throw error;\n    }\n  }\n\n  // If we get here without the browser being disconnected, save state\n  if (browser.isConnected()) {\n    await saveAuthState(context, authStatePath, outputDir);\n    await browser.close();\n  } else {\n    // Browser was closed by user - try to reconnect to save state\n    console.log('\\n  Browser was closed. Attempting to save any captured state...');\n\n    // Create a new context just to save an empty state as fallback\n    const newBrowser = await chromium.launch({ headless: true });\n    const newContext = await newBrowser.newContext();\n\n    // Try to use any cookies from the page\n    try {\n      await newContext.addCookies(await context.cookies());\n    } catch {\n      // Context might be closed\n    }\n\n    await saveAuthState(newContext, authStatePath, outputDir);\n    await newBrowser.close();\n  }\n\n  console.log(`\\n Auth state saved for user: ${currentUser}`);\n  console.log(`   Location: ${authStatePath}`);\n  console.log('   Expires: 7 days from now');\n  console.log('   Future captures will use this authentication.\\n');\n\n  return authStatePath;\n}\n\n/**\n * Save auth state with metadata and secure permissions\n */\nasync function saveAuthState(\n  context: Awaited<ReturnType<typeof chromium.launch>>['contexts'][0],\n  authStatePath: string,\n  outputDir: string\n): Promise<void> {\n  const state = await context.storageState();\n  const currentUser = userInfo().username;\n\n  const storedState: StoredAuthState = {\n    state,\n    metadata: {\n      createdAt: Date.now(),\n      expiresAt: Date.now() + (7 * 24 * 60 * 60 * 1000), // 7 days\n      username: currentUser,\n      projectPath: resolve(process.cwd()),\n    }\n  };\n\n  // Write with restricted permissions (owner read/write only)\n  await writeFile(\n    authStatePath,\n    JSON.stringify(storedState, null, 2),\n    { mode: 0o600 } // rw-------\n  );\n\n  // Ensure permissions are correct (in case file existed)\n  try {\n    await chmod(authStatePath, 0o600);\n  } catch {\n    // Ignore if chmod fails (e.g., on Windows)\n  }\n}\n\n/**\n * Clear saved auth state with secure deletion\n */\nexport async function clearAuthState(outputDir: string): Promise<void> {\n  const authPath = getAuthStatePath(outputDir);\n\n  try {\n    // Get file stats for size\n    const stats = await stat(authPath);\n\n    // Overwrite with random data before deletion (secure delete)\n    const randomData = randomBytes(stats.size);\n    await writeFile(authPath, randomData, { mode: 0o600 });\n\n    // Now delete the file\n    await unlink(authPath);\n\n    console.log(' Auth state securely cleared');\n  } catch {\n    console.log('  No auth state to clear');\n  }\n}\n\n/**\n * Get auth state info without loading the full state\n */\nexport async function getAuthStateInfo(outputDir: string): Promise<{\n  exists: boolean;\n  username?: string;\n  createdAt?: Date;\n  expiresAt?: Date;\n  expired?: boolean;\n} | null> {\n  try {\n    const authPath = getAuthStatePath(outputDir);\n    const content = await readFile(authPath, 'utf-8');\n    const stored: StoredAuthState = JSON.parse(content);\n\n    if (!stored.metadata) {\n      return { exists: true };\n    }\n\n    return {\n      exists: true,\n      username: stored.metadata.username,\n      createdAt: new Date(stored.metadata.createdAt),\n      expiresAt: new Date(stored.metadata.expiresAt),\n      expired: Date.now() > stored.metadata.expiresAt,\n    };\n  } catch {\n    return null;\n  }\n}\n","import { chromium, type Browser } from 'playwright';\nimport { mkdir } from 'fs/promises';\nimport { dirname } from 'path';\nimport { VIEWPORTS, type Viewport } from './schemas.js';\nimport type { CaptureOptions } from './types.js';\nimport { loadAuthState, isDeployedEnvironment } from './auth.js';\n\n/**\n * Capture result with timing and diagnostic info\n */\nexport interface CaptureResult {\n  success: boolean;\n  outputPath?: string;\n  timing: {\n    navigationMs: number;\n    renderMs: number;\n    totalMs: number;\n  };\n  diagnostics: {\n    httpStatus?: number;\n    consoleErrors: string[];\n    networkErrors: string[];\n    suggestions: string[];\n  };\n  error?: {\n    type: 'timeout' | 'navigation' | 'screenshot' | 'unknown';\n    message: string;\n    suggestion: string;\n  };\n}\n\n// Playwright's storage state type\ntype StorageState = {\n  cookies: Array<{\n    name: string;\n    value: string;\n    domain: string;\n    path: string;\n    expires: number;\n    httpOnly: boolean;\n    secure: boolean;\n    sameSite: 'Strict' | 'Lax' | 'None';\n  }>;\n  origins: Array<{\n    origin: string;\n    localStorage: Array<{ name: string; value: string }>;\n  }>;\n};\n\nlet browser: Browser | null = null;\n\n/**\n * Get or create a browser instance\n */\nasync function getBrowser(): Promise<Browser> {\n  if (!browser) {\n    browser = await chromium.launch({\n      headless: true,\n    });\n  }\n  return browser;\n}\n\n/**\n * Close the browser instance\n */\nexport async function closeBrowser(): Promise<void> {\n  if (browser) {\n    await browser.close();\n    browser = null;\n  }\n}\n\n/**\n * Capture a screenshot of a URL\n */\nexport async function captureScreenshot(\n  options: CaptureOptions & { outputDir?: string }\n): Promise<string> {\n  const {\n    url,\n    outputPath,\n    viewport = VIEWPORTS.desktop,\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n    outputDir,\n    selector,\n    waitFor,\n  } = options;\n\n  // Ensure output directory exists\n  await mkdir(dirname(outputPath), { recursive: true });\n\n  // Load auth state if available (handles validation, expiration, user isolation)\n  let storageState: StorageState | undefined;\n  if (outputDir && !isDeployedEnvironment()) {\n    const authState = await loadAuthState(outputDir);\n    if (authState) {\n      storageState = authState as StorageState;\n      console.log(' Using saved authentication state');\n    }\n  }\n\n  const browserInstance = await getBrowser();\n  const context = await browserInstance.newContext({\n    viewport: {\n      width: viewport.width,\n      height: viewport.height,\n    },\n    // Disable animations for consistent screenshots\n    reducedMotion: 'reduce',\n    // Load auth state if available (Playwright accepts object or file path)\n    ...(storageState ? { storageState } : {}),\n  });\n\n  const page = await context.newPage();\n\n  try {\n    // Navigate to URL\n    await page.goto(url, {\n      waitUntil: waitForNetworkIdle ? 'networkidle' : 'load',\n      timeout,\n    });\n\n    // Wait for specific selector if provided (for dynamic content)\n    if (waitFor) {\n      await page.waitForSelector(waitFor, { timeout });\n    }\n\n    // Wait for any remaining animations to settle\n    await page.waitForTimeout(500);\n\n    // Disable CSS animations and transitions\n    await page.addStyleTag({\n      content: `\n        *, *::before, *::after {\n          animation-duration: 0s !important;\n          animation-delay: 0s !important;\n          transition-duration: 0s !important;\n          transition-delay: 0s !important;\n        }\n      `,\n    });\n\n    // Take screenshot - element or full page\n    if (selector) {\n      // Wait for element and capture just that element\n      const element = await page.waitForSelector(selector, { timeout: 5000 });\n      if (!element) {\n        throw new Error(`Element not found: ${selector}`);\n      }\n      await element.screenshot({\n        path: outputPath,\n        type: 'png',\n      });\n    } else {\n      await page.screenshot({\n        path: outputPath,\n        fullPage,\n        type: 'png',\n      });\n    }\n\n    return outputPath;\n  } finally {\n    await context.close();\n  }\n}\n\n/**\n * Get viewport dimensions by name\n */\nexport function getViewport(name: 'desktop' | 'mobile' | 'tablet'): Viewport {\n  return VIEWPORTS[name];\n}\n\n/**\n * Capture multiple viewports\n */\nexport async function captureMultipleViewports(\n  url: string,\n  outputDir: string,\n  viewports: Array<'desktop' | 'mobile' | 'tablet'> = ['desktop'],\n  options: Omit<CaptureOptions, 'url' | 'outputPath' | 'viewport'> = {}\n): Promise<Record<string, string>> {\n  const results: Record<string, string> = {};\n\n  for (const viewportName of viewports) {\n    const viewport = getViewport(viewportName);\n    const outputPath = `${outputDir}/${viewportName}.png`;\n\n    await captureScreenshot({\n      url,\n      outputPath,\n      viewport,\n      ...options,\n    });\n\n    results[viewportName] = outputPath;\n  }\n\n  return results;\n}\n\n/**\n * Enhanced capture with detailed timing and diagnostics\n * Returns actionable info for debugging slow loads or errors\n */\nexport async function captureWithDiagnostics(\n  options: CaptureOptions & { outputDir?: string }\n): Promise<CaptureResult> {\n  const {\n    url,\n    outputPath,\n    viewport = VIEWPORTS.desktop,\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n    outputDir,\n    selector,\n  } = options;\n\n  const startTime = Date.now();\n  let navigationTime = 0;\n  let renderTime = 0;\n\n  const consoleErrors: string[] = [];\n  const networkErrors: string[] = [];\n  const suggestions: string[] = [];\n  let httpStatus: number | undefined;\n\n  try {\n    // Ensure output directory exists\n    await mkdir(dirname(outputPath), { recursive: true });\n\n    // Load auth state if available\n    let storageState: StorageState | undefined;\n    if (outputDir && !isDeployedEnvironment()) {\n      const authState = await loadAuthState(outputDir);\n      if (authState) {\n        storageState = authState as StorageState;\n      }\n    }\n\n    const browserInstance = await getBrowser();\n    const context = await browserInstance.newContext({\n      viewport: {\n        width: viewport.width,\n        height: viewport.height,\n      },\n      reducedMotion: 'reduce',\n      ...(storageState ? { storageState } : {}),\n    });\n\n    const page = await context.newPage();\n\n    // Collect console errors\n    page.on('console', msg => {\n      if (msg.type() === 'error') {\n        consoleErrors.push(msg.text());\n      }\n    });\n\n    // Collect network errors\n    page.on('requestfailed', request => {\n      const failure = request.failure();\n      networkErrors.push(`${request.url()}: ${failure?.errorText || 'failed'}`);\n    });\n\n    // Track HTTP status\n    page.on('response', response => {\n      if (response.url() === url || response.url() === url + '/') {\n        httpStatus = response.status();\n      }\n    });\n\n    try {\n      const navStart = Date.now();\n      await page.goto(url, {\n        waitUntil: waitForNetworkIdle ? 'networkidle' : 'load',\n        timeout,\n      });\n      navigationTime = Date.now() - navStart;\n    } catch (navError) {\n      await context.close();\n\n      const errorMsg = navError instanceof Error ? navError.message : String(navError);\n      const isTimeout = errorMsg.includes('Timeout');\n\n      // Generate helpful suggestions\n      if (isTimeout) {\n        suggestions.push(`Page took longer than ${timeout}ms to load`);\n        suggestions.push('Try increasing timeout: --timeout 60000');\n        if (waitForNetworkIdle) {\n          suggestions.push('Try disabling network idle wait: use \"load\" instead of \"networkidle\"');\n        }\n      }\n      if (networkErrors.length > 0) {\n        suggestions.push(`${networkErrors.length} network request(s) failed`);\n      }\n      if (httpStatus && httpStatus >= 400) {\n        suggestions.push(`Server returned HTTP ${httpStatus}`);\n      }\n\n      return {\n        success: false,\n        timing: {\n          navigationMs: Date.now() - startTime,\n          renderMs: 0,\n          totalMs: Date.now() - startTime,\n        },\n        diagnostics: {\n          httpStatus,\n          consoleErrors,\n          networkErrors,\n          suggestions,\n        },\n        error: {\n          type: isTimeout ? 'timeout' : 'navigation',\n          message: errorMsg,\n          suggestion: isTimeout\n            ? `Increase timeout or check if ${url} is responding`\n            : `Check if the server is running at ${url}`,\n        },\n      };\n    }\n\n    // Wait for animations to settle\n    await page.waitForTimeout(500);\n\n    // Disable CSS animations\n    await page.addStyleTag({\n      content: `\n        *, *::before, *::after {\n          animation-duration: 0s !important;\n          animation-delay: 0s !important;\n          transition-duration: 0s !important;\n          transition-delay: 0s !important;\n        }\n      `,\n    });\n\n    // Take screenshot - element or full page\n    const renderStart = Date.now();\n    if (selector) {\n      const element = await page.waitForSelector(selector, { timeout: 5000 });\n      if (!element) {\n        throw new Error(`Element not found: ${selector}`);\n      }\n      await element.screenshot({\n        path: outputPath,\n        type: 'png',\n      });\n    } else {\n      await page.screenshot({\n        path: outputPath,\n        fullPage,\n        type: 'png',\n      });\n    }\n    renderTime = Date.now() - renderStart;\n\n    await context.close();\n\n    // Generate performance suggestions\n    if (navigationTime > 5000) {\n      suggestions.push(`Slow page load: ${(navigationTime / 1000).toFixed(1)}s`);\n    }\n    if (consoleErrors.length > 0) {\n      suggestions.push(`${consoleErrors.length} JavaScript error(s) detected`);\n    }\n\n    return {\n      success: true,\n      outputPath,\n      timing: {\n        navigationMs: navigationTime,\n        renderMs: renderTime,\n        totalMs: Date.now() - startTime,\n      },\n      diagnostics: {\n        httpStatus,\n        consoleErrors,\n        networkErrors,\n        suggestions,\n      },\n    };\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : String(error);\n\n    return {\n      success: false,\n      timing: {\n        navigationMs: navigationTime,\n        renderMs: renderTime,\n        totalMs: Date.now() - startTime,\n      },\n      diagnostics: {\n        httpStatus,\n        consoleErrors,\n        networkErrors,\n        suggestions,\n      },\n      error: {\n        type: 'unknown',\n        message: errorMsg,\n        suggestion: 'Check browser installation: npx playwright install chromium',\n      },\n    };\n  }\n}\n","import pixelmatch from 'pixelmatch';\nimport { PNG } from 'pngjs';\nimport { readFile, writeFile, mkdir } from 'fs/promises';\nimport { dirname } from 'path';\nimport type { CompareOptions } from './types.js';\nimport type { ComparisonResult, Analysis, ChangedRegion, Verdict } from './schemas.js';\n\n/**\n * Region detection configuration\n * Divides page into semantic regions based on common layout patterns\n */\ninterface RegionConfig {\n  name: string;\n  location: 'top' | 'bottom' | 'left' | 'right' | 'center' | 'full';\n  // Percentages of page dimensions\n  xStart: number;  // 0-1\n  xEnd: number;    // 0-1\n  yStart: number;  // 0-1\n  yEnd: number;    // 0-1\n}\n\n/**\n * Default regions based on common web layouts\n * Header (top 10%), Footer (bottom 10%), Left sidebar (left 20%), Content (center)\n */\nconst DEFAULT_REGIONS: RegionConfig[] = [\n  { name: 'header', location: 'top', xStart: 0, xEnd: 1, yStart: 0, yEnd: 0.1 },\n  { name: 'navigation', location: 'left', xStart: 0, xEnd: 0.2, yStart: 0.1, yEnd: 0.9 },\n  { name: 'content', location: 'center', xStart: 0.2, xEnd: 1, yStart: 0.1, yEnd: 0.9 },\n  { name: 'footer', location: 'bottom', xStart: 0, xEnd: 1, yStart: 0.9, yEnd: 1 },\n];\n\n/**\n * Analyze diff image to detect which regions have changes\n */\nexport function detectChangedRegions(\n  diffData: Uint8Array,\n  width: number,\n  height: number,\n  regions: RegionConfig[] = DEFAULT_REGIONS\n): ChangedRegion[] {\n  const changedRegions: ChangedRegion[] = [];\n\n  for (const region of regions) {\n    // Calculate pixel bounds\n    const xStart = Math.floor(region.xStart * width);\n    const xEnd = Math.floor(region.xEnd * width);\n    const yStart = Math.floor(region.yStart * height);\n    const yEnd = Math.floor(region.yEnd * height);\n\n    const regionWidth = xEnd - xStart;\n    const regionHeight = yEnd - yStart;\n    const regionPixels = regionWidth * regionHeight;\n\n    if (regionPixels === 0) continue;\n\n    // Count red pixels (diff color) in this region\n    let diffPixels = 0;\n\n    for (let y = yStart; y < yEnd; y++) {\n      for (let x = xStart; x < xEnd; x++) {\n        const idx = (y * width + x) * 4;\n        // Check if pixel is red (diff marker from pixelmatch)\n        // pixelmatch uses [255, 0, 0] for differences\n        if (diffData[idx] === 255 && diffData[idx + 1] === 0 && diffData[idx + 2] === 0) {\n          diffPixels++;\n        }\n      }\n    }\n\n    const diffPercent = (diffPixels / regionPixels) * 100;\n\n    // Only report regions with >0.1% changes\n    if (diffPercent > 0.1) {\n      const severity = diffPercent > 30 ? 'critical' :\n                       diffPercent > 10 ? 'unexpected' : 'expected';\n\n      changedRegions.push({\n        location: region.location,\n        bounds: {\n          x: xStart,\n          y: yStart,\n          width: regionWidth,\n          height: regionHeight,\n        },\n        description: `${region.name}: ${diffPercent.toFixed(1)}% changed`,\n        severity,\n      });\n    }\n  }\n\n  // Sort by severity (critical first) then by diff percentage\n  return changedRegions.sort((a, b) => {\n    const severityOrder = { critical: 0, unexpected: 1, expected: 2 };\n    const aSev = severityOrder[a.severity];\n    const bSev = severityOrder[b.severity];\n    if (aSev !== bSev) return aSev - bSev;\n\n    // Parse percentage from description for secondary sort\n    const aPercent = parseFloat(a.description.match(/(\\d+\\.?\\d*)%/)?.[1] || '0');\n    const bPercent = parseFloat(b.description.match(/(\\d+\\.?\\d*)%/)?.[1] || '0');\n    return bPercent - aPercent;\n  });\n}\n\n/**\n * Extended comparison result with diff image data for regional analysis\n */\nexport interface ExtendedComparisonResult extends ComparisonResult {\n  diffData?: Uint8Array;\n  width?: number;\n  height?: number;\n}\n\n/**\n * Compare two images using pixelmatch\n */\nexport async function compareImages(options: CompareOptions): Promise<ExtendedComparisonResult> {\n  const {\n    baselinePath,\n    currentPath,\n    diffPath,\n    threshold = 0.1, // pixelmatch threshold (0-1), lower = stricter\n  } = options;\n\n  // Read images\n  const [baselineBuffer, currentBuffer] = await Promise.all([\n    readFile(baselinePath),\n    readFile(currentPath),\n  ]);\n\n  const baseline = PNG.sync.read(baselineBuffer);\n  const current = PNG.sync.read(currentBuffer);\n\n  // Ensure images have same dimensions\n  if (baseline.width !== current.width || baseline.height !== current.height) {\n    throw new Error(\n      `Image dimensions mismatch: baseline (${baseline.width}x${baseline.height}) vs current (${current.width}x${current.height})`\n    );\n  }\n\n  const { width, height } = baseline;\n  const diff = new PNG({ width, height });\n  const totalPixels = width * height;\n\n  // Run pixelmatch\n  const diffPixels = pixelmatch(\n    baseline.data,\n    current.data,\n    diff.data,\n    width,\n    height,\n    {\n      threshold,\n      includeAA: false, // Ignore anti-aliasing differences\n      alpha: 0.1,\n      diffColor: [255, 0, 0], // Red for differences\n      diffColorAlt: [0, 255, 0], // Green for anti-aliased differences\n    }\n  );\n\n  // Ensure output directory exists\n  await mkdir(dirname(diffPath), { recursive: true });\n\n  // Write diff image\n  await writeFile(diffPath, PNG.sync.write(diff));\n\n  const diffPercent = (diffPixels / totalPixels) * 100;\n\n  return {\n    match: diffPixels === 0,\n    diffPercent: Math.round(diffPercent * 100) / 100, // Round to 2 decimal places\n    diffPixels,\n    totalPixels,\n    threshold,\n    // Include diff data for regional analysis\n    diffData: diff.data,\n    width,\n    height,\n  };\n}\n\n/**\n * Analyze comparison result and generate verdict with regional analysis\n */\nexport function analyzeComparison(\n  result: ExtendedComparisonResult,\n  thresholdPercent: number = 1.0\n): Analysis {\n  const { match, diffPercent, diffData, width, height } = result;\n\n  // Detect changed regions if diff data is available\n  let detectedRegions: ChangedRegion[] = [];\n  if (diffData && width && height && !match) {\n    detectedRegions = detectChangedRegions(diffData, width, height);\n  }\n\n  // Analyze regions for verdict determination\n  const criticalRegions = detectedRegions.filter(r => r.severity === 'critical');\n  const unexpectedRegions = detectedRegions.filter(r => r.severity === 'unexpected');\n  const hasNavigationChanges = detectedRegions.some(r =>\n    r.description.toLowerCase().includes('navigation') ||\n    r.description.toLowerCase().includes('header')\n  );\n\n  // Determine verdict based on regions and overall diff\n  let verdict: Verdict;\n  let summary: string;\n  let recommendation: string | null = null;\n\n  if (match || diffPercent === 0) {\n    verdict = 'MATCH';\n    summary = 'No visual changes detected. Screenshots are identical.';\n  } else if (criticalRegions.length > 0) {\n    verdict = 'LAYOUT_BROKEN';\n    const regionNames = criticalRegions.map(r =>\n      r.description.split(':')[0]\n    ).join(', ');\n    summary = `Critical changes in: ${regionNames}. Layout may be broken.`;\n    recommendation = `Major changes detected in ${regionNames}. Check for missing elements, broken layout, or loading errors.`;\n  } else if (unexpectedRegions.length > 0 || diffPercent > 20) {\n    verdict = 'UNEXPECTED_CHANGE';\n    const regionNames = unexpectedRegions.length > 0\n      ? unexpectedRegions.map(r => r.description.split(':')[0]).join(', ')\n      : 'multiple areas';\n    summary = `Significant changes in: ${regionNames} (${diffPercent}% overall).`;\n    recommendation = hasNavigationChanges\n      ? 'Navigation area changed - verify menu items and links are correct.'\n      : 'Review changes carefully - some may be unintentional.';\n  } else if (diffPercent <= thresholdPercent) {\n    verdict = 'EXPECTED_CHANGE';\n    summary = `Minor changes detected (${diffPercent}%). Within acceptable threshold.`;\n  } else {\n    verdict = 'EXPECTED_CHANGE';\n    const regionNames = detectedRegions.length > 0\n      ? detectedRegions.map(r => r.description.split(':')[0]).join(', ')\n      : 'content area';\n    summary = `Changes in: ${regionNames} (${diffPercent}% overall). Changes appear intentional.`;\n  }\n\n  // Separate expected vs unexpected changes\n  const changedRegions = detectedRegions.filter(r => r.severity === 'expected');\n  const unexpectedChanges = detectedRegions.filter(r =>\n    r.severity === 'unexpected' || r.severity === 'critical'\n  );\n\n  // If no regions detected but there are changes, create a fallback region\n  if (detectedRegions.length === 0 && !match) {\n    const fallbackRegion: ChangedRegion = {\n      location: diffPercent > 50 ? 'full' : 'center',\n      bounds: { x: 0, y: 0, width: width || 0, height: height || 0 },\n      description: `overall: ${diffPercent}% changed`,\n      severity: verdict === 'LAYOUT_BROKEN' ? 'critical' :\n                verdict === 'UNEXPECTED_CHANGE' ? 'unexpected' : 'expected',\n    };\n\n    if (verdict === 'UNEXPECTED_CHANGE' || verdict === 'LAYOUT_BROKEN') {\n      unexpectedChanges.push(fallbackRegion);\n    } else {\n      changedRegions.push(fallbackRegion);\n    }\n  }\n\n  return {\n    verdict,\n    summary,\n    changedRegions,\n    unexpectedChanges,\n    recommendation,\n  };\n}\n\n/**\n * Get a human-readable verdict description\n */\nexport function getVerdictDescription(verdict: Verdict): string {\n  switch (verdict) {\n    case 'MATCH':\n      return 'No changes - screenshots match';\n    case 'EXPECTED_CHANGE':\n      return 'Changes detected - appear intentional';\n    case 'UNEXPECTED_CHANGE':\n      return 'Unexpected changes - review required';\n    case 'LAYOUT_BROKEN':\n      return 'Layout broken - significant issues detected';\n    default:\n      return 'Unknown verdict';\n  }\n}\n","import { nanoid } from 'nanoid';\nimport { mkdir, readFile, writeFile, readdir, rm } from 'fs/promises';\nimport { join } from 'path';\nimport { SessionSchema, SessionQuerySchema, type Session, type SessionQuery, type Viewport, type ComparisonResult, type Analysis } from './schemas.js';\nimport type { SessionPaths, CleanOptions } from './types.js';\n\nconst SESSION_PREFIX = 'sess_';\n\n/**\n * Generate a unique session ID\n */\nexport function generateSessionId(): string {\n  return `${SESSION_PREFIX}${nanoid(10)}`;\n}\n\n/**\n * Get paths for a session\n */\nexport function getSessionPaths(outputDir: string, sessionId: string): SessionPaths {\n  const root = join(outputDir, 'sessions', sessionId);\n  return {\n    root,\n    sessionJson: join(root, 'session.json'),\n    baseline: join(root, 'baseline.png'),\n    current: join(root, 'current.png'),\n    diff: join(root, 'diff.png'),\n  };\n}\n\n/**\n * Create a new session\n */\nexport async function createSession(\n  outputDir: string,\n  url: string,\n  name: string,\n  viewport: Viewport\n): Promise<Session> {\n  const sessionId = generateSessionId();\n  const paths = getSessionPaths(outputDir, sessionId);\n  const now = new Date().toISOString();\n\n  const session: Session = {\n    id: sessionId,\n    name,\n    url,\n    viewport,\n    status: 'baseline',\n    createdAt: now,\n    updatedAt: now,\n  };\n\n  // Create session directory\n  await mkdir(paths.root, { recursive: true });\n\n  // Write session file\n  await writeFile(paths.sessionJson, JSON.stringify(session, null, 2));\n\n  return session;\n}\n\n/**\n * Get a session by ID\n */\nexport async function getSession(outputDir: string, sessionId: string): Promise<Session | null> {\n  const paths = getSessionPaths(outputDir, sessionId);\n\n  try {\n    const content = await readFile(paths.sessionJson, 'utf-8');\n    const data = JSON.parse(content);\n    return SessionSchema.parse(data);\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Update a session\n */\nexport async function updateSession(\n  outputDir: string,\n  sessionId: string,\n  updates: Partial<Omit<Session, 'id' | 'createdAt'>>\n): Promise<Session> {\n  const session = await getSession(outputDir, sessionId);\n  if (!session) {\n    throw new Error(`Session not found: ${sessionId}`);\n  }\n\n  const updated: Session = {\n    ...session,\n    ...updates,\n    updatedAt: new Date().toISOString(),\n  };\n\n  const paths = getSessionPaths(outputDir, sessionId);\n  await writeFile(paths.sessionJson, JSON.stringify(updated, null, 2));\n\n  return updated;\n}\n\n/**\n * Mark session as compared with results\n */\nexport async function markSessionCompared(\n  outputDir: string,\n  sessionId: string,\n  comparison: ComparisonResult,\n  analysis: Analysis\n): Promise<Session> {\n  return updateSession(outputDir, sessionId, {\n    status: 'compared',\n    comparison,\n    analysis,\n  });\n}\n\n/**\n * List all sessions\n */\nexport async function listSessions(outputDir: string): Promise<Session[]> {\n  const sessionsDir = join(outputDir, 'sessions');\n\n  try {\n    const entries = await readdir(sessionsDir, { withFileTypes: true });\n    const sessions: Session[] = [];\n\n    for (const entry of entries) {\n      if (entry.isDirectory() && entry.name.startsWith(SESSION_PREFIX)) {\n        const session = await getSession(outputDir, entry.name);\n        if (session) {\n          sessions.push(session);\n        }\n      }\n    }\n\n    // Sort by creation date, newest first\n    return sessions.sort((a, b) =>\n      new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n    );\n  } catch {\n    return [];\n  }\n}\n\n/**\n * Get the most recent session\n */\nexport async function getMostRecentSession(outputDir: string): Promise<Session | null> {\n  const sessions = await listSessions(outputDir);\n  return sessions[0] || null;\n}\n\n/**\n * Delete a session\n */\nexport async function deleteSession(outputDir: string, sessionId: string): Promise<boolean> {\n  const paths = getSessionPaths(outputDir, sessionId);\n\n  try {\n    await rm(paths.root, { recursive: true, force: true });\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Parse duration string to milliseconds\n */\nfunction parseDuration(duration: string): number {\n  const match = duration.match(/^(\\d+)(d|h|m|s)$/);\n  if (!match) {\n    throw new Error(`Invalid duration format: ${duration}. Use format like '7d', '24h', '30m', '60s'`);\n  }\n\n  const value = parseInt(match[1], 10);\n  const unit = match[2];\n\n  switch (unit) {\n    case 'd': return value * 24 * 60 * 60 * 1000;\n    case 'h': return value * 60 * 60 * 1000;\n    case 'm': return value * 60 * 1000;\n    case 's': return value * 1000;\n    default: return value * 1000;\n  }\n}\n\n/**\n * Clean old sessions\n */\nexport async function cleanSessions(\n  outputDir: string,\n  options: CleanOptions = {}\n): Promise<{ deleted: string[]; kept: string[] }> {\n  const { olderThan, keepLast = 0, dryRun = false } = options;\n  const sessions = await listSessions(outputDir);\n\n  const deleted: string[] = [];\n  const kept: string[] = [];\n\n  // Sessions to keep based on keepLast\n  const keepIds = new Set(sessions.slice(0, keepLast).map(s => s.id));\n\n  // Calculate cutoff time if olderThan is specified\n  const cutoffTime = olderThan\n    ? Date.now() - parseDuration(olderThan)\n    : 0;\n\n  for (const session of sessions) {\n    const sessionTime = new Date(session.createdAt).getTime();\n    const shouldDelete = !keepIds.has(session.id) &&\n      (olderThan ? sessionTime < cutoffTime : true);\n\n    if (shouldDelete && !keepIds.has(session.id)) {\n      if (!dryRun) {\n        await deleteSession(outputDir, session.id);\n      }\n      deleted.push(session.id);\n    } else {\n      kept.push(session.id);\n    }\n  }\n\n  return { deleted, kept };\n}\n\n/**\n * Find sessions matching query criteria\n */\nexport async function findSessions(\n  outputDir: string,\n  query: Partial<SessionQuery> = {}\n): Promise<Session[]> {\n  // Validate query with defaults\n  const validatedQuery = SessionQuerySchema.parse({\n    limit: 50,\n    ...query,\n  });\n\n  const allSessions = await listSessions(outputDir);\n  let filtered = allSessions;\n\n  // Filter by route (extract path from URL)\n  if (validatedQuery.route) {\n    const routePattern = validatedQuery.route.toLowerCase();\n    filtered = filtered.filter(s => {\n      try {\n        const urlPath = new URL(s.url).pathname.toLowerCase();\n        return urlPath.includes(routePattern) || urlPath === routePattern;\n      } catch {\n        return s.url.toLowerCase().includes(routePattern);\n      }\n    });\n  }\n\n  // Filter by URL (exact or partial match)\n  if (validatedQuery.url) {\n    const urlPattern = validatedQuery.url.toLowerCase();\n    filtered = filtered.filter(s => s.url.toLowerCase().includes(urlPattern));\n  }\n\n  // Filter by status\n  if (validatedQuery.status) {\n    filtered = filtered.filter(s => s.status === validatedQuery.status);\n  }\n\n  // Filter by name\n  if (validatedQuery.name) {\n    const namePattern = validatedQuery.name.toLowerCase();\n    filtered = filtered.filter(s => s.name.toLowerCase().includes(namePattern));\n  }\n\n  // Filter by viewport\n  if (validatedQuery.viewport) {\n    const viewportPattern = validatedQuery.viewport.toLowerCase();\n    filtered = filtered.filter(s => s.viewport.name.toLowerCase() === viewportPattern);\n  }\n\n  // Filter by date range\n  if (validatedQuery.createdAfter) {\n    const afterTime = validatedQuery.createdAfter.getTime();\n    filtered = filtered.filter(s => new Date(s.createdAt).getTime() >= afterTime);\n  }\n\n  if (validatedQuery.createdBefore) {\n    const beforeTime = validatedQuery.createdBefore.getTime();\n    filtered = filtered.filter(s => new Date(s.createdAt).getTime() <= beforeTime);\n  }\n\n  // Apply limit\n  return filtered.slice(0, validatedQuery.limit);\n}\n\n/**\n * Get timeline of sessions for a specific route/URL\n * Returns sessions in chronological order (oldest first) for tracking changes over time\n */\nexport async function getTimeline(\n  outputDir: string,\n  route: string,\n  limit: number = 10\n): Promise<Session[]> {\n  const sessions = await findSessions(outputDir, { route, limit });\n  // Reverse to get chronological order (oldest first)\n  return sessions.reverse();\n}\n\n/**\n * Get sessions grouped by route\n */\nexport async function getSessionsByRoute(\n  outputDir: string\n): Promise<Record<string, Session[]>> {\n  const allSessions = await listSessions(outputDir);\n  const byRoute: Record<string, Session[]> = {};\n\n  for (const session of allSessions) {\n    let route: string;\n    try {\n      route = new URL(session.url).pathname;\n    } catch {\n      route = session.url;\n    }\n\n    if (!byRoute[route]) {\n      byRoute[route] = [];\n    }\n    byRoute[route].push(session);\n  }\n\n  return byRoute;\n}\n\n/**\n * Get session statistics\n */\nexport async function getSessionStats(outputDir: string): Promise<{\n  total: number;\n  byStatus: Record<string, number>;\n  byViewport: Record<string, number>;\n  byVerdict: Record<string, number>;\n}> {\n  const sessions = await listSessions(outputDir);\n\n  const byStatus: Record<string, number> = {};\n  const byViewport: Record<string, number> = {};\n  const byVerdict: Record<string, number> = {};\n\n  for (const session of sessions) {\n    // Count by status\n    byStatus[session.status] = (byStatus[session.status] || 0) + 1;\n\n    // Count by viewport\n    const viewportName = session.viewport.name;\n    byViewport[viewportName] = (byViewport[viewportName] || 0) + 1;\n\n    // Count by verdict\n    if (session.analysis?.verdict) {\n      byVerdict[session.analysis.verdict] = (byVerdict[session.analysis.verdict] || 0) + 1;\n    }\n  }\n\n  return {\n    total: sessions.length,\n    byStatus,\n    byViewport,\n    byVerdict,\n  };\n}\n","import type { Session, ComparisonResult, Analysis, ComparisonReport } from './schemas.js';\nimport { getSessionPaths } from './session.js';\n\n/**\n * Generate a full comparison report\n */\nexport function generateReport(\n  session: Session,\n  comparison: ComparisonResult,\n  analysis: Analysis,\n  outputDir: string,\n  webViewPort?: number\n): ComparisonReport {\n  const paths = getSessionPaths(outputDir, session.id);\n\n  const report: ComparisonReport = {\n    sessionId: session.id,\n    sessionName: session.name,\n    url: session.url,\n    timestamp: new Date().toISOString(),\n    viewport: session.viewport,\n    comparison,\n    analysis,\n    files: {\n      baseline: paths.baseline,\n      current: paths.current,\n      diff: paths.diff,\n    },\n  };\n\n  if (webViewPort) {\n    report.webViewUrl = `http://localhost:${webViewPort}/sessions/${session.id}`;\n  }\n\n  return report;\n}\n\n/**\n * Get verdict indicator (text-based, no emojis)\n */\nfunction getVerdictIndicator(verdict: string): { symbol: string; label: string } {\n  switch (verdict) {\n    case 'MATCH':\n      return { symbol: '[PASS]', label: 'No visual changes detected' };\n    case 'EXPECTED_CHANGE':\n      return { symbol: '[OK]  ', label: 'Changes detected, appear intentional' };\n    case 'UNEXPECTED_CHANGE':\n      return { symbol: '[WARN]', label: 'Unexpected changes - investigate' };\n    case 'LAYOUT_BROKEN':\n      return { symbol: '[FAIL]', label: 'Layout broken - fix required' };\n    default:\n      return { symbol: '[????]', label: 'Unknown verdict' };\n  }\n}\n\n/**\n * Format report as human-readable text\n */\nexport function formatReportText(report: ComparisonReport): string {\n  const lines: string[] = [];\n  const { symbol, label } = getVerdictIndicator(report.analysis.verdict);\n\n  // Verdict first - most important info\n  lines.push('');\n  lines.push(`${symbol} ${report.analysis.verdict} - ${label}`);\n  lines.push('');\n  lines.push(`Diff: ${report.comparison.diffPercent}% (${report.comparison.diffPixels.toLocaleString()} pixels)`);\n  lines.push('');\n  lines.push('---');\n  lines.push('');\n  lines.push(`Session: ${report.sessionName} (${report.sessionId})`);\n  lines.push(`URL: ${report.url}`);\n  lines.push(`Viewport: ${report.viewport.name} (${report.viewport.width}x${report.viewport.height})`);\n  lines.push('');\n  lines.push(`Summary: ${report.analysis.summary}`);\n\n  if (report.analysis.recommendation) {\n    lines.push('');\n    lines.push(`Recommendation: ${report.analysis.recommendation}`);\n  }\n\n  if (report.analysis.unexpectedChanges.length > 0) {\n    lines.push('');\n    lines.push('Unexpected Changes:');\n    for (const change of report.analysis.unexpectedChanges) {\n      lines.push(`  - ${change.location}: ${change.description}`);\n    }\n  }\n\n  lines.push('');\n  lines.push('Files:');\n  lines.push(`  Baseline: ${report.files.baseline}`);\n  lines.push(`  Current: ${report.files.current}`);\n  lines.push(`  Diff: ${report.files.diff}`);\n\n  if (report.webViewUrl) {\n    lines.push('');\n    lines.push(`View in browser: ${report.webViewUrl}`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format report as minimal output (for scripts)\n */\nexport function formatReportMinimal(report: ComparisonReport): string {\n  const status = report.comparison.match ? 'PASS' : 'FAIL';\n  return `${status} ${report.sessionId} ${report.analysis.verdict} ${report.comparison.diffPercent}%`;\n}\n\n/**\n * Format report as JSON\n */\nexport function formatReportJson(report: ComparisonReport): string {\n  return JSON.stringify(report, null, 2);\n}\n\n/**\n * Generate a summary line for session listing\n */\nexport function formatSessionSummary(session: Session): string {\n  const status = session.status.padEnd(8);\n  const viewport = `${session.viewport.name}`.padEnd(8);\n  const date = new Date(session.createdAt).toLocaleDateString();\n\n  let diffInfo = '';\n  if (session.comparison) {\n    diffInfo = session.comparison.match\n      ? ' (no diff)'\n      : ` (${session.comparison.diffPercent}% diff)`;\n  }\n\n  return `${session.id}  ${status}  ${viewport}  ${date}  ${session.name}${diffInfo}`;\n}\n","import { chromium, Browser } from 'playwright';\n\n/**\n * UI metrics extracted from a page for consistency checking\n */\nexport interface PageMetrics {\n  url: string;\n  path: string;\n  title: string;\n\n  // Layout metrics\n  layout: {\n    headerHeight: number | null;\n    navWidth: number | null;\n    contentPadding: { top: number; right: number; bottom: number; left: number } | null;\n    footerHeight: number | null;\n  };\n\n  // Typography metrics\n  typography: {\n    bodyFontFamily: string | null;\n    bodyFontSize: string | null;\n    headingFontFamily: string | null;\n    h1FontSize: string | null;\n    h2FontSize: string | null;\n    lineHeight: string | null;\n  };\n\n  // Color metrics\n  colors: {\n    backgroundColor: string | null;\n    textColor: string | null;\n    linkColor: string | null;\n    primaryButtonBg: string | null;\n    primaryButtonText: string | null;\n  };\n\n  // Spacing metrics (common elements)\n  spacing: {\n    buttonPadding: string | null;\n    cardPadding: string | null;\n    sectionGap: string | null;\n  };\n}\n\n/**\n * Inconsistency found between pages\n */\nexport interface Inconsistency {\n  type: 'layout' | 'typography' | 'color' | 'spacing';\n  property: string;\n  severity: 'info' | 'warning' | 'error';\n  description: string;\n  pages: Array<{\n    path: string;\n    value: string | number | null;\n  }>;\n  suggestion?: string;\n}\n\n/**\n * Consistency check result\n */\nexport interface ConsistencyResult {\n  pages: PageMetrics[];\n  inconsistencies: Inconsistency[];\n  score: number; // 0-100, higher is more consistent\n  summary: string;\n}\n\n/**\n * Consistency check options\n */\nexport interface ConsistencyOptions {\n  /** URLs to check */\n  urls: string[];\n  /** Enable verbose output */\n  verbose?: boolean;\n  /** Timeout per page (ms) */\n  timeout?: number;\n  /** Ignore certain property types */\n  ignore?: Array<'layout' | 'typography' | 'color' | 'spacing'>;\n}\n\n/**\n * Extract UI metrics from a page\n */\nasync function extractMetrics(page: import('playwright').Page, url: string): Promise<PageMetrics> {\n  const parsedUrl = new URL(url);\n\n  const metrics = await page.evaluate(() => {\n    const getComputedStyleProp = (selector: string, prop: string): string | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return window.getComputedStyle(el).getPropertyValue(prop) || null;\n    };\n\n    const getElementHeight = (selector: string): number | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return el.getBoundingClientRect().height;\n    };\n\n    const getElementWidth = (selector: string): number | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return el.getBoundingClientRect().width;\n    };\n\n    // Try multiple selectors for common elements\n    const headerSelectors = ['header', '[role=\"banner\"]', '.header', '#header', 'nav'];\n    const navSelectors = ['nav', '[role=\"navigation\"]', '.sidebar', '.nav', '#sidebar'];\n    const mainSelectors = ['main', '[role=\"main\"]', '.content', '#content', '.main'];\n    const footerSelectors = ['footer', '[role=\"contentinfo\"]', '.footer', '#footer'];\n    const buttonSelectors = ['button', '.btn', '[role=\"button\"]', 'a.button'];\n    const cardSelectors = ['.card', '[class*=\"card\"]', '.panel', '.box'];\n\n    const findFirst = (selectors: string[], fn: (s: string) => string | number | null) => {\n      for (const sel of selectors) {\n        const result = fn(sel);\n        if (result !== null) return result;\n      }\n      return null;\n    };\n\n    // Get padding from main content\n    const getContentPadding = (): { top: number; right: number; bottom: number; left: number } | null => {\n      for (const sel of mainSelectors) {\n        const el = document.querySelector(sel);\n        if (el) {\n          const style = window.getComputedStyle(el);\n          return {\n            top: parseFloat(style.paddingTop) || 0,\n            right: parseFloat(style.paddingRight) || 0,\n            bottom: parseFloat(style.paddingBottom) || 0,\n            left: parseFloat(style.paddingLeft) || 0,\n          };\n        }\n      }\n      return null;\n    };\n\n    return {\n      title: document.title,\n      layout: {\n        headerHeight: findFirst(headerSelectors, getElementHeight) as number | null,\n        navWidth: findFirst(navSelectors, getElementWidth) as number | null,\n        contentPadding: getContentPadding(),\n        footerHeight: findFirst(footerSelectors, getElementHeight) as number | null,\n      },\n      typography: {\n        bodyFontFamily: getComputedStyleProp('body', 'font-family'),\n        bodyFontSize: getComputedStyleProp('body', 'font-size'),\n        headingFontFamily: getComputedStyleProp('h1, h2, h3', 'font-family'),\n        h1FontSize: getComputedStyleProp('h1', 'font-size'),\n        h2FontSize: getComputedStyleProp('h2', 'font-size'),\n        lineHeight: getComputedStyleProp('body', 'line-height'),\n      },\n      colors: {\n        backgroundColor: getComputedStyleProp('body', 'background-color'),\n        textColor: getComputedStyleProp('body', 'color'),\n        linkColor: getComputedStyleProp('a', 'color'),\n        primaryButtonBg: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'background-color')) as string | null,\n        primaryButtonText: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'color')) as string | null,\n      },\n      spacing: {\n        buttonPadding: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'padding')) as string | null,\n        cardPadding: findFirst(cardSelectors, s => getComputedStyleProp(s, 'padding')) as string | null,\n        sectionGap: getComputedStyleProp('main > *', 'margin-bottom'),\n      },\n    };\n  });\n\n  return {\n    url,\n    path: parsedUrl.pathname,\n    ...metrics,\n  };\n}\n\n/**\n * Compare metrics across pages and find inconsistencies\n */\nfunction findInconsistencies(pages: PageMetrics[], ignore: string[] = []): Inconsistency[] {\n  const inconsistencies: Inconsistency[] = [];\n\n  // Helper to check if values are consistent\n  const checkProperty = (\n    type: Inconsistency['type'],\n    property: string,\n    getValue: (p: PageMetrics) => string | number | null,\n    description: string,\n    severity: Inconsistency['severity'] = 'warning'\n  ) => {\n    if (ignore.includes(type)) return;\n\n    const values = pages.map(p => ({\n      path: p.path,\n      value: getValue(p),\n    }));\n\n    // Filter out null values\n    const nonNullValues = values.filter(v => v.value !== null);\n    if (nonNullValues.length < 2) return;\n\n    // Check if all values are the same\n    const uniqueValues = new Set(nonNullValues.map(v => String(v.value)));\n    if (uniqueValues.size > 1) {\n      inconsistencies.push({\n        type,\n        property,\n        severity,\n        description,\n        pages: values,\n      });\n    }\n  };\n\n  // Layout checks\n  checkProperty('layout', 'headerHeight', p => p.layout.headerHeight, 'Header height differs across pages');\n  checkProperty('layout', 'navWidth', p => p.layout.navWidth, 'Navigation width differs across pages');\n  checkProperty('layout', 'footerHeight', p => p.layout.footerHeight, 'Footer height differs across pages');\n\n  // Typography checks\n  checkProperty('typography', 'bodyFontFamily', p => p.typography.bodyFontFamily, 'Body font family differs across pages', 'error');\n  checkProperty('typography', 'bodyFontSize', p => p.typography.bodyFontSize, 'Body font size differs across pages');\n  checkProperty('typography', 'headingFontFamily', p => p.typography.headingFontFamily, 'Heading font family differs across pages', 'error');\n  checkProperty('typography', 'h1FontSize', p => p.typography.h1FontSize, 'H1 font size differs across pages');\n  checkProperty('typography', 'lineHeight', p => p.typography.lineHeight, 'Line height differs across pages');\n\n  // Color checks\n  checkProperty('color', 'backgroundColor', p => p.colors.backgroundColor, 'Background color differs across pages');\n  checkProperty('color', 'textColor', p => p.colors.textColor, 'Text color differs across pages', 'error');\n  checkProperty('color', 'linkColor', p => p.colors.linkColor, 'Link color differs across pages');\n  checkProperty('color', 'primaryButtonBg', p => p.colors.primaryButtonBg, 'Primary button background differs across pages');\n\n  // Spacing checks\n  checkProperty('spacing', 'buttonPadding', p => p.spacing.buttonPadding, 'Button padding differs across pages');\n  checkProperty('spacing', 'cardPadding', p => p.spacing.cardPadding, 'Card padding differs across pages');\n\n  return inconsistencies;\n}\n\n/**\n * Calculate consistency score based on inconsistencies\n */\nfunction calculateScore(inconsistencies: Inconsistency[]): number {\n  if (inconsistencies.length === 0) return 100;\n\n  const weights = { error: 10, warning: 5, info: 1 };\n  const totalPenalty = inconsistencies.reduce((sum, i) => sum + weights[i.severity], 0);\n\n  // Score decreases based on penalty, minimum 0\n  return Math.max(0, 100 - totalPenalty);\n}\n\n/**\n * Check UI consistency across multiple pages\n */\nexport async function checkConsistency(options: ConsistencyOptions): Promise<ConsistencyResult> {\n  const { urls, timeout = 15000, ignore = [] } = options;\n\n  let browser: Browser | null = null;\n  const pages: PageMetrics[] = [];\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const context = await browser.newContext({\n      viewport: { width: 1920, height: 1080 },\n    });\n    const page = await context.newPage();\n\n    for (const url of urls) {\n      try {\n        await page.goto(url, {\n          waitUntil: 'domcontentloaded',\n          timeout,\n        });\n\n        const metrics = await extractMetrics(page, url);\n        pages.push(metrics);\n      } catch (error) {\n        console.error(`Failed to analyze ${url}:`, error instanceof Error ? error.message : error);\n      }\n    }\n\n    await browser.close();\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n\n  if (pages.length < 2) {\n    return {\n      pages,\n      inconsistencies: [],\n      score: 100,\n      summary: 'Need at least 2 pages to check consistency',\n    };\n  }\n\n  const inconsistencies = findInconsistencies(pages, ignore);\n  const score = calculateScore(inconsistencies);\n\n  const errorCount = inconsistencies.filter(i => i.severity === 'error').length;\n  const warningCount = inconsistencies.filter(i => i.severity === 'warning').length;\n\n  let summary: string;\n  if (score === 100) {\n    summary = `All ${pages.length} pages are consistent.`;\n  } else if (score >= 80) {\n    summary = `Minor inconsistencies found across ${pages.length} pages. ${warningCount} warning(s).`;\n  } else if (score >= 50) {\n    summary = `Notable inconsistencies found. ${errorCount} error(s), ${warningCount} warning(s).`;\n  } else {\n    summary = `Significant style inconsistencies detected. ${errorCount} error(s), ${warningCount} warning(s). Review recommended.`;\n  }\n\n  return {\n    pages,\n    inconsistencies,\n    score,\n    summary,\n  };\n}\n\n/**\n * Format consistency result for display\n */\nexport function formatConsistencyReport(result: ConsistencyResult): string {\n  const lines: string[] = [];\n\n  lines.push('');\n  lines.push('  UI CONSISTENCY REPORT');\n  lines.push('');\n  lines.push('');\n  lines.push(`Score: ${result.score}/100`);\n  lines.push(`Pages analyzed: ${result.pages.length}`);\n  lines.push(`Summary: ${result.summary}`);\n  lines.push('');\n\n  if (result.inconsistencies.length === 0) {\n    lines.push(' No inconsistencies found');\n  } else {\n    lines.push('Inconsistencies:');\n    lines.push('');\n\n    for (const issue of result.inconsistencies) {\n      const icon = issue.severity === 'error' ? '' : issue.severity === 'warning' ? '!' : '';\n      lines.push(`  ${icon} [${issue.type}] ${issue.description}`);\n\n      for (const page of issue.pages) {\n        if (page.value !== null) {\n          lines.push(`      ${page.path}: ${page.value}`);\n        }\n      }\n      lines.push('');\n    }\n  }\n\n  lines.push('');\n  lines.push('Pages analyzed:');\n  for (const page of result.pages) {\n    lines.push(`   ${page.path} (${page.title})`);\n  }\n\n  return lines.join('\\n');\n}\n","import { chromium, Browser } from 'playwright';\nimport { URL } from 'url';\n\nexport interface CrawlOptions {\n  /** Starting URL */\n  url: string;\n  /** Maximum number of pages to discover (default: 5) */\n  maxPages?: number;\n  /** Only crawl pages under this path prefix */\n  pathPrefix?: string;\n  /** Timeout per page in ms (default: 10000) */\n  timeout?: number;\n  /** Include external links (default: false) */\n  includeExternal?: boolean;\n}\n\nexport interface DiscoveredPage {\n  url: string;\n  path: string;\n  title: string;\n  linkText?: string;\n  depth: number;\n}\n\nexport interface CrawlResult {\n  baseUrl: string;\n  pages: DiscoveredPage[];\n  totalLinks: number;\n  crawlTime: number;\n}\n\n/**\n * Discover pages on a website by crawling from the starting URL\n * Returns up to maxPages unique pages within the same origin\n */\nexport async function discoverPages(options: CrawlOptions): Promise<CrawlResult> {\n  const {\n    url,\n    maxPages = 5,\n    pathPrefix,\n    timeout = 10000,\n    includeExternal = false,\n  } = options;\n\n  const startTime = Date.now();\n  const startUrl = new URL(url);\n  const origin = startUrl.origin;\n\n  const discovered: Map<string, DiscoveredPage> = new Map();\n  const visited: Set<string> = new Set();\n  const queue: { url: string; depth: number; linkText?: string }[] = [\n    { url: url, depth: 0 }\n  ];\n\n  let browser: Browser | null = null;\n  let totalLinks = 0;\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const context = await browser.newContext();\n    const page = await context.newPage();\n\n    while (queue.length > 0 && discovered.size < maxPages) {\n      const current = queue.shift();\n      if (!current) break;\n\n      const currentUrl = normalizeUrl(current.url);\n      if (visited.has(currentUrl)) continue;\n      visited.add(currentUrl);\n\n      try {\n        // Navigate to page\n        await page.goto(current.url, {\n          waitUntil: 'domcontentloaded',\n          timeout,\n        });\n\n        // Get page title\n        const title = await page.title();\n\n        // Add to discovered pages\n        const parsedUrl = new URL(current.url);\n        discovered.set(currentUrl, {\n          url: current.url,\n          path: parsedUrl.pathname,\n          title: title || parsedUrl.pathname,\n          linkText: current.linkText,\n          depth: current.depth,\n        });\n\n        // Only continue crawling if we haven't reached max\n        if (discovered.size >= maxPages) break;\n\n        // Find all links on the page\n        const links = await page.evaluate((): { href: string; text: string }[] => {\n          const anchors = Array.from(document.querySelectorAll('a[href]'));\n          return anchors.map((a: Element) => ({\n            href: (a as HTMLAnchorElement).getAttribute('href') || '',\n            text: a.textContent?.trim() || '',\n          }));\n        });\n\n        totalLinks += links.length;\n\n        // Process links\n        for (const link of links) {\n          if (discovered.size >= maxPages) break;\n\n          try {\n            const absoluteUrl = new URL(link.href, current.url);\n            const normalizedUrl = normalizeUrl(absoluteUrl.href);\n\n            // Skip if already visited or queued\n            if (visited.has(normalizedUrl)) continue;\n\n            // Check if same origin\n            if (!includeExternal && absoluteUrl.origin !== origin) continue;\n\n            // Check path prefix if specified\n            if (pathPrefix && !absoluteUrl.pathname.startsWith(pathPrefix)) continue;\n\n            // Skip common non-page URLs\n            if (shouldSkipUrl(absoluteUrl)) continue;\n\n            // Add to queue\n            queue.push({\n              url: absoluteUrl.href,\n              depth: current.depth + 1,\n              linkText: link.text,\n            });\n          } catch {\n            // Invalid URL, skip\n          }\n        }\n      } catch (error) {\n        // Page failed to load, continue with next\n        console.error(`Failed to load ${current.url}:`, error instanceof Error ? error.message : error);\n      }\n    }\n\n    await browser.close();\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n\n  const crawlTime = Date.now() - startTime;\n\n  return {\n    baseUrl: origin,\n    pages: Array.from(discovered.values()).sort((a, b) => {\n      // Sort by depth first, then by path\n      if (a.depth !== b.depth) return a.depth - b.depth;\n      return a.path.localeCompare(b.path);\n    }),\n    totalLinks,\n    crawlTime,\n  };\n}\n\n/**\n * Normalize URL for comparison (remove trailing slash, hash, query params)\n */\nfunction normalizeUrl(url: string): string {\n  try {\n    const parsed = new URL(url);\n    // Remove hash and query, normalize trailing slash\n    let normalized = `${parsed.origin}${parsed.pathname}`;\n    if (normalized.endsWith('/') && normalized.length > 1) {\n      normalized = normalized.slice(0, -1);\n    }\n    return normalized;\n  } catch {\n    return url;\n  }\n}\n\n/**\n * Check if URL should be skipped (non-page resources)\n */\nfunction shouldSkipUrl(url: URL): boolean {\n  const path = url.pathname.toLowerCase();\n  const skipExtensions = [\n    '.pdf', '.jpg', '.jpeg', '.png', '.gif', '.svg', '.webp',\n    '.css', '.js', '.json', '.xml', '.ico', '.woff', '.woff2',\n    '.mp3', '.mp4', '.webm', '.zip', '.tar', '.gz',\n  ];\n\n  if (skipExtensions.some(ext => path.endsWith(ext))) return true;\n\n  // Skip common non-content paths\n  const skipPaths = [\n    '/api/', '/static/', '/assets/', '/_next/', '/fonts/',\n    '/images/', '/img/', '/cdn/', '/admin/', '/auth/',\n  ];\n\n  if (skipPaths.some(p => path.includes(p))) return true;\n\n  // Skip hash-only links\n  if (url.hash && url.pathname === '/') return true;\n\n  return false;\n}\n\n/**\n * Quick scan to get navigation links from a page\n * Useful for finding main pages without full crawl\n */\nexport async function getNavigationLinks(url: string): Promise<DiscoveredPage[]> {\n  let browser: Browser | null = null;\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const page = await browser.newPage();\n\n    await page.goto(url, {\n      waitUntil: 'domcontentloaded',\n      timeout: 15000,\n    });\n\n    const origin = new URL(url).origin;\n\n    // Find links in navigation elements\n    const navLinks = await page.evaluate((): { href: string; text: string }[] => {\n      const selectors = [\n        'nav a[href]',\n        'header a[href]',\n        '[role=\"navigation\"] a[href]',\n        '.nav a[href]',\n        '.navbar a[href]',\n        '.sidebar a[href]',\n        '.menu a[href]',\n      ];\n\n      const links: { href: string; text: string }[] = [];\n      const seen = new Set<string>();\n\n      for (const selector of selectors) {\n        const anchors = Array.from(document.querySelectorAll(selector));\n        for (const a of anchors) {\n          const href = (a as HTMLAnchorElement).getAttribute('href');\n          const text = a.textContent?.trim();\n          if (href && text && !seen.has(href)) {\n            seen.add(href);\n            links.push({ href, text });\n          }\n        }\n      }\n\n      return links;\n    });\n\n    await browser.close();\n\n    // Convert to DiscoveredPage format\n    const pages: DiscoveredPage[] = [];\n\n    for (const link of navLinks) {\n      try {\n        const absoluteUrl = new URL(link.href, url);\n\n        // Only include same-origin links\n        if (absoluteUrl.origin !== origin) continue;\n\n        // Skip resources\n        if (shouldSkipUrl(absoluteUrl)) continue;\n\n        pages.push({\n          url: absoluteUrl.href,\n          path: absoluteUrl.pathname,\n          title: link.text,\n          linkText: link.text,\n          depth: 1,\n        });\n      } catch {\n        // Invalid URL\n      }\n    }\n\n    // Remove duplicates by path\n    const uniquePages = new Map<string, DiscoveredPage>();\n    for (const page of pages) {\n      if (!uniquePages.has(page.path)) {\n        uniquePages.set(page.path, page);\n      }\n    }\n\n    return Array.from(uniquePages.values());\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n}\n","/**\n * integration.ts\n * Extract API calls from TypeScript/React component files\n *\n * Detects:\n * - fetch() calls\n * - axios methods (get, post, put, delete, patch, etc.)\n * - Template literals and variable URLs\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\n\nexport interface ApiCall {\n  endpoint: string;       // \"/api/users\" or \"https://...\" or \"${dynamic}\"\n  method: string;         // GET, POST, PUT, DELETE, PATCH, etc.\n  sourceFile: string;     // File where call was found\n  lineNumber?: number;    // Line number in source\n  callerContext?: string; // Function/component name containing the call\n  isDynamic?: boolean;    // True if endpoint uses template literals or variables\n}\n\n/**\n * Represents an API route discovered in the project\n */\nexport interface ApiRoute {\n  route: string;          // \"/api/users\", \"/api/posts/[id]\"\n  method: string[];       // [\"GET\", \"POST\"] based on exports\n  sourceFile: string;     // \"app/api/users/route.ts\"\n  isDynamic: boolean;     // Has [param] segments\n}\n\n/**\n * Extract the function/component context around a line number\n */\nfunction extractCallerContext(content: string, targetLine: number): string | undefined {\n  const lines = content.split('\\n');\n\n  // Search backwards from target line to find function/component declaration\n  for (let i = targetLine - 1; i >= Math.max(0, targetLine - 30); i--) {\n    const line = lines[i];\n\n    // Match function declarations, arrow functions, and React components\n    const functionMatch = line.match(/(?:export\\s+)?(?:async\\s+)?function\\s+(\\w+)/);\n    const arrowMatch = line.match(/(?:export\\s+)?const\\s+(\\w+)\\s*=\\s*(?:async\\s*)?\\(/);\n    const componentMatch = line.match(/(?:export\\s+)?(?:const|function)\\s+([A-Z]\\w+)/);\n\n    if (functionMatch) return functionMatch[1];\n    if (arrowMatch) return arrowMatch[1];\n    if (componentMatch) return componentMatch[1];\n  }\n\n  return undefined;\n}\n\n/**\n * Parse endpoint string, detecting dynamic parts\n */\nfunction parseEndpoint(rawEndpoint: string): { endpoint: string; isDynamic: boolean } {\n  // Check for template literal patterns\n  const hasTemplateLiteral = rawEndpoint.includes('${') || rawEndpoint.includes('`');\n\n  // Check for concatenation patterns\n  const hasConcatenation = /['\"].*\\+|^\\w+$/.test(rawEndpoint);\n\n  if (hasTemplateLiteral || hasConcatenation) {\n    return {\n      endpoint: rawEndpoint.replace(/`/g, '').replace(/\\$\\{[^}]+\\}/g, '{dynamic}'),\n      isDynamic: true\n    };\n  }\n\n  // Clean up quotes\n  return {\n    endpoint: rawEndpoint.replace(/['\"]/g, ''),\n    isDynamic: false\n  };\n}\n\n/**\n * Extract API calls from file content\n */\nfunction extractFromContent(content: string, sourceFile: string): ApiCall[] {\n  const calls: ApiCall[] = [];\n  const lines = content.split('\\n');\n\n  // Pattern 1: fetch() calls\n  // Matches: fetch('/api/users'), fetch(\"/api/users\"), fetch(`/api/${id}`)\n  const fetchPattern = /fetch\\s*\\(\\s*(['\"`])([^'\"`]+)\\1/g;\n  const fetchWithOptionsPattern = /fetch\\s*\\(\\s*(['\"`])([^'\"`]+)\\1\\s*,\\s*\\{[^}]*method\\s*:\\s*['\"](\\w+)['\"]/g;\n\n  // Pattern 2: axios method calls\n  // Matches: axios.get('/api/users'), axios.post('/api/users', data)\n  const axiosPattern = /axios\\.(get|post|put|delete|patch|head|options)\\s*\\(\\s*(['\"`])([^'\"`]+)\\2/g;\n\n  // Pattern 3: axios with method in config\n  // Matches: axios({ url: '/api/users', method: 'POST' })\n  const axiosConfigPattern = /axios\\s*\\(\\s*\\{[^}]*url\\s*:\\s*(['\"`])([^'\"`]+)\\1[^}]*method\\s*:\\s*['\"](\\w+)['\"]/g;\n\n  // Pattern 4: Template literals (more complex)\n  const templateLiteralPattern = /(?:fetch|axios(?:\\.\\w+)?)\\s*\\(\\s*`([^`]+)`/g;\n\n  // Pattern 5: Variable URLs\n  const urlVariablePattern = /const\\s+(\\w*[Uu]rl\\w*)\\s*=\\s*(['\"`])([^'\"`]+)\\2/g;\n  const urlUsagePattern = /(?:fetch|axios(?:\\.\\w+)?)\\s*\\(\\s*(\\w+)/g;\n\n  // Track URL variables\n  const urlVariables = new Map<string, { endpoint: string; lineNumber: number }>();\n\n  // First pass: collect URL variables\n  lines.forEach((line, index) => {\n    let match;\n    const urlVarRegex = new RegExp(urlVariablePattern.source, 'g');\n    while ((match = urlVarRegex.exec(line)) !== null) {\n      urlVariables.set(match[1], {\n        endpoint: match[3],\n        lineNumber: index + 1\n      });\n    }\n  });\n\n  // Second pass: extract API calls\n  lines.forEach((line, index) => {\n    const lineNumber = index + 1;\n\n    // Match fetch with explicit method\n    let match;\n    const fetchOptsRegex = new RegExp(fetchWithOptionsPattern.source, 'g');\n    while ((match = fetchOptsRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[2]);\n      calls.push({\n        endpoint,\n        method: match[3].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match basic fetch (default GET)\n    const fetchRegex = new RegExp(fetchPattern.source, 'g');\n    while ((match = fetchRegex.exec(line)) !== null) {\n      // Skip if already matched with options\n      if (!line.includes('method:')) {\n        const { endpoint, isDynamic } = parseEndpoint(match[2]);\n        calls.push({\n          endpoint,\n          method: 'GET',\n          sourceFile,\n          lineNumber,\n          callerContext: extractCallerContext(content, lineNumber),\n          isDynamic\n        });\n      }\n    }\n\n    // Match axios method calls\n    const axiosRegex = new RegExp(axiosPattern.source, 'g');\n    while ((match = axiosRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[3]);\n      calls.push({\n        endpoint,\n        method: match[1].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match axios config object\n    const axiosConfigRegex = new RegExp(axiosConfigPattern.source, 'g');\n    while ((match = axiosConfigRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[2]);\n      calls.push({\n        endpoint,\n        method: match[3].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match template literals\n    const templateRegex = new RegExp(templateLiteralPattern.source, 'g');\n    while ((match = templateRegex.exec(line)) !== null) {\n      const { endpoint } = parseEndpoint(match[1]);\n\n      // Try to determine method\n      let method = 'GET';\n      const methodMatch = line.match(/method\\s*:\\s*['\"](\\w+)['\"]/);\n      if (methodMatch) {\n        method = methodMatch[1].toUpperCase();\n      }\n\n      calls.push({\n        endpoint,\n        method,\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic: true // Template literals are always dynamic\n      });\n    }\n\n    // Match variable usage\n    const urlUsageRegex = new RegExp(urlUsagePattern.source, 'g');\n    while ((match = urlUsageRegex.exec(line)) !== null) {\n      const varName = match[1];\n      if (urlVariables.has(varName)) {\n        const urlInfo = urlVariables.get(varName)!;\n        const { endpoint, isDynamic } = parseEndpoint(urlInfo.endpoint);\n\n        // Try to determine method\n        let method = 'GET';\n        const methodMatch = line.match(/method\\s*:\\s*['\"](\\w+)['\"]/);\n        if (methodMatch) {\n          method = methodMatch[1].toUpperCase();\n        }\n\n        calls.push({\n          endpoint,\n          method,\n          sourceFile,\n          lineNumber,\n          callerContext: extractCallerContext(content, lineNumber),\n          isDynamic\n        });\n      }\n    }\n  });\n\n  // Deduplicate calls (same endpoint, method, and line)\n  const uniqueCalls = calls.filter((call, index, self) =>\n    index === self.findIndex((c) =>\n      c.endpoint === call.endpoint &&\n      c.method === call.method &&\n      c.lineNumber === call.lineNumber\n    )\n  );\n\n  return uniqueCalls;\n}\n\n/**\n * Parse a single file for fetch/axios calls\n *\n * @param filePath - Absolute path to TypeScript/React file\n * @returns Array of API calls found in the file\n */\nexport async function extractApiCalls(filePath: string): Promise<ApiCall[]> {\n  try {\n    const content = await fs.readFile(filePath, 'utf-8');\n    return extractFromContent(content, filePath);\n  } catch (error) {\n    console.error(`Error reading file ${filePath}:`, error);\n    return [];\n  }\n}\n\n/**\n * Recursively scan directory for TypeScript/React files and extract API calls\n *\n * @param dir - Directory to scan\n * @param pattern - File pattern to match (default: TypeScript/React files)\n * @returns Array of all API calls found\n */\nexport async function scanDirectoryForApiCalls(\n  dir: string,\n  _pattern: string = '**/*.{ts,tsx,js,jsx}'\n): Promise<ApiCall[]> {\n  const allCalls: ApiCall[] = [];\n\n  async function scanDir(currentDir: string): Promise<void> {\n    try {\n      const entries = await fs.readdir(currentDir, { withFileTypes: true });\n\n      for (const entry of entries) {\n        const fullPath = path.join(currentDir, entry.name);\n\n        if (entry.isDirectory()) {\n          // Skip node_modules, dist, build, etc.\n          if (!['node_modules', 'dist', 'build', '.git', 'coverage'].includes(entry.name)) {\n            await scanDir(fullPath);\n          }\n        } else if (entry.isFile()) {\n          // Check if file matches pattern\n          const ext = path.extname(entry.name);\n          if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n            const calls = await extractApiCalls(fullPath);\n            allCalls.push(...calls);\n          }\n        }\n      }\n    } catch (error) {\n      console.error(`Error scanning directory ${currentDir}:`, error);\n    }\n  }\n\n  await scanDir(dir);\n  return allCalls;\n}\n\n/**\n * Group API calls by endpoint\n */\nexport function groupByEndpoint(calls: ApiCall[]): Map<string, ApiCall[]> {\n  const grouped = new Map<string, ApiCall[]>();\n\n  for (const call of calls) {\n    const key = call.endpoint;\n    if (!grouped.has(key)) {\n      grouped.set(key, []);\n    }\n    grouped.get(key)!.push(call);\n  }\n\n  return grouped;\n}\n\n/**\n * Group API calls by source file\n */\nexport function groupByFile(calls: ApiCall[]): Map<string, ApiCall[]> {\n  const grouped = new Map<string, ApiCall[]>();\n\n  for (const call of calls) {\n    const key = call.sourceFile;\n    if (!grouped.has(key)) {\n      grouped.set(key, []);\n    }\n    grouped.get(key)!.push(call);\n  }\n\n  return grouped;\n}\n\n/**\n * Filter calls to only include specific HTTP methods\n */\nexport function filterByMethod(calls: ApiCall[], methods: string[]): ApiCall[] {\n  const upperMethods = methods.map(m => m.toUpperCase());\n  return calls.filter(call => upperMethods.includes(call.method));\n}\n\n/**\n * Filter calls to only include specific endpoints (supports wildcards)\n */\nexport function filterByEndpoint(calls: ApiCall[], endpointPattern: string): ApiCall[] {\n  const regex = new RegExp(\n    '^' + endpointPattern.replace(/\\*/g, '.*').replace(/\\?/g, '.') + '$'\n  );\n  return calls.filter(call => regex.test(call.endpoint));\n}\n\n/**\n * Discover API routes from Next.js/Remix file structure\n * Supports Next.js App Router (app/api) and Pages Router (pages/api)\n */\nexport async function discoverApiRoutes(projectDir: string): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  // Check for Next.js App Router (app/api/**/route.ts)\n  const appApiDir = path.join(projectDir, 'app', 'api');\n  if (await directoryExists(appApiDir)) {\n    const appRoutes = await discoverAppRouterRoutes(appApiDir, projectDir);\n    routes.push(...appRoutes);\n  }\n\n  // Check for Next.js Pages Router (pages/api/**/*.ts)\n  const pagesApiDir = path.join(projectDir, 'pages', 'api');\n  if (await directoryExists(pagesApiDir)) {\n    const pagesRoutes = await discoverPagesRouterRoutes(pagesApiDir, projectDir);\n    routes.push(...pagesRoutes);\n  }\n\n  // Check for src directory variants\n  const srcAppApiDir = path.join(projectDir, 'src', 'app', 'api');\n  if (await directoryExists(srcAppApiDir)) {\n    const srcAppRoutes = await discoverAppRouterRoutes(srcAppApiDir, projectDir);\n    routes.push(...srcAppRoutes);\n  }\n\n  const srcPagesApiDir = path.join(projectDir, 'src', 'pages', 'api');\n  if (await directoryExists(srcPagesApiDir)) {\n    const srcPagesRoutes = await discoverPagesRouterRoutes(srcPagesApiDir, projectDir);\n    routes.push(...srcPagesRoutes);\n  }\n\n  return routes;\n}\n\n/**\n * Convert file path to API route\n * Examples:\n * - app/api/users/route.ts -> /api/users\n * - app/api/users/[id]/route.ts -> /api/users/[id]\n * - pages/api/users.ts -> /api/users\n * - pages/api/users/[id].ts -> /api/users/[id]\n */\nexport function filePathToRoute(filePath: string, projectDir: string): string {\n  // Normalize paths\n  const normalizedFilePath = path.normalize(filePath);\n  const normalizedProjectDir = path.normalize(projectDir);\n\n  // Get relative path from project root\n  const relativePath = path.relative(normalizedProjectDir, normalizedFilePath);\n\n  // Remove file extension\n  let routePath = relativePath.replace(/\\.(ts|tsx|js|jsx)$/, '');\n\n  // Handle App Router (remove 'route' filename)\n  routePath = routePath.replace(/\\/route$/, '');\n  routePath = routePath.replace(/\\\\route$/, ''); // Windows paths\n\n  // Extract the API portion\n  let apiPath = '';\n\n  if (routePath.includes('app/api/') || routePath.includes('app\\\\api\\\\')) {\n    apiPath = routePath.split(/app[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('src/app/api/') || routePath.includes('src\\\\app\\\\api\\\\')) {\n    apiPath = routePath.split(/src[/\\\\]app[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('pages/api/') || routePath.includes('pages\\\\api\\\\')) {\n    apiPath = routePath.split(/pages[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('src/pages/api/') || routePath.includes('src\\\\pages\\\\api\\\\')) {\n    apiPath = routePath.split(/src[/\\\\]pages[/\\\\]api[/\\\\]/)[1] || '';\n  }\n\n  // Convert to route format (normalize path separators)\n  const route = '/api/' + (apiPath ? apiPath.replace(/\\\\/g, '/') : '');\n\n  return route;\n}\n\n/**\n * Cross-reference API calls against routes, return orphans\n */\nexport function findOrphanEndpoints(\n  apiCalls: ApiCall[],\n  apiRoutes: ApiRoute[]\n): { call: ApiCall; searchedLocations: string[] }[] {\n  const orphans: { call: ApiCall; searchedLocations: string[] }[] = [];\n\n  for (const call of apiCalls) {\n    const endpoint = call.endpoint;\n\n    // Skip non-API endpoints (external URLs, relative paths without /api)\n    if (!endpoint.startsWith('/api') && !endpoint.includes('/api/')) {\n      continue;\n    }\n\n    // Skip dynamic endpoints that are just placeholders\n    if (endpoint.includes('{dynamic}')) {\n      continue;\n    }\n\n    // Extract the API path\n    let apiPath = endpoint;\n    if (endpoint.includes('/api/')) {\n      apiPath = '/api/' + endpoint.split('/api/')[1].split('?')[0]; // Remove query params\n    }\n\n    // Try to match against routes\n    const matchedRoute = apiRoutes.find(route => {\n      // Check if methods match\n      const methodMatches = route.method.includes(call.method) ||\n                           route.method.includes('ALL');\n      if (!methodMatches) {\n        return false;\n      }\n      // Check if route pattern matches endpoint\n      return routeMatchesEndpoint(route.route, apiPath);\n    });\n\n    if (!matchedRoute) {\n      // Generate possible file locations\n      const searchedLocations = generatePossibleRouteFiles(apiPath);\n\n      orphans.push({\n        call,\n        searchedLocations\n      });\n    }\n  }\n\n  return orphans;\n}\n\n/**\n * Check if a route pattern matches an endpoint\n * Handles dynamic segments like [id], [slug], etc.\n */\nfunction routeMatchesEndpoint(routePattern: string, endpoint: string): boolean {\n  const routeParts = routePattern.split('/').filter(Boolean);\n  const endpointParts = endpoint.split('/').filter(Boolean);\n\n  if (routeParts.length !== endpointParts.length) {\n    return false;\n  }\n\n  for (let i = 0; i < routeParts.length; i++) {\n    const routePart = routeParts[i];\n    const endpointPart = endpointParts[i];\n\n    // Dynamic segment matches anything\n    if (routePart.startsWith('[') && routePart.endsWith(']')) {\n      continue;\n    }\n\n    // Static segment must match exactly\n    if (routePart !== endpointPart) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Generate possible file locations for an API endpoint\n */\nfunction generatePossibleRouteFiles(apiPath: string): string[] {\n  const pathWithoutApi = apiPath.replace(/^\\/api\\//, '');\n  const locations: string[] = [];\n\n  // Next.js App Router possibilities\n  locations.push(`app/api/${pathWithoutApi}/route.ts`);\n  locations.push(`app/api/${pathWithoutApi}/route.js`);\n  locations.push(`src/app/api/${pathWithoutApi}/route.ts`);\n  locations.push(`src/app/api/${pathWithoutApi}/route.js`);\n\n  // Next.js Pages Router possibilities\n  locations.push(`pages/api/${pathWithoutApi}.ts`);\n  locations.push(`pages/api/${pathWithoutApi}.js`);\n  locations.push(`src/pages/api/${pathWithoutApi}.ts`);\n  locations.push(`src/pages/api/${pathWithoutApi}.js`);\n\n  return locations;\n}\n\n/**\n * Discover routes in Next.js App Router format\n */\nasync function discoverAppRouterRoutes(\n  apiDir: string,\n  projectDir: string\n): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  try {\n    const files = await findRouteFiles(apiDir, 'route');\n\n    for (const file of files) {\n      const content = await fs.readFile(file, 'utf-8');\n      const methods = extractHttpMethods(content);\n      const route = filePathToRoute(file, projectDir);\n      const isDynamic = route.includes('[') && route.includes(']');\n\n      if (methods.length > 0) {\n        routes.push({\n          route,\n          method: methods,\n          sourceFile: file,\n          isDynamic\n        });\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return routes;\n}\n\n/**\n * Discover routes in Next.js Pages Router format\n */\nasync function discoverPagesRouterRoutes(\n  apiDir: string,\n  projectDir: string\n): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  try {\n    const files = await findRouteFiles(apiDir);\n\n    for (const file of files) {\n      const content = await fs.readFile(file, 'utf-8');\n      const methods = extractHttpMethods(content);\n      const route = filePathToRoute(file, projectDir);\n      const isDynamic = route.includes('[') && route.includes(']');\n\n      // Pages Router typically uses default export with req.method check\n      // If we find method checks or it has a default export, include it\n      if (methods.length > 0 || content.includes('export default')) {\n        routes.push({\n          route,\n          method: methods.length > 0 ? methods : ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n          sourceFile: file,\n          isDynamic\n        });\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return routes;\n}\n\n/**\n * Find all route files in a directory recursively\n */\nasync function findRouteFiles(\n  dir: string,\n  filename?: string\n): Promise<string[]> {\n  const files: string[] = [];\n\n  try {\n    const entries = await fs.readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = path.join(dir, entry.name);\n\n      if (entry.isDirectory()) {\n        const subFiles = await findRouteFiles(fullPath, filename);\n        files.push(...subFiles);\n      } else if (entry.isFile()) {\n        const ext = path.extname(entry.name);\n        const baseName = path.basename(entry.name, ext);\n\n        if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n          if (filename) {\n            // Looking for specific filename (e.g., 'route.ts')\n            if (baseName === filename) {\n              files.push(fullPath);\n            }\n          } else {\n            // Include all TypeScript/JavaScript files\n            files.push(fullPath);\n          }\n        }\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return files;\n}\n\n/**\n * Extract HTTP method exports from file content\n */\nfunction extractHttpMethods(content: string): string[] {\n  const methods: string[] = [];\n  const httpMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS'];\n\n  for (const method of httpMethods) {\n    // Look for exported functions: export async function GET\n    const exportPattern = new RegExp(`export\\\\s+(?:async\\\\s+)?function\\\\s+${method}\\\\s*\\\\(`, 'g');\n    if (exportPattern.test(content)) {\n      methods.push(method);\n    }\n  }\n\n  return methods;\n}\n\n/**\n * Check if a directory exists\n */\nasync function directoryExists(dir: string): Promise<boolean> {\n  try {\n    const stat = await fs.stat(dir);\n    return stat.isDirectory();\n  } catch {\n    return false;\n  }\n}\n\n// TODO: Iteration 3 - Add matching between frontend API calls and backend routes (DONE via findOrphanEndpoints)\n// TODO: Iteration 4 - Add OpenAPI/Swagger schema generation from discovered routes\n","import { ConfigSchema, VIEWPORTS, type Config, type Session, type SessionQuery, type ComparisonReport } from './schemas.js';\nimport { captureScreenshot, closeBrowser } from './capture.js';\nimport { compareImages, analyzeComparison } from './compare.js';\nimport {\n  createSession,\n  getSession,\n  updateSession,\n  markSessionCompared,\n  listSessions,\n  getMostRecentSession,\n  deleteSession,\n  cleanSessions,\n  getSessionPaths,\n  findSessions,\n  getTimeline,\n  getSessionsByRoute,\n  getSessionStats,\n} from './session.js';\nimport { generateReport } from './report.js';\nimport type { StartSessionOptions, StartSessionResult, CleanOptions } from './types.js';\n\nexport class InterfaceBuiltRight {\n  private config: Config;\n\n  constructor(options: Partial<Config> = {}) {\n    // Validate and merge with defaults\n    this.config = ConfigSchema.parse(options);\n  }\n\n  /**\n   * Start a visual session by capturing a baseline screenshot\n   */\n  async startSession(path: string, options: StartSessionOptions = {}): Promise<StartSessionResult> {\n    const {\n      name = this.generateSessionName(path),\n      viewport = this.config.viewport,\n      fullPage = this.config.fullPage,\n      selector,\n      waitFor,\n    } = options;\n\n    const url = this.resolveUrl(path);\n\n    // Create session\n    const session = await createSession(this.config.outputDir, url, name, viewport);\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture baseline (outputDir enables auth state loading)\n    await captureScreenshot({\n      url,\n      outputPath: paths.baseline,\n      viewport,\n      fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n      selector,\n      waitFor,\n    });\n\n    return {\n      sessionId: session.id,\n      baseline: paths.baseline,\n      session,\n    };\n  }\n\n  /**\n   * Check current state against baseline\n   */\n  async check(sessionId?: string): Promise<ComparisonReport> {\n    // Get session\n    const session = sessionId\n      ? await getSession(this.config.outputDir, sessionId)\n      : await getMostRecentSession(this.config.outputDir);\n\n    if (!session) {\n      throw new Error(sessionId\n        ? `Session not found: ${sessionId}`\n        : 'No sessions found. Run startSession first.');\n    }\n\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture current screenshot (outputDir enables auth state loading)\n    await captureScreenshot({\n      url: session.url,\n      outputPath: paths.current,\n      viewport: session.viewport,\n      fullPage: this.config.fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n    });\n\n    // Compare images\n    const comparison = await compareImages({\n      baselinePath: paths.baseline,\n      currentPath: paths.current,\n      diffPath: paths.diff,\n      threshold: this.config.threshold / 100, // Convert percentage to 0-1 range for pixelmatch\n    });\n\n    // Analyze results\n    const analysis = analyzeComparison(comparison, this.config.threshold);\n\n    // Update session\n    await markSessionCompared(this.config.outputDir, session.id, comparison, analysis);\n\n    // Generate report\n    return generateReport(session, comparison, analysis, this.config.outputDir);\n  }\n\n  /**\n   * Get a session by ID\n   */\n  async getSession(sessionId: string): Promise<Session | null> {\n    return getSession(this.config.outputDir, sessionId);\n  }\n\n  /**\n   * Get the most recent session\n   */\n  async getMostRecentSession(): Promise<Session | null> {\n    return getMostRecentSession(this.config.outputDir);\n  }\n\n  /**\n   * List all sessions\n   */\n  async listSessions(): Promise<Session[]> {\n    return listSessions(this.config.outputDir);\n  }\n\n  /**\n   * Delete a session\n   */\n  async deleteSession(sessionId: string): Promise<boolean> {\n    return deleteSession(this.config.outputDir, sessionId);\n  }\n\n  /**\n   * Clean old sessions\n   */\n  async clean(options: CleanOptions = {}): Promise<{ deleted: string[]; kept: string[] }> {\n    return cleanSessions(this.config.outputDir, options);\n  }\n\n  /**\n   * Find sessions matching query criteria\n   */\n  async find(query: Partial<SessionQuery> = {}): Promise<Session[]> {\n    return findSessions(this.config.outputDir, query);\n  }\n\n  /**\n   * Get timeline of sessions for a specific route\n   * Returns sessions in chronological order (oldest first)\n   */\n  async getTimeline(route: string, limit: number = 10): Promise<Session[]> {\n    return getTimeline(this.config.outputDir, route, limit);\n  }\n\n  /**\n   * Get sessions grouped by route\n   */\n  async getSessionsByRoute(): Promise<Record<string, Session[]>> {\n    return getSessionsByRoute(this.config.outputDir);\n  }\n\n  /**\n   * Get session statistics\n   */\n  async getStats(): Promise<{\n    total: number;\n    byStatus: Record<string, number>;\n    byViewport: Record<string, number>;\n    byVerdict: Record<string, number>;\n  }> {\n    return getSessionStats(this.config.outputDir);\n  }\n\n  /**\n   * Update baseline with current screenshot\n   */\n  async updateBaseline(sessionId?: string): Promise<Session> {\n    const session = sessionId\n      ? await getSession(this.config.outputDir, sessionId)\n      : await getMostRecentSession(this.config.outputDir);\n\n    if (!session) {\n      throw new Error(sessionId\n        ? `Session not found: ${sessionId}`\n        : 'No sessions found.');\n    }\n\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture new baseline (outputDir enables auth state loading)\n    await captureScreenshot({\n      url: session.url,\n      outputPath: paths.baseline,\n      viewport: session.viewport,\n      fullPage: this.config.fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n    });\n\n    // Reset session status\n    return updateSession(this.config.outputDir, session.id, {\n      status: 'baseline',\n      comparison: undefined,\n      analysis: undefined,\n    });\n  }\n\n  /**\n   * Close the browser instance\n   */\n  async close(): Promise<void> {\n    await closeBrowser();\n  }\n\n  /**\n   * Get configuration\n   */\n  getConfig(): Config {\n    return { ...this.config };\n  }\n\n  /**\n   * Resolve a path to full URL\n   */\n  private resolveUrl(path: string): string {\n    if (path.startsWith('http://') || path.startsWith('https://')) {\n      return path;\n    }\n    return `${this.config.baseUrl}${path.startsWith('/') ? path : `/${path}`}`;\n  }\n\n  /**\n   * Generate a session name from path\n   */\n  private generateSessionName(path: string): string {\n    // Remove leading slash and replace remaining slashes with dashes\n    return path\n      .replace(/^\\/+/, '')\n      .replace(/\\//g, '-')\n      .replace(/[^a-zA-Z0-9-_]/g, '')\n      || 'homepage';\n  }\n}\n\n// Export everything for programmatic use\nexport * from './schemas.js';\nexport * from './types.js';\nexport { captureScreenshot, closeBrowser, getViewport, captureWithDiagnostics } from './capture.js';\nexport type { CaptureResult } from './capture.js';\nexport { checkConsistency, formatConsistencyReport } from './consistency.js';\nexport type { ConsistencyOptions, ConsistencyResult, PageMetrics, Inconsistency } from './consistency.js';\nexport { compareImages, analyzeComparison, getVerdictDescription, detectChangedRegions } from './compare.js';\nexport { discoverPages, getNavigationLinks } from './crawl.js';\nexport type { CrawlOptions, CrawlResult, DiscoveredPage } from './crawl.js';\nexport {\n  createSession,\n  getSession,\n  updateSession,\n  markSessionCompared,\n  listSessions,\n  getMostRecentSession,\n  deleteSession,\n  cleanSessions,\n  getSessionPaths,\n  generateSessionId,\n  findSessions,\n  getTimeline,\n  getSessionsByRoute,\n  getSessionStats,\n} from './session.js';\nexport { generateReport, formatReportText, formatReportJson, formatReportMinimal, formatSessionSummary } from './report.js';\nexport {\n  extractApiCalls,\n  scanDirectoryForApiCalls,\n  discoverApiRoutes,\n  filePathToRoute,\n  findOrphanEndpoints,\n  groupByEndpoint,\n  groupByFile,\n  filterByMethod,\n  filterByEndpoint,\n} from './integration.js';\nexport type { ApiCall, ApiRoute } from './integration.js';\nexport { VIEWPORTS };\n"]}