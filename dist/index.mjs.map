{"version":3,"sources":["../src/performance.ts","../src/interactivity.ts","../src/api-timing.ts","../src/schemas.ts","../src/types.ts","../src/auth.ts","../src/semantic/landmarks.ts","../src/semantic/page-intent.ts","../src/capture.ts","../src/compare.ts","../src/session.ts","../src/report.ts","../src/semantic/state-detector.ts","../src/semantic/output.ts","../src/flows/types.ts","../src/flows/login.ts","../src/flows/search.ts","../src/flows/form.ts","../src/flows/search-validation.ts","../src/flows/index.ts","../src/cleanup.ts","../src/consistency.ts","../src/crawl.ts","../src/integration.ts","../src/operation-tracker.ts","../src/index.ts","../src/responsive.ts","../src/memory.ts"],"names":["resolve","path","patterns","placeholder","chromium","mkdir","readFile","dirname","writeFile","join","selector","access","sessions","browser","URL","page","stat","nanoid","isMobile","unlink","readdir","createApiTracker"],"mappings":"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","file":"index.mjs","sourcesContent":["import type { Page } from 'playwright';\n\n/**\n * Web Vitals metrics\n * @see https://web.dev/vitals/\n */\nexport interface WebVitals {\n  /** Largest Contentful Paint (ms) - loading performance */\n  LCP: number | null;\n  /** First Input Delay (ms) - interactivity (requires user interaction) */\n  FID: number | null;\n  /** Cumulative Layout Shift (score) - visual stability */\n  CLS: number | null;\n  /** Time to First Byte (ms) - server response time */\n  TTFB: number | null;\n  /** First Contentful Paint (ms) - initial render */\n  FCP: number | null;\n  /** Time to Interactive (ms) - when page becomes fully interactive */\n  TTI: number | null;\n}\n\n/**\n * Performance thresholds for each metric\n * Based on Core Web Vitals guidelines\n */\nexport const PERFORMANCE_THRESHOLDS = {\n  LCP: { good: 2500, poor: 4000 },\n  FID: { good: 100, poor: 300 },\n  CLS: { good: 0.1, poor: 0.25 },\n  TTFB: { good: 800, poor: 1800 },\n  FCP: { good: 1800, poor: 3000 },\n  TTI: { good: 3800, poor: 7300 },\n};\n\n/**\n * Performance rating\n */\nexport type PerformanceRating = 'good' | 'needs-improvement' | 'poor';\n\n/**\n * Rated metric with value and rating\n */\nexport interface RatedMetric {\n  value: number | null;\n  rating: PerformanceRating | null;\n}\n\n/**\n * Full performance result with ratings\n */\nexport interface PerformanceResult {\n  metrics: WebVitals;\n  ratings: Record<keyof WebVitals, RatedMetric>;\n  summary: {\n    overallRating: PerformanceRating;\n    passedVitals: number;\n    totalVitals: number;\n    issues: string[];\n    recommendations: string[];\n  };\n}\n\n/**\n * Rate a metric value against thresholds\n */\nfunction rateMetric(\n  value: number | null,\n  thresholds: { good: number; poor: number }\n): PerformanceRating | null {\n  if (value === null) return null;\n  if (value <= thresholds.good) return 'good';\n  if (value <= thresholds.poor) return 'needs-improvement';\n  return 'poor';\n}\n\n/**\n * Measure Core Web Vitals from a page\n *\n * Note: FID requires actual user interaction, so it will be null\n * for automated tests. Use TTI as an alternative measure.\n */\nexport async function measureWebVitals(page: Page): Promise<WebVitals> {\n  const metrics = await page.evaluate(() => {\n    return new Promise<WebVitals>((resolve) => {\n      const result: WebVitals = {\n        LCP: null,\n        FID: null,\n        CLS: null,\n        TTFB: null,\n        FCP: null,\n        TTI: null,\n      };\n\n      // Get navigation timing for TTFB\n      const navEntry = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\n      if (navEntry) {\n        result.TTFB = navEntry.responseStart - navEntry.requestStart;\n      }\n\n      // Get paint timing for FCP\n      const paintEntries = performance.getEntriesByType('paint');\n      const fcpEntry = paintEntries.find(e => e.name === 'first-contentful-paint');\n      if (fcpEntry) {\n        result.FCP = fcpEntry.startTime;\n      }\n\n      // Use PerformanceObserver for LCP and CLS\n      let lcpValue: number | null = null;\n      let clsValue = 0;\n\n      // LCP observer\n      const lcpObserver = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        const lastEntry = entries[entries.length - 1];\n        if (lastEntry) {\n          lcpValue = lastEntry.startTime;\n        }\n      });\n\n      // CLS observer\n      const clsObserver = new PerformanceObserver((list) => {\n        for (const entry of list.getEntries()) {\n          // @ts-ignore - hadRecentInput is a valid property for layout-shift entries\n          if (!entry.hadRecentInput) {\n            // @ts-ignore - value is a valid property for layout-shift entries\n            clsValue += entry.value;\n          }\n        }\n      });\n\n      try {\n        lcpObserver.observe({ type: 'largest-contentful-paint', buffered: true });\n      } catch {\n        // LCP not supported\n      }\n\n      try {\n        clsObserver.observe({ type: 'layout-shift', buffered: true });\n      } catch {\n        // CLS not supported\n      }\n\n      // Wait for metrics to stabilize, then return\n      setTimeout(() => {\n        lcpObserver.disconnect();\n        clsObserver.disconnect();\n\n        result.LCP = lcpValue;\n        result.CLS = clsValue;\n\n        // Estimate TTI from navigation timing\n        if (navEntry) {\n          // TTI approximation: domInteractive + longest task estimate\n          result.TTI = navEntry.domInteractive;\n        }\n\n        resolve(result);\n      }, 3000); // Wait 3s for metrics\n    });\n  });\n\n  return metrics;\n}\n\n/**\n * Measure performance and return rated results\n */\nexport async function measurePerformance(page: Page): Promise<PerformanceResult> {\n  const metrics = await measureWebVitals(page);\n\n  // Rate each metric\n  const ratings: Record<keyof WebVitals, RatedMetric> = {\n    LCP: { value: metrics.LCP, rating: rateMetric(metrics.LCP, PERFORMANCE_THRESHOLDS.LCP) },\n    FID: { value: metrics.FID, rating: rateMetric(metrics.FID, PERFORMANCE_THRESHOLDS.FID) },\n    CLS: { value: metrics.CLS, rating: rateMetric(metrics.CLS, PERFORMANCE_THRESHOLDS.CLS) },\n    TTFB: { value: metrics.TTFB, rating: rateMetric(metrics.TTFB, PERFORMANCE_THRESHOLDS.TTFB) },\n    FCP: { value: metrics.FCP, rating: rateMetric(metrics.FCP, PERFORMANCE_THRESHOLDS.FCP) },\n    TTI: { value: metrics.TTI, rating: rateMetric(metrics.TTI, PERFORMANCE_THRESHOLDS.TTI) },\n  };\n\n  // Generate summary\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n  let passedVitals = 0;\n  let totalVitals = 0;\n\n  // Core Web Vitals: LCP, CLS (FID requires interaction)\n  const coreVitals: (keyof WebVitals)[] = ['LCP', 'CLS', 'TTFB', 'FCP'];\n\n  for (const vital of coreVitals) {\n    const rated = ratings[vital];\n    if (rated.value !== null) {\n      totalVitals++;\n      if (rated.rating === 'good') {\n        passedVitals++;\n      } else if (rated.rating === 'poor') {\n        issues.push(`${vital} is poor (${formatMetric(vital, rated.value)})`);\n        recommendations.push(getRecommendation(vital));\n      } else if (rated.rating === 'needs-improvement') {\n        issues.push(`${vital} needs improvement (${formatMetric(vital, rated.value)})`);\n      }\n    }\n  }\n\n  // Calculate overall rating\n  const poorCount = Object.values(ratings).filter(r => r.rating === 'poor').length;\n  const needsImprovementCount = Object.values(ratings).filter(r => r.rating === 'needs-improvement').length;\n\n  let overallRating: PerformanceRating = 'good';\n  if (poorCount > 0) {\n    overallRating = 'poor';\n  } else if (needsImprovementCount > 0) {\n    overallRating = 'needs-improvement';\n  }\n\n  return {\n    metrics,\n    ratings,\n    summary: {\n      overallRating,\n      passedVitals,\n      totalVitals,\n      issues,\n      recommendations,\n    },\n  };\n}\n\n/**\n * Format a metric value for display\n */\nfunction formatMetric(name: keyof WebVitals, value: number): string {\n  if (name === 'CLS') {\n    return value.toFixed(3);\n  }\n  return `${Math.round(value)}ms`;\n}\n\n/**\n * Get improvement recommendation for a metric\n */\nfunction getRecommendation(metric: keyof WebVitals): string {\n  const recommendations: Record<keyof WebVitals, string> = {\n    LCP: 'Optimize largest image/text block: use lazy loading, preload critical assets, optimize server response',\n    FID: 'Reduce JavaScript execution time: split code, defer non-critical JS, use web workers',\n    CLS: 'Reserve space for dynamic content: set explicit dimensions for images/ads/embeds',\n    TTFB: 'Improve server response: use CDN, optimize database queries, enable caching',\n    FCP: 'Eliminate render-blocking resources: inline critical CSS, defer non-critical JS',\n    TTI: 'Reduce main thread work: minimize/defer JavaScript, reduce DOM size',\n  };\n  return recommendations[metric];\n}\n\n/**\n * Format performance result for console output\n */\nexport function formatPerformanceResult(result: PerformanceResult): string {\n  const lines: string[] = [];\n\n  lines.push('Performance Metrics');\n  lines.push('===================');\n  lines.push('');\n\n  // Overall rating\n  const ratingIcon = result.summary.overallRating === 'good' ? '' :\n                     result.summary.overallRating === 'needs-improvement' ? '~' : '';\n  const ratingColor = result.summary.overallRating === 'good' ? '\\x1b[32m' :\n                      result.summary.overallRating === 'needs-improvement' ? '\\x1b[33m' : '\\x1b[31m';\n  lines.push(`Overall: ${ratingColor}${ratingIcon} ${result.summary.overallRating.toUpperCase()}\\x1b[0m`);\n  lines.push(`Passed: ${result.summary.passedVitals}/${result.summary.totalVitals} core vitals`);\n  lines.push('');\n\n  // Individual metrics\n  lines.push('Core Web Vitals:');\n  const vitals: (keyof WebVitals)[] = ['LCP', 'FCP', 'TTFB', 'CLS'];\n  for (const vital of vitals) {\n    const rated = result.ratings[vital];\n    if (rated.value !== null) {\n      const icon = rated.rating === 'good' ? '' :\n                   rated.rating === 'needs-improvement' ? '~' : '';\n      const color = rated.rating === 'good' ? '\\x1b[32m' :\n                    rated.rating === 'needs-improvement' ? '\\x1b[33m' : '\\x1b[31m';\n      lines.push(`  ${color}${icon}\\x1b[0m ${vital}: ${formatMetric(vital, rated.value)}`);\n    }\n  }\n\n  // Issues\n  if (result.summary.issues.length > 0) {\n    lines.push('');\n    lines.push('Issues:');\n    for (const issue of result.summary.issues) {\n      lines.push(`  ! ${issue}`);\n    }\n  }\n\n  // Recommendations\n  if (result.summary.recommendations.length > 0) {\n    lines.push('');\n    lines.push('Recommendations:');\n    for (const rec of result.summary.recommendations) {\n      lines.push(`  -> ${rec}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n","import type { Page } from 'playwright';\n\n/**\n * Interactive element info\n */\nexport interface InteractiveElement {\n  selector: string;\n  tagName: string;\n  type?: string;\n  text?: string;\n  hasHandler: boolean;\n  isDisabled: boolean;\n  isVisible: boolean;\n  a11y: {\n    role?: string;\n    ariaLabel?: string;\n    tabIndex?: number;\n  };\n}\n\n/**\n * Button analysis result\n */\nexport interface ButtonInfo extends InteractiveElement {\n  buttonType?: 'submit' | 'button' | 'reset';\n  formId?: string;\n}\n\n/**\n * Link analysis result\n */\nexport interface LinkInfo extends InteractiveElement {\n  href: string;\n  isPlaceholder: boolean;\n  opensNewTab: boolean;\n  isExternal: boolean;\n}\n\n/**\n * Form analysis result\n */\nexport interface FormInfo {\n  selector: string;\n  action?: string;\n  method?: string;\n  hasSubmitHandler: boolean;\n  fields: FormFieldInfo[];\n  hasValidation: boolean;\n  submitButton?: ButtonInfo;\n}\n\n/**\n * Form field info\n */\nexport interface FormFieldInfo {\n  selector: string;\n  name?: string;\n  type: string;\n  label?: string;\n  required: boolean;\n  hasValidation: boolean;\n}\n\n/**\n * Interactivity issue\n */\nexport interface InteractivityIssue {\n  type: 'NO_HANDLER' | 'PLACEHOLDER_LINK' | 'MISSING_LABEL' | 'DISABLED_NO_VISUAL' |\n        'SMALL_TOUCH_TARGET' | 'FORM_NO_SUBMIT' | 'ORPHAN_SUBMIT' | 'NO_KEYBOARD_ACCESS';\n  element: string;\n  severity: 'error' | 'warning' | 'info';\n  description: string;\n}\n\n/**\n * Full interactivity test result\n */\nexport interface InteractivityResult {\n  buttons: ButtonInfo[];\n  links: LinkInfo[];\n  forms: FormInfo[];\n  issues: InteractivityIssue[];\n  summary: {\n    totalInteractive: number;\n    withHandlers: number;\n    withoutHandlers: number;\n    issueCount: {\n      error: number;\n      warning: number;\n      info: number;\n    };\n  };\n}\n\n/**\n * Test interactivity of all interactive elements on a page\n */\nexport async function testInteractivity(page: Page): Promise<InteractivityResult> {\n  const data = await page.evaluate(() => {\n    const results: {\n      buttons: ButtonInfo[];\n      links: LinkInfo[];\n      forms: FormInfo[];\n    } = {\n      buttons: [],\n      links: [],\n      forms: [],\n    };\n\n    // Helper to check if element has event handlers\n    function hasEventHandler(el: Element): boolean {\n      // Check for inline handlers\n      const inlineHandlers = ['onclick', 'onmousedown', 'onmouseup', 'ontouchstart', 'ontouchend'];\n      for (const handler of inlineHandlers) {\n        if (el.getAttribute(handler)) return true;\n      }\n\n      // Check for common framework patterns\n      const attrs = Array.from(el.attributes).map(a => a.name);\n      const frameworkPatterns = ['@click', 'v-on:click', 'ng-click', '(click)'];\n      for (const pattern of frameworkPatterns) {\n        if (attrs.some(a => a.includes(pattern) || a.startsWith(pattern))) return true;\n      }\n\n      // Check for data attributes that suggest handlers\n      if (el.getAttribute('data-action') || el.getAttribute('data-onclick')) return true;\n\n      // Can't detect addEventListener from DOM, assume true for semantic elements\n      const tagName = el.tagName.toLowerCase();\n      if (tagName === 'a' && (el as HTMLAnchorElement).href) return true;\n      if (tagName === 'button') return true;\n      if (tagName === 'input' && ['submit', 'button'].includes((el as HTMLInputElement).type)) return true;\n\n      return false;\n    }\n\n    // Helper to get unique selector\n    function getSelector(el: Element): string {\n      if (el.id) return `#${el.id}`;\n      const classes = Array.from(el.classList).slice(0, 2).join('.');\n      const tag = el.tagName.toLowerCase();\n      if (classes) return `${tag}.${classes}`;\n      return tag;\n    }\n\n    // Helper to check visibility\n    function isVisible(el: Element): boolean {\n      const style = window.getComputedStyle(el);\n      const rect = el.getBoundingClientRect();\n      return style.display !== 'none' &&\n             style.visibility !== 'hidden' &&\n             style.opacity !== '0' &&\n             rect.width > 0 &&\n             rect.height > 0;\n    }\n\n    // Analyze buttons\n    const buttons = Array.from(document.querySelectorAll('button, [role=\"button\"], input[type=\"button\"], input[type=\"submit\"]'));\n    for (const btn of buttons) {\n      const el = btn as HTMLButtonElement | HTMLInputElement;\n      results.buttons.push({\n        selector: getSelector(el),\n        tagName: el.tagName.toLowerCase(),\n        type: el.type || undefined,\n        text: el.textContent?.trim() || (el as HTMLInputElement).value || undefined,\n        hasHandler: hasEventHandler(el),\n        isDisabled: el.disabled || el.getAttribute('aria-disabled') === 'true',\n        isVisible: isVisible(el),\n        a11y: {\n          role: el.getAttribute('role') || undefined,\n          ariaLabel: el.getAttribute('aria-label') || undefined,\n          tabIndex: el.tabIndex,\n        },\n        buttonType: (el as HTMLButtonElement).type as 'submit' | 'button' | 'reset' || undefined,\n        formId: el.form?.id || undefined,\n      });\n    }\n\n    // Analyze links\n    const links = Array.from(document.querySelectorAll('a[href]'));\n    for (const link of links) {\n      const el = link as HTMLAnchorElement;\n      const href = el.getAttribute('href') || '';\n      const isPlaceholder = href === '#' || href === '' || href === 'javascript:void(0)';\n\n      results.links.push({\n        selector: getSelector(el),\n        tagName: 'a',\n        text: el.textContent?.trim() || undefined,\n        hasHandler: hasEventHandler(el) || !isPlaceholder,\n        isDisabled: el.getAttribute('aria-disabled') === 'true',\n        isVisible: isVisible(el),\n        a11y: {\n          role: el.getAttribute('role') || undefined,\n          ariaLabel: el.getAttribute('aria-label') || undefined,\n          tabIndex: el.tabIndex,\n        },\n        href,\n        isPlaceholder,\n        opensNewTab: el.target === '_blank',\n        isExternal: el.hostname !== window.location.hostname,\n      });\n    }\n\n    // Analyze forms\n    const forms = Array.from(document.querySelectorAll('form'));\n    for (const form of forms) {\n      const el = form as HTMLFormElement;\n      const fields: FormFieldInfo[] = [];\n\n      // Get form fields\n      const inputs = Array.from(el.querySelectorAll('input, select, textarea'));\n      for (const input of inputs) {\n        const field = input as HTMLInputElement;\n        if (['hidden', 'submit', 'button'].includes(field.type)) continue;\n\n        const labelEl = el.querySelector(`label[for=\"${field.id}\"]`) ||\n                        field.closest('label');\n\n        fields.push({\n          selector: getSelector(field),\n          name: field.name || undefined,\n          type: field.type || field.tagName.toLowerCase(),\n          label: labelEl?.textContent?.trim() || undefined,\n          required: field.required,\n          hasValidation: field.hasAttribute('pattern') ||\n                         field.hasAttribute('min') ||\n                         field.hasAttribute('max') ||\n                         field.hasAttribute('minlength') ||\n                         field.hasAttribute('maxlength'),\n        });\n      }\n\n      // Find submit button\n      const submitBtn = el.querySelector('button[type=\"submit\"], input[type=\"submit\"]');\n      let submitInfo: ButtonInfo | undefined;\n      if (submitBtn) {\n        const btn = submitBtn as HTMLButtonElement;\n        submitInfo = {\n          selector: getSelector(btn),\n          tagName: btn.tagName.toLowerCase(),\n          text: btn.textContent?.trim() || (btn as HTMLInputElement).value || undefined,\n          hasHandler: hasEventHandler(btn),\n          isDisabled: btn.disabled,\n          isVisible: isVisible(btn),\n          a11y: {\n            role: btn.getAttribute('role') || undefined,\n            ariaLabel: btn.getAttribute('aria-label') || undefined,\n          },\n          buttonType: 'submit',\n        };\n      }\n\n      // Check for submit handler on form\n      const hasSubmitHandler = hasEventHandler(el) ||\n                               el.getAttribute('action') !== null ||\n                               submitBtn !== null;\n\n      results.forms.push({\n        selector: getSelector(el),\n        action: el.action || undefined,\n        method: el.method || undefined,\n        hasSubmitHandler,\n        fields,\n        hasValidation: fields.some(f => f.hasValidation || f.required),\n        submitButton: submitInfo,\n      });\n    }\n\n    return results;\n  });\n\n  // Analyze for issues\n  const issues: InteractivityIssue[] = [];\n\n  // Check buttons\n  for (const btn of data.buttons) {\n    if (!btn.hasHandler && !btn.isDisabled) {\n      issues.push({\n        type: 'NO_HANDLER',\n        element: btn.selector,\n        severity: 'warning',\n        description: `Button \"${btn.text || btn.selector}\" has no click handler`,\n      });\n    }\n\n    if (btn.isDisabled && btn.isVisible) {\n      // Check if disabled state is visually indicated\n      // This is a heuristic - we can't fully check CSS from here\n    }\n\n    if (!btn.a11y.ariaLabel && !btn.text) {\n      issues.push({\n        type: 'MISSING_LABEL',\n        element: btn.selector,\n        severity: 'error',\n        description: `Button has no accessible label (no text or aria-label)`,\n      });\n    }\n  }\n\n  // Check links\n  for (const link of data.links) {\n    if (link.isPlaceholder && !link.hasHandler) {\n      issues.push({\n        type: 'PLACEHOLDER_LINK',\n        element: link.selector,\n        severity: 'error',\n        description: `Link \"${link.text || link.selector}\" has placeholder href without handler`,\n      });\n    }\n\n    if (!link.a11y.ariaLabel && !link.text) {\n      issues.push({\n        type: 'MISSING_LABEL',\n        element: link.selector,\n        severity: 'error',\n        description: `Link has no accessible label (no text or aria-label)`,\n      });\n    }\n  }\n\n  // Check forms\n  for (const form of data.forms) {\n    if (!form.hasSubmitHandler) {\n      issues.push({\n        type: 'FORM_NO_SUBMIT',\n        element: form.selector,\n        severity: 'warning',\n        description: `Form has no submit handler or action`,\n      });\n    }\n\n    // Check for labels on fields\n    for (const field of form.fields) {\n      if (!field.label && field.type !== 'hidden') {\n        issues.push({\n          type: 'MISSING_LABEL',\n          element: field.selector,\n          severity: 'warning',\n          description: `Form field \"${field.name || field.selector}\" has no label`,\n        });\n      }\n    }\n  }\n\n  // Calculate summary\n  const allInteractive = [...data.buttons, ...data.links];\n  const withHandlers = allInteractive.filter(e => e.hasHandler).length;\n\n  return {\n    buttons: data.buttons,\n    links: data.links,\n    forms: data.forms,\n    issues,\n    summary: {\n      totalInteractive: allInteractive.length,\n      withHandlers,\n      withoutHandlers: allInteractive.length - withHandlers,\n      issueCount: {\n        error: issues.filter(i => i.severity === 'error').length,\n        warning: issues.filter(i => i.severity === 'warning').length,\n        info: issues.filter(i => i.severity === 'info').length,\n      },\n    },\n  };\n}\n\n/**\n * Format interactivity result for console output\n */\nexport function formatInteractivityResult(result: InteractivityResult): string {\n  const lines: string[] = [];\n\n  lines.push('Interactivity Analysis');\n  lines.push('======================');\n  lines.push('');\n\n  // Summary\n  lines.push(`Total interactive elements: ${result.summary.totalInteractive}`);\n  lines.push(`  With handlers: ${result.summary.withHandlers}`);\n  lines.push(`  Without handlers: ${result.summary.withoutHandlers}`);\n  lines.push('');\n\n  // Breakdown\n  lines.push(`Buttons: ${result.buttons.length}`);\n  lines.push(`Links: ${result.links.length}`);\n  lines.push(`Forms: ${result.forms.length}`);\n  lines.push('');\n\n  // Forms detail\n  if (result.forms.length > 0) {\n    lines.push('Forms:');\n    for (const form of result.forms) {\n      const icon = form.hasSubmitHandler ? '' : '!';\n      lines.push(`  ${icon} ${form.selector} (${form.fields.length} fields)`);\n    }\n    lines.push('');\n  }\n\n  // Issues\n  if (result.issues.length > 0) {\n    lines.push('Issues:');\n    for (const issue of result.issues) {\n      const icon = issue.severity === 'error' ? '\\x1b[31m\\x1b[0m' :\n                   issue.severity === 'warning' ? '\\x1b[33m!\\x1b[0m' : 'i';\n      lines.push(`  ${icon} [${issue.type}] ${issue.description}`);\n    }\n  } else {\n    lines.push('No issues detected.');\n  }\n\n  return lines.join('\\n');\n}\n","import type { Page, Request, Response } from 'playwright';\n\n/**\n * API request timing info\n */\nexport interface ApiRequestTiming {\n  url: string;\n  method: string;\n  duration: number;\n  status: number;\n  size: number;\n  resourceType: string;\n  timing: {\n    dnsLookup?: number;\n    tcpConnect?: number;\n    tlsHandshake?: number;\n    requestSent?: number;\n    waiting?: number;\n    contentDownload?: number;\n  };\n}\n\n/**\n * API timing measurement result\n */\nexport interface ApiTimingResult {\n  requests: ApiRequestTiming[];\n  summary: {\n    totalRequests: number;\n    totalTime: number;\n    totalSize: number;\n    averageTime: number;\n    slowestRequest: { url: string; duration: number } | null;\n    fastestRequest: { url: string; duration: number } | null;\n    failedRequests: number;\n    byStatus: Record<number, number>;\n  };\n}\n\n/**\n * Options for API timing measurement\n */\nexport interface ApiTimingOptions {\n  /** Filter to only track URLs matching this pattern */\n  filter?: RegExp;\n  /** Include static resources (images, fonts, etc.) */\n  includeStatic?: boolean;\n  /** Timeout to wait for requests to complete (ms) */\n  timeout?: number;\n  /** Minimum duration to report (ms) - filters out fast requests */\n  minDuration?: number;\n}\n\n/**\n * Measure API/network request timing on a page\n *\n * Call this before navigating to the page, then call stopMeasuring after navigation\n */\nexport async function measureApiTiming(\n  page: Page,\n  options: ApiTimingOptions = {}\n): Promise<ApiTimingResult> {\n  const {\n    filter,\n    includeStatic = false,\n    timeout = 10000,\n    minDuration = 0,\n  } = options;\n\n  const requests: Map<Request, { startTime: number }> = new Map();\n  const completedRequests: ApiRequestTiming[] = [];\n\n  // Track request start times\n  const requestHandler = (request: Request) => {\n    const url = request.url();\n    const resourceType = request.resourceType();\n\n    // Skip static resources unless requested\n    if (!includeStatic && ['image', 'font', 'stylesheet', 'media'].includes(resourceType)) {\n      return;\n    }\n\n    // Apply filter\n    if (filter && !filter.test(url)) {\n      return;\n    }\n\n    requests.set(request, { startTime: Date.now() });\n  };\n\n  // Track response completion\n  const responseHandler = async (response: Response) => {\n    const request = response.request();\n    const requestData = requests.get(request);\n\n    if (!requestData) return;\n\n    const duration = Date.now() - requestData.startTime;\n\n    // Skip if below minimum duration\n    if (duration < minDuration) {\n      requests.delete(request);\n      return;\n    }\n\n    try {\n      // Get response size\n      const body = await response.body().catch(() => Buffer.alloc(0));\n      const size = body.length;\n\n      // Get timing info if available\n      let timing: ReturnType<typeof request.timing> | Record<string, never> = {};\n      try {\n        timing = response.request().timing();\n      } catch {\n        // Timing not available\n      }\n\n      completedRequests.push({\n        url: request.url(),\n        method: request.method(),\n        duration,\n        status: response.status(),\n        size,\n        resourceType: request.resourceType(),\n        timing: {\n          dnsLookup: timing.domainLookupEnd !== undefined && timing.domainLookupStart !== undefined\n            ? timing.domainLookupEnd - timing.domainLookupStart\n            : undefined,\n          tcpConnect: timing.connectEnd !== undefined && timing.connectStart !== undefined\n            ? timing.connectEnd - timing.connectStart\n            : undefined,\n          requestSent: timing.requestStart !== undefined && timing.connectEnd !== undefined\n            ? timing.requestStart - timing.connectEnd\n            : undefined,\n          waiting: timing.responseStart !== undefined && timing.requestStart !== undefined\n            ? timing.responseStart - timing.requestStart\n            : undefined,\n          contentDownload: timing.responseEnd !== undefined && timing.responseStart !== undefined\n            ? timing.responseEnd - timing.responseStart\n            : undefined,\n        },\n      });\n    } catch {\n      // Ignore errors in timing collection\n    }\n\n    requests.delete(request);\n  };\n\n  // Track failed requests\n  const requestFailedHandler = (request: Request) => {\n    const requestData = requests.get(request);\n    if (!requestData) return;\n\n    const duration = Date.now() - requestData.startTime;\n\n    completedRequests.push({\n      url: request.url(),\n      method: request.method(),\n      duration,\n      status: 0, // 0 indicates failure\n      size: 0,\n      resourceType: request.resourceType(),\n      timing: {},\n    });\n\n    requests.delete(request);\n  };\n\n  // Attach listeners\n  page.on('request', requestHandler);\n  page.on('response', responseHandler);\n  page.on('requestfailed', requestFailedHandler);\n\n  // Wait for pending requests to complete\n  await new Promise<void>((resolve) => {\n    const startWait = Date.now();\n\n    const check = () => {\n      // All tracked requests completed or timeout\n      if (requests.size === 0 || Date.now() - startWait > timeout) {\n        resolve();\n        return;\n      }\n      setTimeout(check, 100);\n    };\n\n    // Wait for initial load, then check periodically\n    setTimeout(check, 1000);\n  });\n\n  // Clean up listeners\n  page.off('request', requestHandler);\n  page.off('response', responseHandler);\n  page.off('requestfailed', requestFailedHandler);\n\n  // Calculate summary\n  const totalRequests = completedRequests.length;\n  const totalTime = completedRequests.reduce((sum, r) => sum + r.duration, 0);\n  const totalSize = completedRequests.reduce((sum, r) => sum + r.size, 0);\n  const failedRequests = completedRequests.filter(r => r.status === 0 || r.status >= 400).length;\n\n  // Find slowest/fastest\n  let slowestRequest: { url: string; duration: number } | null = null;\n  let fastestRequest: { url: string; duration: number } | null = null;\n\n  if (completedRequests.length > 0) {\n    const sorted = [...completedRequests].sort((a, b) => b.duration - a.duration);\n    slowestRequest = { url: sorted[0].url, duration: sorted[0].duration };\n    fastestRequest = { url: sorted[sorted.length - 1].url, duration: sorted[sorted.length - 1].duration };\n  }\n\n  // Count by status\n  const byStatus: Record<number, number> = {};\n  for (const req of completedRequests) {\n    byStatus[req.status] = (byStatus[req.status] || 0) + 1;\n  }\n\n  return {\n    requests: completedRequests.sort((a, b) => b.duration - a.duration),\n    summary: {\n      totalRequests,\n      totalTime,\n      totalSize,\n      averageTime: totalRequests > 0 ? Math.round(totalTime / totalRequests) : 0,\n      slowestRequest,\n      fastestRequest,\n      failedRequests,\n      byStatus,\n    },\n  };\n}\n\n/**\n * Create an API timing tracker that records during page interactions\n */\nexport function createApiTracker(page: Page, options: ApiTimingOptions = {}) {\n  const {\n    filter,\n    includeStatic = false,\n    minDuration = 0,\n  } = options;\n\n  const requests: Map<Request, { startTime: number }> = new Map();\n  const completedRequests: ApiRequestTiming[] = [];\n  let isTracking = false;\n\n  const requestHandler = (request: Request) => {\n    if (!isTracking) return;\n\n    const url = request.url();\n    const resourceType = request.resourceType();\n\n    if (!includeStatic && ['image', 'font', 'stylesheet', 'media'].includes(resourceType)) {\n      return;\n    }\n\n    if (filter && !filter.test(url)) {\n      return;\n    }\n\n    requests.set(request, { startTime: Date.now() });\n  };\n\n  const responseHandler = async (response: Response) => {\n    const request = response.request();\n    const requestData = requests.get(request);\n\n    if (!requestData) return;\n\n    const duration = Date.now() - requestData.startTime;\n\n    if (duration < minDuration) {\n      requests.delete(request);\n      return;\n    }\n\n    try {\n      const body = await response.body().catch(() => Buffer.alloc(0));\n\n      completedRequests.push({\n        url: request.url(),\n        method: request.method(),\n        duration,\n        status: response.status(),\n        size: body.length,\n        resourceType: request.resourceType(),\n        timing: {},\n      });\n    } catch {\n      // Ignore\n    }\n\n    requests.delete(request);\n  };\n\n  const requestFailedHandler = (request: Request) => {\n    const requestData = requests.get(request);\n    if (!requestData) return;\n\n    completedRequests.push({\n      url: request.url(),\n      method: request.method(),\n      duration: Date.now() - requestData.startTime,\n      status: 0,\n      size: 0,\n      resourceType: request.resourceType(),\n      timing: {},\n    });\n\n    requests.delete(request);\n  };\n\n  return {\n    start() {\n      isTracking = true;\n      page.on('request', requestHandler);\n      page.on('response', responseHandler);\n      page.on('requestfailed', requestFailedHandler);\n    },\n\n    stop(): ApiTimingResult {\n      isTracking = false;\n      page.off('request', requestHandler);\n      page.off('response', responseHandler);\n      page.off('requestfailed', requestFailedHandler);\n\n      const totalRequests = completedRequests.length;\n      const totalTime = completedRequests.reduce((sum, r) => sum + r.duration, 0);\n      const totalSize = completedRequests.reduce((sum, r) => sum + r.size, 0);\n      const failedRequests = completedRequests.filter(r => r.status === 0 || r.status >= 400).length;\n\n      let slowestRequest: { url: string; duration: number } | null = null;\n      let fastestRequest: { url: string; duration: number } | null = null;\n\n      if (completedRequests.length > 0) {\n        const sorted = [...completedRequests].sort((a, b) => b.duration - a.duration);\n        slowestRequest = { url: sorted[0].url, duration: sorted[0].duration };\n        fastestRequest = { url: sorted[sorted.length - 1].url, duration: sorted[sorted.length - 1].duration };\n      }\n\n      const byStatus: Record<number, number> = {};\n      for (const req of completedRequests) {\n        byStatus[req.status] = (byStatus[req.status] || 0) + 1;\n      }\n\n      return {\n        requests: completedRequests.sort((a, b) => b.duration - a.duration),\n        summary: {\n          totalRequests,\n          totalTime,\n          totalSize,\n          averageTime: totalRequests > 0 ? Math.round(totalTime / totalRequests) : 0,\n          slowestRequest,\n          fastestRequest,\n          failedRequests,\n          byStatus,\n        },\n      };\n    },\n\n    getRequests(): ApiRequestTiming[] {\n      return [...completedRequests];\n    },\n  };\n}\n\n/**\n * Format API timing result for console output\n */\nexport function formatApiTimingResult(result: ApiTimingResult): string {\n  const lines: string[] = [];\n\n  lines.push('API Timing Analysis');\n  lines.push('===================');\n  lines.push('');\n\n  // Summary\n  lines.push('Summary:');\n  lines.push(`  Total requests: ${result.summary.totalRequests}`);\n  lines.push(`  Total time: ${result.summary.totalTime}ms`);\n  lines.push(`  Total size: ${formatBytes(result.summary.totalSize)}`);\n  lines.push(`  Average time: ${result.summary.averageTime}ms`);\n  lines.push(`  Failed requests: ${result.summary.failedRequests}`);\n  lines.push('');\n\n  // Slowest/fastest\n  if (result.summary.slowestRequest) {\n    lines.push(`Slowest: ${result.summary.slowestRequest.duration}ms`);\n    lines.push(`  ${truncateUrl(result.summary.slowestRequest.url)}`);\n  }\n  if (result.summary.fastestRequest && result.requests.length > 1) {\n    lines.push(`Fastest: ${result.summary.fastestRequest.duration}ms`);\n    lines.push(`  ${truncateUrl(result.summary.fastestRequest.url)}`);\n  }\n  lines.push('');\n\n  // Top 10 slowest requests\n  if (result.requests.length > 0) {\n    lines.push('Slowest requests:');\n    const top10 = result.requests.slice(0, 10);\n    for (const req of top10) {\n      const statusIcon = req.status === 0 ? '\\x1b[31m\\x1b[0m' :\n                         req.status >= 400 ? '\\x1b[31m!\\x1b[0m' : '\\x1b[32m\\x1b[0m';\n      lines.push(`  ${statusIcon} ${req.duration}ms ${req.method} ${truncateUrl(req.url)}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format bytes to human readable string\n */\nfunction formatBytes(bytes: number): string {\n  if (bytes < 1024) return `${bytes}B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)}KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)}MB`;\n}\n\n/**\n * Truncate URL for display\n */\nfunction truncateUrl(url: string, maxLength = 60): string {\n  try {\n    const parsed = new URL(url);\n    const path = parsed.pathname + parsed.search;\n    if (path.length > maxLength) {\n      return path.substring(0, maxLength - 3) + '...';\n    }\n    return path;\n  } catch {\n    if (url.length > maxLength) {\n      return url.substring(0, maxLength - 3) + '...';\n    }\n    return url;\n  }\n}\n","import { z } from 'zod';\n\n/**\n * Viewport configuration for screenshot capture\n * Supports predefined names or custom dimensions\n */\nexport const ViewportSchema = z.object({\n  name: z.string().min(1).max(50),\n  width: z.number().min(320).max(3840),\n  height: z.number().min(480).max(2160),\n});\n\n/**\n * Predefined viewport configurations\n */\nexport const VIEWPORTS = {\n  desktop: { name: 'desktop', width: 1920, height: 1080 },\n  'desktop-lg': { name: 'desktop-lg', width: 2560, height: 1440 },\n  'desktop-sm': { name: 'desktop-sm', width: 1440, height: 900 },\n  laptop: { name: 'laptop', width: 1366, height: 768 },\n  tablet: { name: 'tablet', width: 768, height: 1024 },\n  'tablet-landscape': { name: 'tablet-landscape', width: 1024, height: 768 },\n  mobile: { name: 'mobile', width: 375, height: 667 },\n  'mobile-lg': { name: 'mobile-lg', width: 414, height: 896 },\n  'iphone-14': { name: 'iphone-14', width: 390, height: 844 },\n  'iphone-14-pro-max': { name: 'iphone-14-pro-max', width: 430, height: 932 },\n} as const;\n\n/**\n * Main configuration for InterfaceBuiltRight\n */\nexport const ConfigSchema = z.object({\n  baseUrl: z.string().url('Must be a valid URL'),\n  outputDir: z.string().default('./.ibr'),\n  viewport: ViewportSchema.default(VIEWPORTS.desktop),\n  viewports: z.array(ViewportSchema).optional(), // Multi-viewport support\n  threshold: z.number().min(0).max(100).default(1.0),\n  fullPage: z.boolean().default(true),\n  waitForNetworkIdle: z.boolean().default(true),\n  timeout: z.number().min(1000).max(120000).default(30000),\n});\n\n/**\n * Session query options\n */\nexport const SessionQuerySchema = z.object({\n  route: z.string().optional(),\n  url: z.string().optional(),\n  status: z.enum(['baseline', 'compared', 'pending']).optional(),\n  name: z.string().optional(),\n  createdAfter: z.date().optional(),\n  createdBefore: z.date().optional(),\n  viewport: z.string().optional(),\n  limit: z.number().min(1).max(100).default(50),\n});\n\n/**\n * Comparison result from pixelmatch\n */\nexport const ComparisonResultSchema = z.object({\n  match: z.boolean(),\n  diffPercent: z.number(),\n  diffPixels: z.number(),\n  totalPixels: z.number(),\n  threshold: z.number(),\n});\n\n/**\n * Changed region detected in comparison\n */\nexport const ChangedRegionSchema = z.object({\n  location: z.enum(['top', 'bottom', 'left', 'right', 'center', 'full']),\n  bounds: z.object({\n    x: z.number(),\n    y: z.number(),\n    width: z.number(),\n    height: z.number(),\n  }),\n  description: z.string(),\n  severity: z.enum(['expected', 'unexpected', 'critical']),\n});\n\n/**\n * Analysis verdict types\n */\nexport const VerdictSchema = z.enum([\n  'MATCH',\n  'EXPECTED_CHANGE',\n  'UNEXPECTED_CHANGE',\n  'LAYOUT_BROKEN',\n]);\n\n/**\n * Analysis result\n */\nexport const AnalysisSchema = z.object({\n  verdict: VerdictSchema,\n  summary: z.string(),\n  changedRegions: z.array(ChangedRegionSchema),\n  unexpectedChanges: z.array(ChangedRegionSchema),\n  recommendation: z.string().nullable(),\n});\n\n/**\n * Session status\n */\nexport const SessionStatusSchema = z.enum(['baseline', 'compared', 'pending']);\n\n/**\n * Element bounds (moved up for LandmarkElementSchema dependency)\n */\nexport const BoundsSchema = z.object({\n  x: z.number(),\n  y: z.number(),\n  width: z.number(),\n  height: z.number(),\n});\n\n/**\n * Landmark element detected on page\n */\nexport const LandmarkElementSchema = z.object({\n  name: z.string(),           // e.g., 'logo', 'header', 'nav'\n  selector: z.string(),       // CSS selector used to find it\n  found: z.boolean(),\n  bounds: BoundsSchema.optional(),\n});\n\n/**\n * Visual session\n */\nexport const SessionSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  url: z.string().url(),\n  viewport: ViewportSchema,\n  status: SessionStatusSchema,\n  createdAt: z.string().datetime(),\n  updatedAt: z.string().datetime(),\n  comparison: ComparisonResultSchema.optional(),\n  analysis: AnalysisSchema.optional(),\n  // Landmark elements detected at baseline capture\n  landmarkElements: z.array(LandmarkElementSchema).optional(),\n  // Page intent detected at baseline\n  pageIntent: z.string().optional(),\n});\n\n/**\n * Full comparison report\n */\nexport const ComparisonReportSchema = z.object({\n  sessionId: z.string(),\n  sessionName: z.string(),\n  url: z.string(),\n  timestamp: z.string().datetime(),\n  viewport: ViewportSchema,\n  comparison: ComparisonResultSchema,\n  analysis: AnalysisSchema,\n  files: z.object({\n    baseline: z.string(),\n    current: z.string(),\n    diff: z.string(),\n  }),\n  webViewUrl: z.string().optional(),\n});\n\n/**\n * Element interactivity detection\n */\nexport const InteractiveStateSchema = z.object({\n  hasOnClick: z.boolean(),\n  hasHref: z.boolean(),\n  isDisabled: z.boolean(),\n  tabIndex: z.number(),\n  cursor: z.string(),\n  // Framework-specific detection\n  hasReactHandler: z.boolean().optional(),\n  hasVueHandler: z.boolean().optional(),\n  hasAngularHandler: z.boolean().optional(),\n});\n\n/**\n * Accessibility attributes\n */\nexport const A11yAttributesSchema = z.object({\n  role: z.string().nullable(),\n  ariaLabel: z.string().nullable(),\n  ariaDescribedBy: z.string().nullable(),\n  ariaHidden: z.boolean().optional(),\n});\n\n/**\n * Enhanced element with interactivity and accessibility\n */\nexport const EnhancedElementSchema = z.object({\n  // Identity\n  selector: z.string(),\n  tagName: z.string(),\n  id: z.string().optional(),\n  className: z.string().optional(),\n  text: z.string().optional(),\n\n  // Position\n  bounds: BoundsSchema,\n\n  // Styles (subset)\n  computedStyles: z.record(z.string(), z.string()).optional(),\n\n  // Interactivity\n  interactive: InteractiveStateSchema,\n\n  // Accessibility\n  a11y: A11yAttributesSchema,\n\n  // Source hints for debugging\n  sourceHint: z.object({\n    dataTestId: z.string().nullable(),\n  }).optional(),\n});\n\n/**\n * Element issue detected during audit\n */\nexport const ElementIssueSchema = z.object({\n  type: z.enum([\n    'NO_HANDLER',           // Interactive-looking but no handler\n    'PLACEHOLDER_LINK',     // href=\"#\" without handler\n    'TOUCH_TARGET_SMALL',   // < 44px on mobile\n    'MISSING_ARIA_LABEL',   // Interactive without label\n    'DISABLED_NO_VISUAL',   // Disabled but no visual indication\n  ]),\n  severity: z.enum(['error', 'warning', 'info']),\n  message: z.string(),\n});\n\n/**\n * Audit result for a captured page\n */\nexport const AuditResultSchema = z.object({\n  totalElements: z.number(),\n  interactiveCount: z.number(),\n  withHandlers: z.number(),\n  withoutHandlers: z.number(),\n  issues: z.array(ElementIssueSchema),\n});\n\n// Type exports - auto-generated from schemas\nexport type Viewport = z.infer<typeof ViewportSchema>;\nexport type Config = z.infer<typeof ConfigSchema>;\nexport type SessionQuery = z.infer<typeof SessionQuerySchema>;\nexport type ComparisonResult = z.infer<typeof ComparisonResultSchema>;\nexport type ChangedRegion = z.infer<typeof ChangedRegionSchema>;\nexport type Verdict = z.infer<typeof VerdictSchema>;\nexport type Analysis = z.infer<typeof AnalysisSchema>;\nexport type SessionStatus = z.infer<typeof SessionStatusSchema>;\nexport type LandmarkElement = z.infer<typeof LandmarkElementSchema>;\nexport type Session = z.infer<typeof SessionSchema>;\nexport type ComparisonReport = z.infer<typeof ComparisonReportSchema>;\nexport type InteractiveState = z.infer<typeof InteractiveStateSchema>;\nexport type A11yAttributes = z.infer<typeof A11yAttributesSchema>;\nexport type Bounds = z.infer<typeof BoundsSchema>;\nexport type EnhancedElement = z.infer<typeof EnhancedElementSchema>;\nexport type ElementIssue = z.infer<typeof ElementIssueSchema>;\nexport type AuditResult = z.infer<typeof AuditResultSchema>;\n\n/**\n * Rule severity levels\n */\nexport const RuleSeveritySchema = z.enum(['off', 'warn', 'error']);\n\n/**\n * Individual rule setting\n */\nexport const RuleSettingSchema = z.union([\n  RuleSeveritySchema,\n  z.tuple([RuleSeveritySchema, z.record(z.string(), z.unknown())]),\n]);\n\n/**\n * Rules configuration (user's .ibr/rules.json)\n */\nexport const RulesConfigSchema = z.object({\n  extends: z.array(z.string()).optional(),\n  rules: z.record(z.string(), RuleSettingSchema).optional(),\n});\n\n/**\n * Violation detected by a rule\n */\nexport const ViolationSchema = z.object({\n  ruleId: z.string(),\n  ruleName: z.string(),\n  severity: z.enum(['warn', 'error']),\n  message: z.string(),\n  element: z.string().optional(),  // Selector of violating element\n  bounds: BoundsSchema.optional(),\n  fix: z.string().optional(),       // Suggested fix\n});\n\n/**\n * Full audit report with rule violations\n */\nexport const RuleAuditResultSchema = z.object({\n  url: z.string(),\n  timestamp: z.string(),\n  elementsScanned: z.number(),\n  violations: z.array(ViolationSchema),\n  summary: z.object({\n    errors: z.number(),\n    warnings: z.number(),\n    passed: z.number(),\n  }),\n});\n\n// Rule-related type exports\nexport type RuleSeverity = z.infer<typeof RuleSeveritySchema>;\nexport type RuleSetting = z.infer<typeof RuleSettingSchema>;\nexport type RulesConfig = z.infer<typeof RulesConfigSchema>;\nexport type Violation = z.infer<typeof ViolationSchema>;\nexport type RuleAuditResult = z.infer<typeof RuleAuditResultSchema>;\n\n// ============================================================================\n// MEMORY SYSTEM SCHEMAS\n// ============================================================================\n\n/**\n * Source of a UI/UX preference\n */\nexport const MemorySourceSchema = z.enum(['user', 'learned', 'framework']);\n\n/**\n * Preference categories\n */\nexport const PreferenceCategorySchema = z.enum([\n  'color',\n  'layout',\n  'typography',\n  'navigation',\n  'component',\n  'spacing',\n  'interaction',\n  'content',\n]);\n\n/**\n * Expectation operator for comparing values\n */\nexport const ExpectationOperatorSchema = z.enum(['equals', 'contains', 'matches', 'gte', 'lte']);\n\n/**\n * A single UI/UX expectation\n */\nexport const ExpectationSchema = z.object({\n  property: z.string(),\n  operator: ExpectationOperatorSchema,\n  value: z.string(),\n});\n\n/**\n * Full preference with history\n */\nexport const PreferenceSchema = z.object({\n  id: z.string(),\n  description: z.string(),\n  category: PreferenceCategorySchema,\n  source: MemorySourceSchema,\n  route: z.string().optional(),\n  componentType: z.string().optional(),\n  expectation: ExpectationSchema,\n  confidence: z.number().min(0).max(1).default(1.0),\n  createdAt: z.string().datetime(),\n  updatedAt: z.string().datetime(),\n  sessionIds: z.array(z.string()).optional(),\n});\n\n/**\n * Observation extracted from a session\n */\nexport const ObservationSchema = z.object({\n  description: z.string(),\n  category: PreferenceCategorySchema,\n  property: z.string(),\n  value: z.string(),\n});\n\n/**\n * Learned expectation from an approved session\n */\nexport const LearnedExpectationSchema = z.object({\n  id: z.string(),\n  sessionId: z.string(),\n  route: z.string(),\n  observations: z.array(ObservationSchema),\n  approved: z.boolean(),\n  createdAt: z.string().datetime(),\n});\n\n/**\n * Compact preference pointer for summary\n */\nexport const ActivePreferenceSchema = z.object({\n  id: z.string(),\n  description: z.string(),\n  category: PreferenceCategorySchema,\n  route: z.string().optional(),\n  componentType: z.string().optional(),\n  property: z.string(),\n  operator: ExpectationOperatorSchema,\n  value: z.string(),\n  confidence: z.number(),\n});\n\n/**\n * Memory summary - always-loaded compact file\n */\nexport const MemorySummarySchema = z.object({\n  version: z.literal(1),\n  updatedAt: z.string().datetime(),\n  stats: z.object({\n    totalPreferences: z.number(),\n    totalLearned: z.number(),\n    byCategory: z.record(z.string(), z.number()),\n    bySource: z.record(z.string(), z.number()),\n  }),\n  activePreferences: z.array(ActivePreferenceSchema),\n});\n\n// Memory type exports\nexport type MemorySource = z.infer<typeof MemorySourceSchema>;\nexport type PreferenceCategory = z.infer<typeof PreferenceCategorySchema>;\nexport type ExpectationOperator = z.infer<typeof ExpectationOperatorSchema>;\nexport type Expectation = z.infer<typeof ExpectationSchema>;\nexport type Preference = z.infer<typeof PreferenceSchema>;\nexport type Observation = z.infer<typeof ObservationSchema>;\nexport type LearnedExpectation = z.infer<typeof LearnedExpectationSchema>;\nexport type ActivePreference = z.infer<typeof ActivePreferenceSchema>;\nexport type MemorySummary = z.infer<typeof MemorySummarySchema>;\n","import type {\n  Config,\n  Session,\n  ComparisonResult,\n  ComparisonReport,\n  Viewport,\n  Analysis,\n} from './schemas.js';\n\n/**\n * Options for starting a visual session\n */\nexport interface StartSessionOptions {\n  name?: string;\n  viewport?: Viewport;\n  fullPage?: boolean;\n  /** CSS selector to capture specific element instead of full page */\n  selector?: string;\n  /** CSS selector to wait for before capturing screenshot */\n  waitFor?: string;\n}\n\n/**\n * Result from starting a session\n */\nexport interface StartSessionResult {\n  sessionId: string;\n  baseline: string;\n  session: Session;\n}\n\n/**\n * Options for masking dynamic content during capture\n */\nexport interface MaskOptions {\n  /** CSS selectors of elements to hide (set visibility: hidden) */\n  selectors?: string[];\n  /** Text patterns to mask (replaced with placeholder) */\n  textPatterns?: Array<string | RegExp>;\n  /** Hide common dynamic elements automatically (timestamps, spinners, etc.) */\n  hideDynamicContent?: boolean;\n  /** Disable all animations and transitions (default: true) */\n  hideAnimations?: boolean;\n  /** Replace masked text with this placeholder (default: '') */\n  placeholder?: string;\n}\n\n/**\n * Default selectors for common dynamic content\n */\nexport const DEFAULT_DYNAMIC_SELECTORS = [\n  // Timestamps and dates\n  '[data-testid*=\"timestamp\"]',\n  '[data-testid*=\"date\"]',\n  '[data-testid*=\"time\"]',\n  '[class*=\"timestamp\"]',\n  '[class*=\"relative-time\"]',\n  '[class*=\"timeago\"]',\n  'time[datetime]',\n  // Loading indicators\n  '[class*=\"loading\"]',\n  '[class*=\"spinner\"]',\n  '[class*=\"skeleton\"]',\n  '[class*=\"shimmer\"]',\n  '[role=\"progressbar\"]',\n  // Live counters\n  '[class*=\"live-count\"]',\n  '[class*=\"viewer-count\"]',\n  '[class*=\"online-count\"]',\n  // Avatars with random colors\n  '[class*=\"avatar\"][style*=\"background\"]',\n  // Random IDs displayed\n  '[data-testid*=\"session-id\"]',\n  '[class*=\"request-id\"]',\n];\n\n/**\n * Options for capturing a screenshot\n */\nexport interface CaptureOptions {\n  url: string;\n  outputPath: string;\n  viewport?: Viewport;\n  fullPage?: boolean;\n  waitForNetworkIdle?: boolean;\n  timeout?: number;\n  /** CSS selector to capture specific element instead of full page */\n  selector?: string;\n  /** CSS selector to wait for before capturing screenshot */\n  waitFor?: string;\n  /** Options for masking dynamic content */\n  mask?: MaskOptions;\n}\n\n/**\n * Options for comparing images\n */\nexport interface CompareOptions {\n  baselinePath: string;\n  currentPath: string;\n  diffPath: string;\n  threshold?: number;\n}\n\n/**\n * Session file paths\n */\nexport interface SessionPaths {\n  root: string;\n  sessionJson: string;\n  baseline: string;\n  current: string;\n  diff: string;\n}\n\n/**\n * CLI output format\n */\nexport type OutputFormat = 'json' | 'text' | 'minimal';\n\n/**\n * Session list item for display\n */\nexport interface SessionListItem {\n  id: string;\n  name: string;\n  url: string;\n  status: string;\n  createdAt: string;\n  viewport: string;\n}\n\n/**\n * Clean options\n */\nexport interface CleanOptions {\n  olderThan?: string; // e.g., '7d', '24h'\n  keepLast?: number;\n  dryRun?: boolean;\n}\n\n/**\n * Serve options\n */\nexport interface ServeOptions {\n  port?: number;\n  open?: boolean;\n}\n\n/**\n * Authentication options for capture\n */\nexport interface AuthOptions {\n  storageStatePath?: string;\n}\n\n/**\n * Login options\n */\nexport interface LoginOptions {\n  url: string;\n  outputDir: string;\n  timeout?: number;\n}\n\n// Re-export schema types for convenience\nexport type {\n  Config,\n  Session,\n  ComparisonResult,\n  ComparisonReport,\n  Viewport,\n  Analysis,\n};\n","import { chromium } from 'playwright';\nimport { mkdir, access, readFile, writeFile, unlink, chmod, stat } from 'fs/promises';\nimport { join, resolve } from 'path';\nimport { existsSync, readFileSync } from 'fs';\nimport { userInfo, homedir } from 'os';\nimport { createHash, randomBytes } from 'crypto';\nimport type { LoginOptions } from './types.js';\n\n// Auth state file name (reserved for future use)\n// const AUTH_STATE_FILE = 'auth.json';\n\n/**\n * Auth state with metadata for security\n */\ninterface StoredAuthState {\n  state: object; // Playwright storage state\n  metadata: {\n    createdAt: number;\n    expiresAt: number;\n    username: string;\n    projectPath: string;\n  };\n}\n\n/**\n * Check if running in a CI/CD or deployed environment\n * Auth operations should be blocked in these environments\n */\nexport function isDeployedEnvironment(): boolean {\n  return !!(\n    process.env.VERCEL ||\n    process.env.NETLIFY ||\n    process.env.CI ||\n    process.env.GITHUB_ACTIONS ||\n    process.env.GITLAB_CI ||\n    process.env.CIRCLECI ||\n    process.env.JENKINS_URL ||\n    process.env.TRAVIS ||\n    process.env.HEROKU ||\n    process.env.AWS_LAMBDA_FUNCTION_NAME ||\n    process.env.AZURE_FUNCTIONS_ENVIRONMENT\n  );\n}\n\n/**\n * Get the path to the auth state file\n * Uses per-user isolation to prevent credential sharing\n */\nexport function getAuthStatePath(outputDir: string): string {\n  const username = userInfo().username;\n  // Include username in filename for user isolation\n  return join(outputDir, `auth.${username}.json`);\n}\n\n/**\n * Get a secure auth path in user's home directory (alternative)\n * This keeps auth completely outside the project directory\n */\nexport function getSecureAuthPath(projectPath: string): string {\n  const username = userInfo().username;\n  // Hash project path to create unique identifier\n  const projectHash = createHash('sha256')\n    .update(resolve(projectPath))\n    .digest('hex')\n    .substring(0, 16);\n\n  return join(\n    homedir(),\n    '.config',\n    'ibr',\n    'auth',\n    `${projectHash}.${username}.json`\n  );\n}\n\n/**\n * Check if .gitignore properly excludes .ibr directory\n */\nfunction validateGitignore(projectDir: string): void {\n  const gitignorePath = join(projectDir, '.gitignore');\n\n  if (existsSync(gitignorePath)) {\n    const gitignore = readFileSync(gitignorePath, 'utf-8');\n    const lines = gitignore.split('\\n').map(l => l.trim());\n\n    const hasIbrIgnore = lines.some(line =>\n      line === '.ibr/' ||\n      line === '.ibr' ||\n      line === '**/.ibr/' ||\n      line === '**/.ibr'\n    );\n\n    if (!hasIbrIgnore) {\n      console.warn('\\n  WARNING: .ibr/ is not in .gitignore!');\n      console.warn('   Add \".ibr/\" to .gitignore to prevent credential leaks.\\n');\n    }\n  } else {\n    console.warn('\\n  No .gitignore found. Create one with \".ibr/\" entry.\\n');\n  }\n}\n\n/**\n * Check if auth state exists\n */\nexport async function hasAuthState(outputDir: string): Promise<boolean> {\n  try {\n    await access(getAuthStatePath(outputDir));\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Load auth state if it exists and is valid\n */\nexport async function loadAuthState(outputDir: string): Promise<object | null> {\n  // Block in deployed environments\n  if (isDeployedEnvironment()) {\n    console.warn('  Deployed environment detected. Auth state not available.');\n    return null;\n  }\n\n  try {\n    const authPath = getAuthStatePath(outputDir);\n    const content = await readFile(authPath, 'utf-8');\n    const stored: StoredAuthState = JSON.parse(content);\n\n    // Validate metadata exists\n    if (!stored.metadata) {\n      console.warn('  Legacy auth format detected. Please re-authenticate with `ibr login`.');\n      return null;\n    }\n\n    // Check user matches\n    const currentUser = userInfo().username;\n    if (stored.metadata.username !== currentUser) {\n      console.warn(`  Auth state belongs to different user (${stored.metadata.username}).`);\n      return null;\n    }\n\n    // Check expiration\n    if (Date.now() > stored.metadata.expiresAt) {\n      console.warn('  Auth state expired. Please re-authenticate with `ibr login`.');\n      await clearAuthState(outputDir);\n      return null;\n    }\n\n    // Warn if auth is getting old (> 24 hours)\n    const ageHours = (Date.now() - stored.metadata.createdAt) / (1000 * 60 * 60);\n    if (ageHours > 24) {\n      console.warn(`  Auth state is ${Math.floor(ageHours)} hours old. Consider re-authenticating.`);\n    }\n\n    return stored.state;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Open a browser for manual login and save the state\n *\n * This opens a visible browser window where the user can:\n * 1. Navigate to login page\n * 2. Enter credentials\n * 3. Complete any 2FA or other auth steps\n *\n * When done, close the browser or press Ctrl+C to save the state.\n */\nexport async function performLogin(options: LoginOptions): Promise<string> {\n  const { url, outputDir, timeout = 300000 } = options; // 5 min default timeout\n\n  // Block in deployed environments\n  if (isDeployedEnvironment()) {\n    throw new Error(\n      'Authentication cannot be performed in deployed environments.\\n' +\n      'Run `ibr login` locally on your development machine.'\n    );\n  }\n\n  // Validate .gitignore before storing credentials\n  validateGitignore(process.cwd());\n\n  // Ensure output directory exists with restricted permissions\n  await mkdir(outputDir, { recursive: true, mode: 0o700 }); // rwx------\n\n  // Fix permissions on existing directory\n  try {\n    await chmod(outputDir, 0o700);\n  } catch {\n    // Ignore if chmod fails (e.g., on Windows)\n  }\n\n  const authStatePath = getAuthStatePath(outputDir);\n  const currentUser = userInfo().username;\n\n  console.log('\\n Opening browser for login...');\n  console.log(`   User: ${currentUser}`);\n  console.log('   Navigate to your login page and complete authentication.');\n  console.log('   When finished, close the browser window to save your session.\\n');\n\n  const browser = await chromium.launch({\n    headless: false, // Visible browser for manual login\n  });\n\n  const context = await browser.newContext({\n    viewport: { width: 1280, height: 800 },\n  });\n\n  const page = await context.newPage();\n\n  try {\n    // Navigate to the provided URL\n    await page.goto(url, {\n      waitUntil: 'domcontentloaded',\n      timeout: 30000,\n    });\n\n    // Wait for browser to close (user manually closes it after login)\n    // or timeout after the specified duration\n    await Promise.race([\n      new Promise<void>((resolve) => {\n        browser.on('disconnected', () => resolve());\n      }),\n      new Promise<void>((_, reject) => {\n        setTimeout(() => reject(new Error('Login timeout exceeded')), timeout);\n      }),\n    ]);\n\n  } catch (error) {\n    // If browser is still open, save the state before closing\n    if (browser.isConnected()) {\n      await saveAuthState(context, authStatePath, outputDir);\n      await browser.close();\n    }\n\n    // Check if it was a timeout or browser close\n    if (error instanceof Error && error.message.includes('timeout')) {\n      throw error;\n    }\n  }\n\n  // If we get here without the browser being disconnected, save state\n  if (browser.isConnected()) {\n    await saveAuthState(context, authStatePath, outputDir);\n    await browser.close();\n  } else {\n    // Browser was closed by user - try to reconnect to save state\n    console.log('\\n  Browser was closed. Attempting to save any captured state...');\n\n    // Create a new context just to save an empty state as fallback\n    const newBrowser = await chromium.launch({ headless: true });\n    const newContext = await newBrowser.newContext();\n\n    // Try to use any cookies from the page\n    try {\n      await newContext.addCookies(await context.cookies());\n    } catch {\n      // Context might be closed\n    }\n\n    await saveAuthState(newContext, authStatePath, outputDir);\n    await newBrowser.close();\n  }\n\n  console.log(`\\n Auth state saved for user: ${currentUser}`);\n  console.log(`   Location: ${authStatePath}`);\n  console.log('   Expires: 7 days from now');\n  console.log('   Future captures will use this authentication.\\n');\n\n  return authStatePath;\n}\n\n/**\n * Save auth state with metadata and secure permissions\n */\nasync function saveAuthState(\n  context: import('playwright').BrowserContext,\n  authStatePath: string,\n  _outputDir: string\n): Promise<void> {\n  const state = await context.storageState();\n  const currentUser = userInfo().username;\n\n  const storedState: StoredAuthState = {\n    state,\n    metadata: {\n      createdAt: Date.now(),\n      expiresAt: Date.now() + (7 * 24 * 60 * 60 * 1000), // 7 days\n      username: currentUser,\n      projectPath: resolve(process.cwd()),\n    }\n  };\n\n  // Write with restricted permissions (owner read/write only)\n  await writeFile(\n    authStatePath,\n    JSON.stringify(storedState, null, 2),\n    { mode: 0o600 } // rw-------\n  );\n\n  // Ensure permissions are correct (in case file existed)\n  try {\n    await chmod(authStatePath, 0o600);\n  } catch {\n    // Ignore if chmod fails (e.g., on Windows)\n  }\n}\n\n/**\n * Clear saved auth state with secure deletion\n */\nexport async function clearAuthState(outputDir: string): Promise<void> {\n  const authPath = getAuthStatePath(outputDir);\n\n  try {\n    // Get file stats for size\n    const stats = await stat(authPath);\n\n    // Overwrite with random data before deletion (secure delete)\n    const randomData = randomBytes(stats.size);\n    await writeFile(authPath, randomData, { mode: 0o600 });\n\n    // Now delete the file\n    await unlink(authPath);\n\n    console.log(' Auth state securely cleared');\n  } catch {\n    console.log('  No auth state to clear');\n  }\n}\n\n/**\n * Get auth state info without loading the full state\n */\nexport async function getAuthStateInfo(outputDir: string): Promise<{\n  exists: boolean;\n  username?: string;\n  createdAt?: Date;\n  expiresAt?: Date;\n  expired?: boolean;\n} | null> {\n  try {\n    const authPath = getAuthStatePath(outputDir);\n    const content = await readFile(authPath, 'utf-8');\n    const stored: StoredAuthState = JSON.parse(content);\n\n    if (!stored.metadata) {\n      return { exists: true };\n    }\n\n    return {\n      exists: true,\n      username: stored.metadata.username,\n      createdAt: new Date(stored.metadata.createdAt),\n      expiresAt: new Date(stored.metadata.expiresAt),\n      expired: Date.now() > stored.metadata.expiresAt,\n    };\n  } catch {\n    return null;\n  }\n}\n","/**\n * Landmark Element Detection\n *\n * Detects common landmark elements on a page. Used for:\n * 1. Storing detected elements in baseline\n * 2. Comparing current elements against baseline\n * 3. Inferring expected elements from page intent when no baseline exists\n */\n\nimport type { Page } from 'playwright';\nimport type { LandmarkElement } from '../schemas.js';\nimport type { PageIntent } from './page-intent.js';\n\n/**\n * Standard landmark selectors\n */\nexport const LANDMARK_SELECTORS = {\n  logo: 'img[src*=\"logo\"], img[alt*=\"logo\" i], [class*=\"logo\"], [id*=\"logo\"], svg[class*=\"logo\"]',\n  header: 'header, [role=\"banner\"], [class*=\"header\"]:not([class*=\"subheader\"])',\n  navigation: 'nav, [role=\"navigation\"], [class*=\"nav\"]:not([class*=\"subnav\"])',\n  main: 'main, [role=\"main\"], [class*=\"main-content\"], #main',\n  footer: 'footer, [role=\"contentinfo\"], [class*=\"footer\"]',\n  sidebar: 'aside, [role=\"complementary\"], [class*=\"sidebar\"]',\n  search: 'input[type=\"search\"], [role=\"search\"], [class*=\"search-input\"], input[name*=\"search\"]',\n  heading: 'h1',\n  userMenu: '[class*=\"user-menu\"], [class*=\"avatar\"], [class*=\"profile\"], [class*=\"account\"]',\n  loginForm: 'form:has(input[type=\"password\"])',\n  heroSection: '[class*=\"hero\"], [class*=\"banner\"], [class*=\"jumbotron\"]',\n  ctaButton: '[class*=\"cta\"], a[class*=\"primary\"], button[class*=\"primary\"]',\n} as const;\n\nexport type LandmarkType = keyof typeof LANDMARK_SELECTORS;\n\n/**\n * Detect all landmark elements on a page\n */\nexport async function detectLandmarks(page: Page): Promise<LandmarkElement[]> {\n  const landmarks: LandmarkElement[] = [];\n\n  for (const [name, selector] of Object.entries(LANDMARK_SELECTORS)) {\n    try {\n      const element = await page.$(selector);\n      if (element) {\n        const box = await element.boundingBox();\n        landmarks.push({\n          name,\n          selector,\n          found: true,\n          bounds: box ? {\n            x: Math.round(box.x),\n            y: Math.round(box.y),\n            width: Math.round(box.width),\n            height: Math.round(box.height),\n          } : undefined,\n        });\n      } else {\n        landmarks.push({\n          name,\n          selector,\n          found: false,\n        });\n      }\n    } catch {\n      landmarks.push({\n        name,\n        selector,\n        found: false,\n      });\n    }\n  }\n\n  return landmarks;\n}\n\n/**\n * Get expected landmarks based on page intent\n * Used when no baseline exists\n */\nexport function getExpectedLandmarksForIntent(intent: PageIntent): LandmarkType[] {\n  const common: LandmarkType[] = ['header', 'navigation', 'main', 'footer', 'logo'];\n\n  const intentSpecific: Record<PageIntent, LandmarkType[]> = {\n    auth: ['loginForm', 'logo'],\n    form: ['heading'],\n    listing: ['search', 'heading'],\n    detail: ['heading'],\n    dashboard: ['sidebar', 'userMenu', 'heading'],\n    error: ['heading'],\n    landing: ['heroSection', 'ctaButton', 'heading'],\n    empty: ['heading'],\n    unknown: [],\n  };\n\n  // Combine common + intent-specific, dedupe\n  const expected = [...new Set([...common, ...(intentSpecific[intent] || [])])];\n  return expected;\n}\n\n/**\n * Compare current landmarks against baseline\n * Returns missing and new elements\n */\nexport function compareLandmarks(\n  baseline: LandmarkElement[],\n  current: LandmarkElement[]\n): {\n  missing: LandmarkElement[];  // Were in baseline, not in current\n  added: LandmarkElement[];    // In current, not in baseline\n  unchanged: LandmarkElement[];\n} {\n  const baselineFound = baseline.filter(l => l.found);\n  const currentFound = current.filter(l => l.found);\n\n  const baselineNames = new Set(baselineFound.map(l => l.name));\n  const currentNames = new Set(currentFound.map(l => l.name));\n\n  const missing = baselineFound.filter(l => !currentNames.has(l.name));\n  const added = currentFound.filter(l => !baselineNames.has(l.name));\n  const unchanged = currentFound.filter(l => baselineNames.has(l.name));\n\n  return { missing, added, unchanged };\n}\n\n/**\n * Get expected landmarks based on user context (CLAUDE.md design framework)\n */\nexport function getExpectedLandmarksFromContext(\n  framework: { principles: string[] } | null\n): LandmarkType[] {\n  if (!framework) return [];\n\n  const expected: LandmarkType[] = [];\n\n  // Parse principles for landmark requirements\n  const principlesText = framework.principles.join(' ').toLowerCase();\n\n  if (principlesText.includes('logo') || principlesText.includes('brand')) {\n    expected.push('logo');\n  }\n  if (principlesText.includes('navigation') || principlesText.includes('nav')) {\n    expected.push('navigation');\n  }\n  if (principlesText.includes('header') || principlesText.includes('banner')) {\n    expected.push('header');\n  }\n  if (principlesText.includes('footer')) {\n    expected.push('footer');\n  }\n  if (principlesText.includes('sidebar')) {\n    expected.push('sidebar');\n  }\n  if (principlesText.includes('search')) {\n    expected.push('search');\n  }\n  if (principlesText.includes('cta') || principlesText.includes('call-to-action')) {\n    expected.push('ctaButton');\n  }\n  if (principlesText.includes('hero')) {\n    expected.push('heroSection');\n  }\n\n  return expected;\n}\n\n/**\n * Format landmark comparison for display\n */\nexport function formatLandmarkComparison(\n  comparison: ReturnType<typeof compareLandmarks>\n): string {\n  const lines: string[] = [];\n\n  if (comparison.missing.length > 0) {\n    lines.push('Missing (were in baseline):');\n    for (const el of comparison.missing) {\n      lines.push(`  ! ${el.name}`);\n    }\n  }\n\n  if (comparison.added.length > 0) {\n    lines.push('New (not in baseline):');\n    for (const el of comparison.added) {\n      lines.push(`  + ${el.name}`);\n    }\n  }\n\n  if (comparison.unchanged.length > 0) {\n    lines.push('Unchanged:');\n    for (const el of comparison.unchanged) {\n      lines.push(`   ${el.name}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n","/**\n * Page Intent Classification\n *\n * Classifies pages by their semantic purpose based on DOM analysis.\n * This helps AI agents understand what kind of page they're looking at\n * without parsing raw accessibility trees.\n */\n\nimport type { Page } from 'playwright';\n\nexport type PageIntent =\n  | 'auth'        // Login, register, forgot-password, reset-password\n  | 'form'        // Contact, settings, profile edit, checkout\n  | 'listing'     // Search results, product grid, table, feed\n  | 'detail'      // Product page, article, profile view, single item\n  | 'dashboard'   // Admin panel, user home, analytics\n  | 'error'       // 404, 500, access denied, maintenance\n  | 'landing'     // Marketing page, homepage with CTA\n  | 'empty'       // Empty state, no content\n  | 'unknown';\n\nexport interface PageIntentResult {\n  intent: PageIntent;\n  confidence: number;        // 0-1\n  signals: string[];         // What led to this classification\n  secondaryIntent?: PageIntent; // If page has mixed signals\n}\n\ninterface IntentSignals {\n  auth: number;\n  form: number;\n  listing: number;\n  detail: number;\n  dashboard: number;\n  error: number;\n  landing: number;\n  empty: number;\n}\n\n/**\n * Classify page intent from DOM analysis\n */\nexport async function classifyPageIntent(page: Page): Promise<PageIntentResult> {\n  const signals: string[] = [];\n  const scores: IntentSignals = {\n    auth: 0,\n    form: 0,\n    listing: 0,\n    detail: 0,\n    dashboard: 0,\n    error: 0,\n    landing: 0,\n    empty: 0,\n  };\n\n  // Run all checks in parallel for speed\n  const checks = await page.evaluate(() => {\n    const doc = document;\n    const body = doc.body;\n    const text = body?.innerText?.toLowerCase() || '';\n\n    // Helper to count elements\n    const count = (selector: string) => doc.querySelectorAll(selector).length;\n    const exists = (selector: string) => count(selector) > 0;\n    const textContains = (terms: string[]) => terms.some(t => text.includes(t));\n\n    return {\n      // Auth signals\n      hasPasswordField: exists('input[type=\"password\"]'),\n      hasEmailField: exists('input[type=\"email\"], input[name*=\"email\"], input[name*=\"username\"]'),\n      hasLoginText: textContains(['sign in', 'log in', 'login', 'sign up', 'register', 'forgot password', 'reset password']),\n      hasRememberMe: exists('input[type=\"checkbox\"][name*=\"remember\"]') || Array.from(doc.querySelectorAll('label')).some(l => l.textContent?.toLowerCase().includes('remember')),\n      hasOAuthButtons: exists('[class*=\"google\"], [class*=\"facebook\"], [class*=\"github\"], [class*=\"oauth\"], [class*=\"social\"]'),\n\n      // Form signals\n      formCount: count('form'),\n      inputCount: count('input:not([type=\"hidden\"]):not([type=\"search\"])'),\n      textareaCount: count('textarea'),\n      selectCount: count('select'),\n      hasSubmitButton: exists('button[type=\"submit\"], input[type=\"submit\"]'),\n      hasFormLabels: count('label') > 2,\n\n      // Listing signals\n      listItemCount: count('li, [class*=\"item\"], [class*=\"card\"], [class*=\"row\"]'),\n      hasGrid: exists('[class*=\"grid\"], [class*=\"list\"], [class*=\"feed\"]'),\n      hasTable: exists('table tbody tr'),\n      hasPagination: exists('[class*=\"pagination\"], [class*=\"pager\"], nav[aria-label*=\"page\"]'),\n      hasFilters: exists('[class*=\"filter\"], [class*=\"sort\"], [class*=\"facet\"]'),\n      repeatingSimilarElements: (() => {\n        const cards = doc.querySelectorAll('[class*=\"card\"], [class*=\"item\"]');\n        if (cards.length < 3) return false;\n        const classes = Array.from(cards).map(c => c.className);\n        const unique = new Set(classes);\n        return unique.size <= 3; // Similar classes = listing\n      })(),\n\n      // Detail signals\n      hasMainArticle: exists('article, main > [class*=\"content\"], [class*=\"detail\"]'),\n      hasLongContent: text.length > 2000,\n      hasSingleHeading: count('h1') === 1,\n      hasMetadata: exists('[class*=\"meta\"], [class*=\"author\"], [class*=\"date\"], time'),\n      hasComments: exists('[class*=\"comment\"], [id*=\"comment\"]'),\n      hasSocialShare: exists('[class*=\"share\"], [class*=\"social\"]'),\n\n      // Dashboard signals\n      hasCharts: exists('canvas, svg[class*=\"chart\"], [class*=\"chart\"], [class*=\"graph\"]'),\n      hasStats: exists('[class*=\"stat\"], [class*=\"metric\"], [class*=\"kpi\"]'),\n      hasSidebar: exists('aside, [class*=\"sidebar\"], nav[class*=\"side\"]'),\n      hasWidgets: exists('[class*=\"widget\"], [class*=\"panel\"], [class*=\"tile\"]'),\n      hasUserMenu: exists('[class*=\"user\"], [class*=\"avatar\"], [class*=\"profile\"]'),\n      hasNavTabs: exists('[role=\"tablist\"], [class*=\"tabs\"]'),\n\n      // Error signals\n      hasErrorCode: textContains(['404', '500', '403', '401', 'not found', 'error', 'denied', 'forbidden']),\n      hasErrorClass: exists('[class*=\"error\"], [class*=\"404\"], [class*=\"500\"]'),\n      isMinimalContent: text.length < 200,\n      hasBackLink: textContains(['go back', 'go home', 'return']),\n\n      // Landing signals\n      hasHero: exists('[class*=\"hero\"], [class*=\"banner\"], [class*=\"jumbotron\"]'),\n      hasCTA: exists('[class*=\"cta\"], [class*=\"call-to-action\"], a[class*=\"primary\"]'),\n      hasTestimonials: exists('[class*=\"testimonial\"], [class*=\"review\"], [class*=\"quote\"]'),\n      hasPricing: exists('[class*=\"pricing\"], [class*=\"plan\"]'),\n      hasFeatures: exists('[class*=\"feature\"], [class*=\"benefit\"]'),\n\n      // Empty signals\n      hasEmptyState: exists('[class*=\"empty\"], [class*=\"no-data\"], [class*=\"no-results\"]'),\n      hasEmptyText: textContains(['no results', 'nothing here', 'no items', 'empty']),\n\n      // General metrics\n      totalElements: count('*'),\n      interactiveElements: count('a, button, input, select, textarea'),\n    };\n  });\n\n  // Score auth intent\n  if (checks.hasPasswordField) {\n    scores.auth += 40;\n    signals.push('password field present');\n  }\n  if (checks.hasEmailField && checks.hasPasswordField) {\n    scores.auth += 20;\n    signals.push('email + password combination');\n  }\n  if (checks.hasLoginText) {\n    scores.auth += 15;\n    signals.push('login-related text');\n  }\n  if (checks.hasRememberMe) {\n    scores.auth += 10;\n    signals.push('remember me checkbox');\n  }\n  if (checks.hasOAuthButtons) {\n    scores.auth += 10;\n    signals.push('OAuth buttons');\n  }\n\n  // Score form intent (but not auth)\n  if (checks.formCount > 0 && !checks.hasPasswordField) {\n    scores.form += 20;\n    signals.push('form without password');\n  }\n  if (checks.inputCount > 3 && !checks.hasPasswordField) {\n    scores.form += 15;\n    signals.push('multiple input fields');\n  }\n  if (checks.textareaCount > 0) {\n    scores.form += 15;\n    signals.push('textarea present');\n  }\n  if (checks.hasFormLabels && checks.inputCount > 2) {\n    scores.form += 10;\n    signals.push('labeled form fields');\n  }\n\n  // Score listing intent\n  if (checks.listItemCount > 5) {\n    scores.listing += 25;\n    signals.push(`${checks.listItemCount} list items`);\n  }\n  if (checks.hasGrid) {\n    scores.listing += 15;\n    signals.push('grid/list layout');\n  }\n  if (checks.hasTable) {\n    scores.listing += 20;\n    signals.push('data table');\n  }\n  if (checks.hasPagination) {\n    scores.listing += 20;\n    signals.push('pagination');\n  }\n  if (checks.hasFilters) {\n    scores.listing += 15;\n    signals.push('filters/sorting');\n  }\n  if (checks.repeatingSimilarElements) {\n    scores.listing += 15;\n    signals.push('repeating card elements');\n  }\n\n  // Score detail intent\n  if (checks.hasMainArticle) {\n    scores.detail += 25;\n    signals.push('main article element');\n  }\n  if (checks.hasLongContent) {\n    scores.detail += 20;\n    signals.push('long content');\n  }\n  if (checks.hasSingleHeading && checks.hasMetadata) {\n    scores.detail += 20;\n    signals.push('single heading with metadata');\n  }\n  if (checks.hasComments) {\n    scores.detail += 15;\n    signals.push('comments section');\n  }\n  if (checks.hasSocialShare) {\n    scores.detail += 10;\n    signals.push('social share buttons');\n  }\n\n  // Score dashboard intent\n  if (checks.hasCharts) {\n    scores.dashboard += 30;\n    signals.push('charts/graphs');\n  }\n  if (checks.hasStats) {\n    scores.dashboard += 25;\n    signals.push('stats/metrics');\n  }\n  if (checks.hasSidebar && checks.hasWidgets) {\n    scores.dashboard += 20;\n    signals.push('sidebar with widgets');\n  }\n  if (checks.hasNavTabs) {\n    scores.dashboard += 10;\n    signals.push('navigation tabs');\n  }\n  if (checks.hasUserMenu) {\n    scores.dashboard += 10;\n    signals.push('user menu');\n  }\n\n  // Score error intent\n  if (checks.hasErrorCode && checks.isMinimalContent) {\n    scores.error += 50;\n    signals.push('error code with minimal content');\n  }\n  if (checks.hasErrorClass) {\n    scores.error += 30;\n    signals.push('error CSS class');\n  }\n  if (checks.hasBackLink && checks.isMinimalContent) {\n    scores.error += 20;\n    signals.push('back link on minimal page');\n  }\n\n  // Score landing intent\n  if (checks.hasHero) {\n    scores.landing += 25;\n    signals.push('hero section');\n  }\n  if (checks.hasCTA) {\n    scores.landing += 20;\n    signals.push('call-to-action');\n  }\n  if (checks.hasTestimonials) {\n    scores.landing += 15;\n    signals.push('testimonials');\n  }\n  if (checks.hasPricing) {\n    scores.landing += 20;\n    signals.push('pricing section');\n  }\n  if (checks.hasFeatures) {\n    scores.landing += 15;\n    signals.push('features section');\n  }\n\n  // Score empty intent\n  if (checks.hasEmptyState) {\n    scores.empty += 40;\n    signals.push('empty state element');\n  }\n  if (checks.hasEmptyText && checks.listItemCount === 0) {\n    scores.empty += 30;\n    signals.push('empty text with no items');\n  }\n\n  // Find highest scoring intent\n  const entries = Object.entries(scores) as [PageIntent, number][];\n  entries.sort((a, b) => b[1] - a[1]);\n\n  const [topIntent, topScore] = entries[0];\n  const [secondIntent, secondScore] = entries[1];\n\n  // Calculate confidence (normalize to 0-1)\n  const maxPossible = 100;\n  const confidence = Math.min(topScore / maxPossible, 1);\n\n  // Determine if there's a secondary intent worth mentioning\n  const hasSecondary = secondScore > 30 && secondScore > topScore * 0.5;\n\n  return {\n    intent: topScore > 20 ? topIntent : 'unknown',\n    confidence,\n    signals: signals.slice(0, 5), // Top 5 signals\n    secondaryIntent: hasSecondary ? secondIntent : undefined,\n  };\n}\n\n/**\n * Get human-readable description of page intent\n */\nexport function getIntentDescription(intent: PageIntent): string {\n  const descriptions: Record<PageIntent, string> = {\n    auth: 'Authentication page (login, register, password reset)',\n    form: 'Form page (data entry, settings, contact)',\n    listing: 'Listing page (search results, product grid, table)',\n    detail: 'Detail page (article, product, profile)',\n    dashboard: 'Dashboard (admin panel, analytics, user home)',\n    error: 'Error page (404, 500, access denied)',\n    landing: 'Landing page (marketing, homepage)',\n    empty: 'Empty state (no content)',\n    unknown: 'Unknown page type',\n  };\n  return descriptions[intent];\n}\n","import { chromium, type Browser, type Page } from 'playwright';\nimport { mkdir } from 'fs/promises';\nimport { dirname } from 'path';\nimport { VIEWPORTS, type Viewport, type LandmarkElement } from './schemas.js';\nimport type { CaptureOptions, MaskOptions } from './types.js';\nimport { DEFAULT_DYNAMIC_SELECTORS } from './types.js';\nimport { loadAuthState, isDeployedEnvironment } from './auth.js';\nimport { detectLandmarks } from './semantic/landmarks.js';\nimport { classifyPageIntent, type PageIntent } from './semantic/page-intent.js';\n\n/**\n * Apply dynamic content masking to a page before screenshot\n */\nasync function applyMasking(page: Page, mask?: MaskOptions): Promise<void> {\n  // Default: always disable animations\n  const hideAnimations = mask?.hideAnimations !== false;\n\n  // Build list of selectors to hide\n  const selectorsToHide: string[] = [];\n\n  // Add user-specified selectors\n  if (mask?.selectors) {\n    selectorsToHide.push(...mask.selectors);\n  }\n\n  // Add default dynamic selectors if enabled\n  if (mask?.hideDynamicContent) {\n    selectorsToHide.push(...DEFAULT_DYNAMIC_SELECTORS);\n  }\n\n  // Build CSS rules\n  const cssRules: string[] = [];\n\n  // Animation/transition disabling\n  if (hideAnimations) {\n    cssRules.push(`\n      *, *::before, *::after {\n        animation-duration: 0s !important;\n        animation-delay: 0s !important;\n        transition-duration: 0s !important;\n        transition-delay: 0s !important;\n        scroll-behavior: auto !important;\n      }\n      @keyframes none { }\n    `);\n  }\n\n  // Hide specified elements\n  if (selectorsToHide.length > 0) {\n    const selectorList = selectorsToHide.join(',\\n');\n    cssRules.push(`\n      ${selectorList} {\n        visibility: hidden !important;\n        opacity: 0 !important;\n      }\n    `);\n  }\n\n  // Inject CSS\n  if (cssRules.length > 0) {\n    await page.addStyleTag({\n      content: cssRules.join('\\n'),\n    });\n  }\n\n  // Apply text pattern masking via JavaScript\n  if (mask?.textPatterns && mask.textPatterns.length > 0) {\n    const placeholder = mask.placeholder || '';\n    const patterns = mask.textPatterns.map(p =>\n      typeof p === 'string' ? p : p.source\n    );\n\n    await page.evaluate(({ patterns, placeholder }) => {\n      const walker = document.createTreeWalker(\n        document.body,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n\n      const textNodes: Text[] = [];\n      let node: Text | null;\n      while ((node = walker.nextNode() as Text | null)) {\n        textNodes.push(node);\n      }\n\n      for (const textNode of textNodes) {\n        let text = textNode.textContent || '';\n        for (const pattern of patterns) {\n          const regex = new RegExp(pattern, 'gi');\n          text = text.replace(regex, placeholder);\n        }\n        if (text !== textNode.textContent) {\n          textNode.textContent = text;\n        }\n      }\n    }, { patterns, placeholder });\n  }\n}\n\n/**\n * Capture result with timing and diagnostic info\n */\nexport interface CaptureResult {\n  success: boolean;\n  outputPath?: string;\n  timing: {\n    navigationMs: number;\n    renderMs: number;\n    totalMs: number;\n  };\n  diagnostics: {\n    httpStatus?: number;\n    consoleErrors: string[];\n    networkErrors: string[];\n    suggestions: string[];\n  };\n  error?: {\n    type: 'timeout' | 'navigation' | 'screenshot' | 'unknown';\n    message: string;\n    suggestion: string;\n  };\n}\n\n// Playwright's storage state type\ntype StorageState = {\n  cookies: Array<{\n    name: string;\n    value: string;\n    domain: string;\n    path: string;\n    expires: number;\n    httpOnly: boolean;\n    secure: boolean;\n    sameSite: 'Strict' | 'Lax' | 'None';\n  }>;\n  origins: Array<{\n    origin: string;\n    localStorage: Array<{ name: string; value: string }>;\n  }>;\n};\n\nlet browser: Browser | null = null;\n\n/**\n * Get or create a browser instance\n */\nasync function getBrowser(): Promise<Browser> {\n  if (!browser) {\n    browser = await chromium.launch({\n      headless: true,\n    });\n  }\n  return browser;\n}\n\n/**\n * Close the browser instance\n */\nexport async function closeBrowser(): Promise<void> {\n  if (browser) {\n    await browser.close();\n    browser = null;\n  }\n}\n\n/**\n * Capture a screenshot of a URL\n */\nexport async function captureScreenshot(\n  options: CaptureOptions & { outputDir?: string }\n): Promise<string> {\n  const {\n    url,\n    outputPath,\n    viewport = VIEWPORTS.desktop,\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n    outputDir,\n    selector,\n    waitFor,\n  } = options;\n\n  // Ensure output directory exists\n  await mkdir(dirname(outputPath), { recursive: true });\n\n  // Load auth state if available (handles validation, expiration, user isolation)\n  let storageState: StorageState | undefined;\n  if (outputDir && !isDeployedEnvironment()) {\n    const authState = await loadAuthState(outputDir);\n    if (authState) {\n      storageState = authState as StorageState;\n      console.log(' Using saved authentication state');\n    }\n  }\n\n  const browserInstance = await getBrowser();\n  const context = await browserInstance.newContext({\n    viewport: {\n      width: viewport.width,\n      height: viewport.height,\n    },\n    // Disable animations for consistent screenshots\n    reducedMotion: 'reduce',\n    // Load auth state if available (Playwright accepts object or file path)\n    ...(storageState ? { storageState } : {}),\n  });\n\n  const page = await context.newPage();\n\n  try {\n    // Navigate to URL\n    await page.goto(url, {\n      waitUntil: waitForNetworkIdle ? 'networkidle' : 'load',\n      timeout,\n    });\n\n    // Wait for specific selector if provided (for dynamic content)\n    if (waitFor) {\n      await page.waitForSelector(waitFor, { timeout });\n    }\n\n    // Wait for any remaining animations to settle\n    await page.waitForTimeout(500);\n\n    // Apply dynamic content masking (includes animation disabling)\n    await applyMasking(page, options.mask);\n\n    // Take screenshot - element or full page\n    if (selector) {\n      // Wait for element and capture just that element\n      const element = await page.waitForSelector(selector, { timeout: 5000 });\n      if (!element) {\n        throw new Error(`Element not found: ${selector}`);\n      }\n      await element.screenshot({\n        path: outputPath,\n        type: 'png',\n      });\n    } else {\n      await page.screenshot({\n        path: outputPath,\n        fullPage,\n        type: 'png',\n      });\n    }\n\n    return outputPath;\n  } finally {\n    await context.close();\n  }\n}\n\n/**\n * Capture result with landmark detection\n */\nexport interface CaptureWithLandmarksResult {\n  outputPath: string;\n  landmarkElements: LandmarkElement[];\n  pageIntent: PageIntent;\n}\n\n/**\n * Capture a screenshot and detect landmark elements\n * Used during baseline capture to store expected elements\n */\nexport async function captureWithLandmarks(\n  options: CaptureOptions & { outputDir?: string }\n): Promise<CaptureWithLandmarksResult> {\n  const {\n    url,\n    outputPath,\n    viewport = VIEWPORTS.desktop,\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n    outputDir,\n    selector,\n    waitFor,\n  } = options;\n\n  // Ensure output directory exists\n  await mkdir(dirname(outputPath), { recursive: true });\n\n  // Load auth state if available\n  let storageState: StorageState | undefined;\n  if (outputDir && !isDeployedEnvironment()) {\n    const authState = await loadAuthState(outputDir);\n    if (authState) {\n      storageState = authState as StorageState;\n      console.log(' Using saved authentication state');\n    }\n  }\n\n  const browserInstance = await getBrowser();\n  const context = await browserInstance.newContext({\n    viewport: {\n      width: viewport.width,\n      height: viewport.height,\n    },\n    reducedMotion: 'reduce',\n    ...(storageState ? { storageState } : {}),\n  });\n\n  const page = await context.newPage();\n\n  try {\n    // Navigate to URL\n    await page.goto(url, {\n      waitUntil: waitForNetworkIdle ? 'networkidle' : 'load',\n      timeout,\n    });\n\n    // Wait for specific selector if provided\n    if (waitFor) {\n      await page.waitForSelector(waitFor, { timeout });\n    }\n\n    // Wait for animations to settle\n    await page.waitForTimeout(500);\n\n    // Detect page intent and landmarks while page is still open\n    const intentResult = await classifyPageIntent(page);\n    const landmarkElements = await detectLandmarks(page);\n\n    // Apply dynamic content masking (includes animation disabling)\n    await applyMasking(page, options.mask);\n\n    // Take screenshot\n    if (selector) {\n      const element = await page.waitForSelector(selector, { timeout: 5000 });\n      if (!element) {\n        throw new Error(`Element not found: ${selector}`);\n      }\n      await element.screenshot({\n        path: outputPath,\n        type: 'png',\n      });\n    } else {\n      await page.screenshot({\n        path: outputPath,\n        fullPage,\n        type: 'png',\n      });\n    }\n\n    return {\n      outputPath,\n      landmarkElements,\n      pageIntent: intentResult.intent,\n    };\n  } finally {\n    await context.close();\n  }\n}\n\n/**\n * Get viewport dimensions by name\n */\nexport function getViewport(name: 'desktop' | 'mobile' | 'tablet'): Viewport {\n  return VIEWPORTS[name];\n}\n\n/**\n * Capture multiple viewports\n */\nexport async function captureMultipleViewports(\n  url: string,\n  outputDir: string,\n  viewports: Array<'desktop' | 'mobile' | 'tablet'> = ['desktop'],\n  options: Omit<CaptureOptions, 'url' | 'outputPath' | 'viewport'> = {}\n): Promise<Record<string, string>> {\n  const results: Record<string, string> = {};\n\n  for (const viewportName of viewports) {\n    const viewport = getViewport(viewportName);\n    const outputPath = `${outputDir}/${viewportName}.png`;\n\n    await captureScreenshot({\n      url,\n      outputPath,\n      viewport,\n      ...options,\n    });\n\n    results[viewportName] = outputPath;\n  }\n\n  return results;\n}\n\n/**\n * Enhanced capture with detailed timing and diagnostics\n * Returns actionable info for debugging slow loads or errors\n */\nexport async function captureWithDiagnostics(\n  options: CaptureOptions & { outputDir?: string }\n): Promise<CaptureResult> {\n  const {\n    url,\n    outputPath,\n    viewport = VIEWPORTS.desktop,\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n    outputDir,\n    selector,\n  } = options;\n\n  const startTime = Date.now();\n  let navigationTime = 0;\n  let renderTime = 0;\n\n  const consoleErrors: string[] = [];\n  const networkErrors: string[] = [];\n  const suggestions: string[] = [];\n  let httpStatus: number | undefined;\n\n  try {\n    // Ensure output directory exists\n    await mkdir(dirname(outputPath), { recursive: true });\n\n    // Load auth state if available\n    let storageState: StorageState | undefined;\n    if (outputDir && !isDeployedEnvironment()) {\n      const authState = await loadAuthState(outputDir);\n      if (authState) {\n        storageState = authState as StorageState;\n      }\n    }\n\n    const browserInstance = await getBrowser();\n    const context = await browserInstance.newContext({\n      viewport: {\n        width: viewport.width,\n        height: viewport.height,\n      },\n      reducedMotion: 'reduce',\n      ...(storageState ? { storageState } : {}),\n    });\n\n    const page = await context.newPage();\n\n    // Collect console errors\n    page.on('console', msg => {\n      if (msg.type() === 'error') {\n        consoleErrors.push(msg.text());\n      }\n    });\n\n    // Collect network errors\n    page.on('requestfailed', request => {\n      const failure = request.failure();\n      networkErrors.push(`${request.url()}: ${failure?.errorText || 'failed'}`);\n    });\n\n    // Track HTTP status\n    page.on('response', response => {\n      if (response.url() === url || response.url() === url + '/') {\n        httpStatus = response.status();\n      }\n    });\n\n    try {\n      const navStart = Date.now();\n      await page.goto(url, {\n        waitUntil: waitForNetworkIdle ? 'networkidle' : 'load',\n        timeout,\n      });\n      navigationTime = Date.now() - navStart;\n    } catch (navError) {\n      await context.close();\n\n      const errorMsg = navError instanceof Error ? navError.message : String(navError);\n      const isTimeout = errorMsg.includes('Timeout');\n\n      // Generate helpful suggestions\n      if (isTimeout) {\n        suggestions.push(`Page took longer than ${timeout}ms to load`);\n        suggestions.push('Try increasing timeout: --timeout 60000');\n        if (waitForNetworkIdle) {\n          suggestions.push('Try disabling network idle wait: use \"load\" instead of \"networkidle\"');\n        }\n      }\n      if (networkErrors.length > 0) {\n        suggestions.push(`${networkErrors.length} network request(s) failed`);\n      }\n      if (httpStatus && httpStatus >= 400) {\n        suggestions.push(`Server returned HTTP ${httpStatus}`);\n      }\n\n      return {\n        success: false,\n        timing: {\n          navigationMs: Date.now() - startTime,\n          renderMs: 0,\n          totalMs: Date.now() - startTime,\n        },\n        diagnostics: {\n          httpStatus,\n          consoleErrors,\n          networkErrors,\n          suggestions,\n        },\n        error: {\n          type: isTimeout ? 'timeout' : 'navigation',\n          message: errorMsg,\n          suggestion: isTimeout\n            ? `Increase timeout or check if ${url} is responding`\n            : `Check if the server is running at ${url}`,\n        },\n      };\n    }\n\n    // Wait for animations to settle\n    await page.waitForTimeout(500);\n\n    // Apply dynamic content masking (includes animation disabling)\n    await applyMasking(page, options.mask);\n\n    // Take screenshot - element or full page\n    const renderStart = Date.now();\n    if (selector) {\n      const element = await page.waitForSelector(selector, { timeout: 5000 });\n      if (!element) {\n        throw new Error(`Element not found: ${selector}`);\n      }\n      await element.screenshot({\n        path: outputPath,\n        type: 'png',\n      });\n    } else {\n      await page.screenshot({\n        path: outputPath,\n        fullPage,\n        type: 'png',\n      });\n    }\n    renderTime = Date.now() - renderStart;\n\n    await context.close();\n\n    // Generate performance suggestions\n    if (navigationTime > 5000) {\n      suggestions.push(`Slow page load: ${(navigationTime / 1000).toFixed(1)}s`);\n    }\n    if (consoleErrors.length > 0) {\n      suggestions.push(`${consoleErrors.length} JavaScript error(s) detected`);\n    }\n\n    return {\n      success: true,\n      outputPath,\n      timing: {\n        navigationMs: navigationTime,\n        renderMs: renderTime,\n        totalMs: Date.now() - startTime,\n      },\n      diagnostics: {\n        httpStatus,\n        consoleErrors,\n        networkErrors,\n        suggestions,\n      },\n    };\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : String(error);\n\n    return {\n      success: false,\n      timing: {\n        navigationMs: navigationTime,\n        renderMs: renderTime,\n        totalMs: Date.now() - startTime,\n      },\n      diagnostics: {\n        httpStatus,\n        consoleErrors,\n        networkErrors,\n        suggestions,\n      },\n      error: {\n        type: 'unknown',\n        message: errorMsg,\n        suggestion: 'Check browser installation: npx playwright install chromium',\n      },\n    };\n  }\n}\n","import pixelmatch from 'pixelmatch';\nimport { PNG } from 'pngjs';\nimport { readFile, writeFile, mkdir } from 'fs/promises';\nimport { dirname } from 'path';\nimport type { CompareOptions } from './types.js';\nimport type { ComparisonResult, Analysis, ChangedRegion, Verdict } from './schemas.js';\n\n/**\n * Region detection configuration\n * Divides page into semantic regions based on common layout patterns\n */\ninterface RegionConfig {\n  name: string;\n  location: 'top' | 'bottom' | 'left' | 'right' | 'center' | 'full';\n  // Percentages of page dimensions\n  xStart: number;  // 0-1\n  xEnd: number;    // 0-1\n  yStart: number;  // 0-1\n  yEnd: number;    // 0-1\n}\n\n/**\n * Default regions based on common web layouts\n * Header (top 10%), Footer (bottom 10%), Left sidebar (left 20%), Content (center)\n */\nconst DEFAULT_REGIONS: RegionConfig[] = [\n  { name: 'header', location: 'top', xStart: 0, xEnd: 1, yStart: 0, yEnd: 0.1 },\n  { name: 'navigation', location: 'left', xStart: 0, xEnd: 0.2, yStart: 0.1, yEnd: 0.9 },\n  { name: 'content', location: 'center', xStart: 0.2, xEnd: 1, yStart: 0.1, yEnd: 0.9 },\n  { name: 'footer', location: 'bottom', xStart: 0, xEnd: 1, yStart: 0.9, yEnd: 1 },\n];\n\n/**\n * Analyze diff image to detect which regions have changes\n */\nexport function detectChangedRegions(\n  diffData: Uint8Array,\n  width: number,\n  height: number,\n  regions: RegionConfig[] = DEFAULT_REGIONS\n): ChangedRegion[] {\n  const changedRegions: ChangedRegion[] = [];\n\n  for (const region of regions) {\n    // Calculate pixel bounds\n    const xStart = Math.floor(region.xStart * width);\n    const xEnd = Math.floor(region.xEnd * width);\n    const yStart = Math.floor(region.yStart * height);\n    const yEnd = Math.floor(region.yEnd * height);\n\n    const regionWidth = xEnd - xStart;\n    const regionHeight = yEnd - yStart;\n    const regionPixels = regionWidth * regionHeight;\n\n    if (regionPixels === 0) continue;\n\n    // Count red pixels (diff color) in this region\n    let diffPixels = 0;\n\n    for (let y = yStart; y < yEnd; y++) {\n      for (let x = xStart; x < xEnd; x++) {\n        const idx = (y * width + x) * 4;\n        // Check if pixel is red (diff marker from pixelmatch)\n        // pixelmatch uses [255, 0, 0] for differences\n        if (diffData[idx] === 255 && diffData[idx + 1] === 0 && diffData[idx + 2] === 0) {\n          diffPixels++;\n        }\n      }\n    }\n\n    const diffPercent = (diffPixels / regionPixels) * 100;\n\n    // Only report regions with >0.1% changes\n    if (diffPercent > 0.1) {\n      const severity = diffPercent > 30 ? 'critical' :\n                       diffPercent > 10 ? 'unexpected' : 'expected';\n\n      changedRegions.push({\n        location: region.location,\n        bounds: {\n          x: xStart,\n          y: yStart,\n          width: regionWidth,\n          height: regionHeight,\n        },\n        description: `${region.name}: ${diffPercent.toFixed(1)}% changed`,\n        severity,\n      });\n    }\n  }\n\n  // Sort by severity (critical first) then by diff percentage\n  return changedRegions.sort((a, b) => {\n    const severityOrder = { critical: 0, unexpected: 1, expected: 2 };\n    const aSev = severityOrder[a.severity];\n    const bSev = severityOrder[b.severity];\n    if (aSev !== bSev) return aSev - bSev;\n\n    // Parse percentage from description for secondary sort\n    const aPercent = parseFloat(a.description.match(/(\\d+\\.?\\d*)%/)?.[1] || '0');\n    const bPercent = parseFloat(b.description.match(/(\\d+\\.?\\d*)%/)?.[1] || '0');\n    return bPercent - aPercent;\n  });\n}\n\n/**\n * Extended comparison result with diff image data for regional analysis\n */\nexport interface ExtendedComparisonResult extends ComparisonResult {\n  diffData?: Uint8Array;\n  width?: number;\n  height?: number;\n}\n\n/**\n * Compare two images using pixelmatch\n */\nexport async function compareImages(options: CompareOptions): Promise<ExtendedComparisonResult> {\n  const {\n    baselinePath,\n    currentPath,\n    diffPath,\n    threshold = 0.1, // pixelmatch threshold (0-1), lower = stricter\n  } = options;\n\n  // Read images\n  const [baselineBuffer, currentBuffer] = await Promise.all([\n    readFile(baselinePath),\n    readFile(currentPath),\n  ]);\n\n  const baseline = PNG.sync.read(baselineBuffer);\n  const current = PNG.sync.read(currentBuffer);\n\n  // Ensure images have same dimensions\n  if (baseline.width !== current.width || baseline.height !== current.height) {\n    throw new Error(\n      `Image dimensions mismatch: baseline (${baseline.width}x${baseline.height}) vs current (${current.width}x${current.height})`\n    );\n  }\n\n  const { width, height } = baseline;\n  const diff = new PNG({ width, height });\n  const totalPixels = width * height;\n\n  // Run pixelmatch\n  const diffPixels = pixelmatch(\n    baseline.data,\n    current.data,\n    diff.data,\n    width,\n    height,\n    {\n      threshold,\n      includeAA: false, // Ignore anti-aliasing differences\n      alpha: 0.1,\n      diffColor: [255, 0, 0], // Red for differences\n      diffColorAlt: [0, 255, 0], // Green for anti-aliased differences\n    }\n  );\n\n  // Ensure output directory exists\n  await mkdir(dirname(diffPath), { recursive: true });\n\n  // Write diff image\n  await writeFile(diffPath, PNG.sync.write(diff));\n\n  const diffPercent = (diffPixels / totalPixels) * 100;\n\n  return {\n    match: diffPixels === 0,\n    diffPercent: Math.round(diffPercent * 100) / 100, // Round to 2 decimal places\n    diffPixels,\n    totalPixels,\n    threshold,\n    // Include diff data for regional analysis\n    diffData: diff.data,\n    width,\n    height,\n  };\n}\n\n/**\n * Analyze comparison result and generate verdict with regional analysis\n */\nexport function analyzeComparison(\n  result: ExtendedComparisonResult,\n  thresholdPercent: number = 1.0\n): Analysis {\n  const { match, diffPercent, diffData, width, height } = result;\n\n  // Detect changed regions if diff data is available\n  let detectedRegions: ChangedRegion[] = [];\n  if (diffData && width && height && !match) {\n    detectedRegions = detectChangedRegions(diffData, width, height);\n  }\n\n  // Analyze regions for verdict determination\n  const criticalRegions = detectedRegions.filter(r => r.severity === 'critical');\n  const unexpectedRegions = detectedRegions.filter(r => r.severity === 'unexpected');\n  const hasNavigationChanges = detectedRegions.some(r =>\n    r.description.toLowerCase().includes('navigation') ||\n    r.description.toLowerCase().includes('header')\n  );\n\n  // Determine verdict based on regions and overall diff\n  let verdict: Verdict;\n  let summary: string;\n  let recommendation: string | null = null;\n\n  if (match || diffPercent === 0) {\n    verdict = 'MATCH';\n    summary = 'No visual changes detected. Screenshots are identical.';\n  } else if (criticalRegions.length > 0) {\n    verdict = 'LAYOUT_BROKEN';\n    const regionNames = criticalRegions.map(r =>\n      r.description.split(':')[0]\n    ).join(', ');\n    summary = `Critical changes in: ${regionNames}. Layout may be broken.`;\n    recommendation = `Major changes detected in ${regionNames}. Check for missing elements, broken layout, or loading errors.`;\n  } else if (unexpectedRegions.length > 0 || diffPercent > 20) {\n    verdict = 'UNEXPECTED_CHANGE';\n    const regionNames = unexpectedRegions.length > 0\n      ? unexpectedRegions.map(r => r.description.split(':')[0]).join(', ')\n      : 'multiple areas';\n    summary = `Significant changes in: ${regionNames} (${diffPercent}% overall).`;\n    recommendation = hasNavigationChanges\n      ? 'Navigation area changed - verify menu items and links are correct.'\n      : 'Review changes carefully - some may be unintentional.';\n  } else if (diffPercent <= thresholdPercent) {\n    verdict = 'EXPECTED_CHANGE';\n    summary = `Minor changes detected (${diffPercent}%). Within acceptable threshold.`;\n  } else {\n    verdict = 'EXPECTED_CHANGE';\n    const regionNames = detectedRegions.length > 0\n      ? detectedRegions.map(r => r.description.split(':')[0]).join(', ')\n      : 'content area';\n    summary = `Changes in: ${regionNames} (${diffPercent}% overall). Changes appear intentional.`;\n  }\n\n  // Separate expected vs unexpected changes\n  const changedRegions = detectedRegions.filter(r => r.severity === 'expected');\n  const unexpectedChanges = detectedRegions.filter(r =>\n    r.severity === 'unexpected' || r.severity === 'critical'\n  );\n\n  // If no regions detected but there are changes, create a fallback region\n  if (detectedRegions.length === 0 && !match) {\n    const fallbackRegion: ChangedRegion = {\n      location: diffPercent > 50 ? 'full' : 'center',\n      bounds: { x: 0, y: 0, width: width || 0, height: height || 0 },\n      description: `overall: ${diffPercent}% changed`,\n      severity: verdict === 'LAYOUT_BROKEN' ? 'critical' :\n                verdict === 'UNEXPECTED_CHANGE' ? 'unexpected' : 'expected',\n    };\n\n    if (verdict === 'UNEXPECTED_CHANGE' || verdict === 'LAYOUT_BROKEN') {\n      unexpectedChanges.push(fallbackRegion);\n    } else {\n      changedRegions.push(fallbackRegion);\n    }\n  }\n\n  return {\n    verdict,\n    summary,\n    changedRegions,\n    unexpectedChanges,\n    recommendation,\n  };\n}\n\n/**\n * Get a human-readable verdict description\n */\nexport function getVerdictDescription(verdict: Verdict): string {\n  switch (verdict) {\n    case 'MATCH':\n      return 'No changes - screenshots match';\n    case 'EXPECTED_CHANGE':\n      return 'Changes detected - appear intentional';\n    case 'UNEXPECTED_CHANGE':\n      return 'Unexpected changes - review required';\n    case 'LAYOUT_BROKEN':\n      return 'Layout broken - significant issues detected';\n    default:\n      return 'Unknown verdict';\n  }\n}\n","import { nanoid } from 'nanoid';\nimport { mkdir, readFile, writeFile, readdir, rm } from 'fs/promises';\nimport { join } from 'path';\nimport { SessionSchema, SessionQuerySchema, type Session, type SessionQuery, type Viewport, type ComparisonResult, type Analysis } from './schemas.js';\nimport type { SessionPaths, CleanOptions } from './types.js';\nimport { getAppContext, getSessionBasePath, type AppContext } from './git-context.js';\n\nconst SESSION_PREFIX = 'sess_';\n\n/**\n * Generate a unique session ID\n */\nexport function generateSessionId(): string {\n  return `${SESSION_PREFIX}${nanoid(10)}`;\n}\n\n/**\n * Get paths for a session (legacy flat structure)\n */\nexport function getSessionPaths(outputDir: string, sessionId: string): SessionPaths {\n  const root = join(outputDir, 'sessions', sessionId);\n  return {\n    root,\n    sessionJson: join(root, 'session.json'),\n    baseline: join(root, 'baseline.png'),\n    current: join(root, 'current.png'),\n    diff: join(root, 'diff.png'),\n  };\n}\n\n/**\n * Get paths for a session with git context awareness\n * Uses: .ibr/apps/{appName}/{branch}/sessions/{sessionId}/\n * Falls back to flat structure for non-git projects\n */\nexport function getSessionPathsWithContext(\n  outputDir: string,\n  sessionId: string,\n  context: AppContext | null\n): SessionPaths {\n  const basePath = context\n    ? getSessionBasePath(outputDir, context)\n    : join(outputDir, 'sessions');\n\n  const root = join(basePath, sessionId);\n  return {\n    root,\n    sessionJson: join(root, 'session.json'),\n    baseline: join(root, 'baseline.png'),\n    current: join(root, 'current.png'),\n    diff: join(root, 'diff.png'),\n  };\n}\n\n// Cached app context to avoid repeated git lookups\nlet cachedContext: AppContext | null = null;\nlet contextCacheDir: string | null = null;\n\n/**\n * Get cached app context for current directory\n */\nexport async function getCachedAppContext(projectDir: string): Promise<AppContext | null> {\n  if (contextCacheDir === projectDir && cachedContext !== null) {\n    return cachedContext;\n  }\n\n  try {\n    cachedContext = await getAppContext(projectDir);\n    contextCacheDir = projectDir;\n    return cachedContext;\n  } catch {\n    cachedContext = null;\n    contextCacheDir = projectDir;\n    return null;\n  }\n}\n\n/**\n * Create a new session\n */\nexport async function createSession(\n  outputDir: string,\n  url: string,\n  name: string,\n  viewport: Viewport\n): Promise<Session> {\n  const sessionId = generateSessionId();\n  const paths = getSessionPaths(outputDir, sessionId);\n  const now = new Date().toISOString();\n\n  const session: Session = {\n    id: sessionId,\n    name,\n    url,\n    viewport,\n    status: 'baseline',\n    createdAt: now,\n    updatedAt: now,\n  };\n\n  // Create session directory\n  await mkdir(paths.root, { recursive: true });\n\n  // Write session file\n  await writeFile(paths.sessionJson, JSON.stringify(session, null, 2));\n\n  return session;\n}\n\n/**\n * Get a session by ID\n */\nexport async function getSession(outputDir: string, sessionId: string): Promise<Session | null> {\n  const paths = getSessionPaths(outputDir, sessionId);\n\n  try {\n    const content = await readFile(paths.sessionJson, 'utf-8');\n    const data = JSON.parse(content);\n    return SessionSchema.parse(data);\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Update a session\n */\nexport async function updateSession(\n  outputDir: string,\n  sessionId: string,\n  updates: Partial<Omit<Session, 'id' | 'createdAt'>>\n): Promise<Session> {\n  const session = await getSession(outputDir, sessionId);\n  if (!session) {\n    throw new Error(`Session not found: ${sessionId}`);\n  }\n\n  const updated: Session = {\n    ...session,\n    ...updates,\n    updatedAt: new Date().toISOString(),\n  };\n\n  const paths = getSessionPaths(outputDir, sessionId);\n  await writeFile(paths.sessionJson, JSON.stringify(updated, null, 2));\n\n  return updated;\n}\n\n/**\n * Mark session as compared with results\n */\nexport async function markSessionCompared(\n  outputDir: string,\n  sessionId: string,\n  comparison: ComparisonResult,\n  analysis: Analysis\n): Promise<Session> {\n  return updateSession(outputDir, sessionId, {\n    status: 'compared',\n    comparison,\n    analysis,\n  });\n}\n\n/**\n * List all sessions\n */\nexport async function listSessions(outputDir: string): Promise<Session[]> {\n  const sessionsDir = join(outputDir, 'sessions');\n\n  try {\n    const entries = await readdir(sessionsDir, { withFileTypes: true });\n    const sessions: Session[] = [];\n\n    for (const entry of entries) {\n      if (entry.isDirectory() && entry.name.startsWith(SESSION_PREFIX)) {\n        const session = await getSession(outputDir, entry.name);\n        if (session) {\n          sessions.push(session);\n        }\n      }\n    }\n\n    // Sort by creation date, newest first\n    return sessions.sort((a, b) =>\n      new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n    );\n  } catch {\n    return [];\n  }\n}\n\n/**\n * Get the most recent session\n */\nexport async function getMostRecentSession(outputDir: string): Promise<Session | null> {\n  const sessions = await listSessions(outputDir);\n  return sessions[0] || null;\n}\n\n/**\n * Delete a session\n */\nexport async function deleteSession(outputDir: string, sessionId: string): Promise<boolean> {\n  const paths = getSessionPaths(outputDir, sessionId);\n\n  try {\n    await rm(paths.root, { recursive: true, force: true });\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Parse duration string to milliseconds\n */\nfunction parseDuration(duration: string): number {\n  const match = duration.match(/^(\\d+)(d|h|m|s)$/);\n  if (!match) {\n    throw new Error(`Invalid duration format: ${duration}. Use format like '7d', '24h', '30m', '60s'`);\n  }\n\n  const value = parseInt(match[1], 10);\n  const unit = match[2];\n\n  switch (unit) {\n    case 'd': return value * 24 * 60 * 60 * 1000;\n    case 'h': return value * 60 * 60 * 1000;\n    case 'm': return value * 60 * 1000;\n    case 's': return value * 1000;\n    default: return value * 1000;\n  }\n}\n\n/**\n * Clean old sessions\n */\nexport async function cleanSessions(\n  outputDir: string,\n  options: CleanOptions = {}\n): Promise<{ deleted: string[]; kept: string[] }> {\n  const { olderThan, keepLast = 0, dryRun = false } = options;\n  const sessions = await listSessions(outputDir);\n\n  const deleted: string[] = [];\n  const kept: string[] = [];\n\n  // Sessions to keep based on keepLast\n  const keepIds = new Set(sessions.slice(0, keepLast).map(s => s.id));\n\n  // Calculate cutoff time if olderThan is specified\n  const cutoffTime = olderThan\n    ? Date.now() - parseDuration(olderThan)\n    : 0;\n\n  for (const session of sessions) {\n    const sessionTime = new Date(session.createdAt).getTime();\n    const shouldDelete = !keepIds.has(session.id) &&\n      (olderThan ? sessionTime < cutoffTime : true);\n\n    if (shouldDelete && !keepIds.has(session.id)) {\n      if (!dryRun) {\n        await deleteSession(outputDir, session.id);\n      }\n      deleted.push(session.id);\n    } else {\n      kept.push(session.id);\n    }\n  }\n\n  return { deleted, kept };\n}\n\n/**\n * Find sessions matching query criteria\n */\nexport async function findSessions(\n  outputDir: string,\n  query: Partial<SessionQuery> = {}\n): Promise<Session[]> {\n  // Validate query with defaults\n  const validatedQuery = SessionQuerySchema.parse({\n    limit: 50,\n    ...query,\n  });\n\n  const allSessions = await listSessions(outputDir);\n  let filtered = allSessions;\n\n  // Filter by route (extract path from URL)\n  if (validatedQuery.route) {\n    const routePattern = validatedQuery.route.toLowerCase();\n    filtered = filtered.filter(s => {\n      try {\n        const urlPath = new URL(s.url).pathname.toLowerCase();\n        return urlPath.includes(routePattern) || urlPath === routePattern;\n      } catch {\n        return s.url.toLowerCase().includes(routePattern);\n      }\n    });\n  }\n\n  // Filter by URL (exact or partial match)\n  if (validatedQuery.url) {\n    const urlPattern = validatedQuery.url.toLowerCase();\n    filtered = filtered.filter(s => s.url.toLowerCase().includes(urlPattern));\n  }\n\n  // Filter by status\n  if (validatedQuery.status) {\n    filtered = filtered.filter(s => s.status === validatedQuery.status);\n  }\n\n  // Filter by name\n  if (validatedQuery.name) {\n    const namePattern = validatedQuery.name.toLowerCase();\n    filtered = filtered.filter(s => s.name.toLowerCase().includes(namePattern));\n  }\n\n  // Filter by viewport\n  if (validatedQuery.viewport) {\n    const viewportPattern = validatedQuery.viewport.toLowerCase();\n    filtered = filtered.filter(s => s.viewport.name.toLowerCase() === viewportPattern);\n  }\n\n  // Filter by date range\n  if (validatedQuery.createdAfter) {\n    const afterTime = validatedQuery.createdAfter.getTime();\n    filtered = filtered.filter(s => new Date(s.createdAt).getTime() >= afterTime);\n  }\n\n  if (validatedQuery.createdBefore) {\n    const beforeTime = validatedQuery.createdBefore.getTime();\n    filtered = filtered.filter(s => new Date(s.createdAt).getTime() <= beforeTime);\n  }\n\n  // Apply limit\n  return filtered.slice(0, validatedQuery.limit);\n}\n\n/**\n * Get timeline of sessions for a specific route/URL\n * Returns sessions in chronological order (oldest first) for tracking changes over time\n */\nexport async function getTimeline(\n  outputDir: string,\n  route: string,\n  limit: number = 10\n): Promise<Session[]> {\n  const sessions = await findSessions(outputDir, { route, limit });\n  // Reverse to get chronological order (oldest first)\n  return sessions.reverse();\n}\n\n/**\n * Get sessions grouped by route\n */\nexport async function getSessionsByRoute(\n  outputDir: string\n): Promise<Record<string, Session[]>> {\n  const allSessions = await listSessions(outputDir);\n  const byRoute: Record<string, Session[]> = {};\n\n  for (const session of allSessions) {\n    let route: string;\n    try {\n      route = new URL(session.url).pathname;\n    } catch {\n      route = session.url;\n    }\n\n    if (!byRoute[route]) {\n      byRoute[route] = [];\n    }\n    byRoute[route].push(session);\n  }\n\n  return byRoute;\n}\n\n/**\n * Get session statistics\n */\nexport async function getSessionStats(outputDir: string): Promise<{\n  total: number;\n  byStatus: Record<string, number>;\n  byViewport: Record<string, number>;\n  byVerdict: Record<string, number>;\n}> {\n  const sessions = await listSessions(outputDir);\n\n  const byStatus: Record<string, number> = {};\n  const byViewport: Record<string, number> = {};\n  const byVerdict: Record<string, number> = {};\n\n  for (const session of sessions) {\n    // Count by status\n    byStatus[session.status] = (byStatus[session.status] || 0) + 1;\n\n    // Count by viewport\n    const viewportName = session.viewport.name;\n    byViewport[viewportName] = (byViewport[viewportName] || 0) + 1;\n\n    // Count by verdict\n    if (session.analysis?.verdict) {\n      byVerdict[session.analysis.verdict] = (byVerdict[session.analysis.verdict] || 0) + 1;\n    }\n  }\n\n  return {\n    total: sessions.length,\n    byStatus,\n    byViewport,\n    byVerdict,\n  };\n}\n","import type { Session, ComparisonResult, Analysis, ComparisonReport } from './schemas.js';\nimport { getSessionPaths } from './session.js';\n\n/**\n * Generate a full comparison report\n */\nexport function generateReport(\n  session: Session,\n  comparison: ComparisonResult,\n  analysis: Analysis,\n  outputDir: string,\n  webViewPort?: number\n): ComparisonReport {\n  const paths = getSessionPaths(outputDir, session.id);\n\n  const report: ComparisonReport = {\n    sessionId: session.id,\n    sessionName: session.name,\n    url: session.url,\n    timestamp: new Date().toISOString(),\n    viewport: session.viewport,\n    comparison,\n    analysis,\n    files: {\n      baseline: paths.baseline,\n      current: paths.current,\n      diff: paths.diff,\n    },\n  };\n\n  if (webViewPort) {\n    report.webViewUrl = `http://localhost:${webViewPort}/sessions/${session.id}`;\n  }\n\n  return report;\n}\n\n/**\n * Get verdict indicator (text-based, no emojis)\n */\nfunction getVerdictIndicator(verdict: string): { symbol: string; label: string } {\n  switch (verdict) {\n    case 'MATCH':\n      return { symbol: '[PASS]', label: 'No visual changes detected' };\n    case 'EXPECTED_CHANGE':\n      return { symbol: '[OK]  ', label: 'Changes detected, appear intentional' };\n    case 'UNEXPECTED_CHANGE':\n      return { symbol: '[WARN]', label: 'Unexpected changes - investigate' };\n    case 'LAYOUT_BROKEN':\n      return { symbol: '[FAIL]', label: 'Layout broken - fix required' };\n    default:\n      return { symbol: '[????]', label: 'Unknown verdict' };\n  }\n}\n\n/**\n * Format report as human-readable text\n */\nexport function formatReportText(report: ComparisonReport): string {\n  const lines: string[] = [];\n  const { symbol, label } = getVerdictIndicator(report.analysis.verdict);\n\n  // Verdict first - most important info\n  lines.push('');\n  lines.push(`${symbol} ${report.analysis.verdict} - ${label}`);\n  lines.push('');\n  lines.push(`Diff: ${report.comparison.diffPercent}% (${report.comparison.diffPixels.toLocaleString()} pixels)`);\n  lines.push('');\n  lines.push('---');\n  lines.push('');\n  lines.push(`Session: ${report.sessionName} (${report.sessionId})`);\n  lines.push(`URL: ${report.url}`);\n  lines.push(`Viewport: ${report.viewport.name} (${report.viewport.width}x${report.viewport.height})`);\n  lines.push('');\n  lines.push(`Summary: ${report.analysis.summary}`);\n\n  if (report.analysis.recommendation) {\n    lines.push('');\n    lines.push(`Recommendation: ${report.analysis.recommendation}`);\n  }\n\n  if (report.analysis.unexpectedChanges.length > 0) {\n    lines.push('');\n    lines.push('Unexpected Changes:');\n    for (const change of report.analysis.unexpectedChanges) {\n      lines.push(`  - ${change.location}: ${change.description}`);\n    }\n  }\n\n  lines.push('');\n  lines.push('Files:');\n  lines.push(`  Baseline: ${report.files.baseline}`);\n  lines.push(`  Current: ${report.files.current}`);\n  lines.push(`  Diff: ${report.files.diff}`);\n\n  if (report.webViewUrl) {\n    lines.push('');\n    lines.push(`View in browser: ${report.webViewUrl}`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format report as minimal output (for scripts)\n */\nexport function formatReportMinimal(report: ComparisonReport): string {\n  const status = report.comparison.match ? 'PASS' : 'FAIL';\n  return `${status} ${report.sessionId} ${report.analysis.verdict} ${report.comparison.diffPercent}%`;\n}\n\n/**\n * Format report as JSON\n */\nexport function formatReportJson(report: ComparisonReport): string {\n  return JSON.stringify(report, null, 2);\n}\n\n/**\n * Generate a summary line for session listing\n */\nexport function formatSessionSummary(session: Session): string {\n  const status = session.status.padEnd(8);\n  const viewport = `${session.viewport.name}`.padEnd(8);\n  const date = new Date(session.createdAt).toLocaleDateString();\n\n  let diffInfo = '';\n  if (session.comparison) {\n    diffInfo = session.comparison.match\n      ? ' (no diff)'\n      : ` (${session.comparison.diffPercent}% diff)`;\n  }\n\n  return `${session.id}  ${status}  ${viewport}  ${date}  ${session.name}${diffInfo}`;\n}\n","/**\n * Page State Detection\n *\n * Detects authentication state, loading state, and errors on a page.\n * Provides AI agents with actionable state information.\n */\n\nimport type { Page } from 'playwright';\n\nexport interface AuthState {\n  authenticated: boolean | null; // null = can't determine\n  confidence: number;\n  signals: string[];\n  username?: string; // If we can extract it\n}\n\nexport interface LoadingState {\n  loading: boolean;\n  type: 'spinner' | 'skeleton' | 'progress' | 'lazy' | 'none';\n  elements: number; // Count of loading indicators\n}\n\nexport interface ErrorState {\n  hasErrors: boolean;\n  errors: ErrorInfo[];\n  severity: 'none' | 'warning' | 'error' | 'critical';\n}\n\nexport interface ErrorInfo {\n  type: 'validation' | 'api' | 'permission' | 'notfound' | 'server' | 'network' | 'unknown';\n  message: string;\n  element?: string; // Selector hint\n}\n\nexport interface PageState {\n  auth: AuthState;\n  loading: LoadingState;\n  errors: ErrorState;\n  ready: boolean; // True if page is ready for interaction\n}\n\n/**\n * Detect authentication state from page signals\n */\nexport async function detectAuthState(page: Page): Promise<AuthState> {\n  const signals: string[] = [];\n  let authenticated: boolean | null = null;\n  let confidence = 0;\n  let username: string | undefined;\n\n  const checks = await page.evaluate(() => {\n    const doc = document;\n    const text = doc.body?.innerText?.toLowerCase() || '';\n\n    // Authenticated signals\n    const logoutButton = doc.querySelector(\n      'button:has-text(\"logout\"), button:has-text(\"sign out\"), ' +\n      'a:has-text(\"logout\"), a:has-text(\"sign out\"), ' +\n      '[class*=\"logout\"], [data-testid*=\"logout\"]'\n    );\n    const userMenu = doc.querySelector(\n      '[class*=\"user-menu\"], [class*=\"avatar\"], [class*=\"profile-menu\"], ' +\n      '[class*=\"account-menu\"], [data-testid*=\"user\"]'\n    );\n    const welcomeText = text.match(/welcome,?\\s+(\\w+)/i);\n    const userNameEl = doc.querySelector(\n      '[class*=\"username\"], [class*=\"user-name\"], [class*=\"display-name\"]'\n    );\n\n    // Not authenticated signals\n    const loginLink = doc.querySelector(\n      'a:has-text(\"login\"), a:has-text(\"sign in\"), ' +\n      'button:has-text(\"login\"), button:has-text(\"sign in\"), ' +\n      '[class*=\"login-link\"], [href*=\"/login\"], [href*=\"/signin\"]'\n    );\n    const signupLink = doc.querySelector(\n      'a:has-text(\"sign up\"), a:has-text(\"register\"), ' +\n      '[href*=\"/signup\"], [href*=\"/register\"]'\n    );\n\n    // Check for auth-gated content\n    const authRequired = doc.querySelector(\n      '[class*=\"auth-required\"], [class*=\"login-required\"], ' +\n      '[class*=\"protected\"]'\n    );\n\n    // Check cookies/localStorage hints (careful - limited access)\n    const hasAuthCookie = document.cookie.includes('auth') ||\n      document.cookie.includes('session') ||\n      document.cookie.includes('token');\n\n    return {\n      hasLogoutButton: !!logoutButton,\n      hasUserMenu: !!userMenu,\n      hasWelcomeText: !!welcomeText,\n      welcomeName: welcomeText?.[1],\n      hasUserNameElement: !!userNameEl,\n      userName: userNameEl?.textContent?.trim(),\n      hasLoginLink: !!loginLink,\n      hasSignupLink: !!signupLink,\n      hasAuthRequired: !!authRequired,\n      hasAuthCookie,\n    };\n  });\n\n  // Score authenticated signals\n  if (checks.hasLogoutButton) {\n    authenticated = true;\n    confidence += 40;\n    signals.push('logout button present');\n  }\n  if (checks.hasUserMenu) {\n    authenticated = true;\n    confidence += 30;\n    signals.push('user menu present');\n  }\n  if (checks.hasWelcomeText) {\n    authenticated = true;\n    confidence += 20;\n    signals.push('welcome text');\n    username = checks.welcomeName;\n  }\n  if (checks.hasUserNameElement) {\n    authenticated = true;\n    confidence += 15;\n    signals.push('username displayed');\n    username = username || checks.userName;\n  }\n  if (checks.hasAuthCookie) {\n    confidence += 10;\n    signals.push('auth cookie present');\n  }\n\n  // Score not authenticated signals\n  if (checks.hasLoginLink && !checks.hasLogoutButton) {\n    authenticated = false;\n    confidence += 30;\n    signals.push('login link visible');\n  }\n  if (checks.hasSignupLink && !checks.hasUserMenu) {\n    authenticated = false;\n    confidence += 20;\n    signals.push('signup link visible');\n  }\n  if (checks.hasAuthRequired) {\n    authenticated = false;\n    confidence += 25;\n    signals.push('auth-required message');\n  }\n\n  // Normalize confidence\n  confidence = Math.min(confidence / 100, 1);\n\n  // If no strong signals, we can't determine\n  if (confidence < 0.3) {\n    authenticated = null;\n  }\n\n  return {\n    authenticated,\n    confidence,\n    signals,\n    username,\n  };\n}\n\n/**\n * Detect loading state from page signals\n */\nexport async function detectLoadingState(page: Page): Promise<LoadingState> {\n  const checks = await page.evaluate(() => {\n    const doc = document;\n\n    // Spinner detection\n    const spinners = doc.querySelectorAll(\n      '[class*=\"spinner\"], [class*=\"loading\"], [class*=\"loader\"], ' +\n      '[role=\"progressbar\"][aria-busy=\"true\"], ' +\n      '.animate-spin, [class*=\"spin\"]'\n    );\n\n    // Skeleton detection\n    const skeletons = doc.querySelectorAll(\n      '[class*=\"skeleton\"], [class*=\"shimmer\"], [class*=\"placeholder\"], ' +\n      '[class*=\"pulse\"], [aria-busy=\"true\"]'\n    );\n\n    // Progress bar detection\n    const progress = doc.querySelectorAll(\n      'progress, [role=\"progressbar\"], [class*=\"progress-bar\"], ' +\n      '[class*=\"loading-bar\"]'\n    );\n\n    // Lazy loading detection\n    const lazyImages = doc.querySelectorAll(\n      'img[loading=\"lazy\"]:not([src]), [class*=\"lazy\"]:not([src])'\n    );\n\n    // Check if body has loading class\n    const bodyLoading = doc.body?.classList.contains('loading') ||\n      doc.body?.getAttribute('aria-busy') === 'true';\n\n    return {\n      spinnerCount: spinners.length,\n      skeletonCount: skeletons.length,\n      progressCount: progress.length,\n      lazyCount: lazyImages.length,\n      bodyLoading,\n    };\n  });\n\n  // Determine loading type\n  let type: LoadingState['type'] = 'none';\n  let elements = 0;\n  let loading = false;\n\n  if (checks.spinnerCount > 0) {\n    type = 'spinner';\n    elements = checks.spinnerCount;\n    loading = true;\n  } else if (checks.skeletonCount > 0) {\n    type = 'skeleton';\n    elements = checks.skeletonCount;\n    loading = true;\n  } else if (checks.progressCount > 0) {\n    type = 'progress';\n    elements = checks.progressCount;\n    loading = true;\n  } else if (checks.lazyCount > 0) {\n    type = 'lazy';\n    elements = checks.lazyCount;\n    loading = true;\n  } else if (checks.bodyLoading) {\n    type = 'spinner';\n    loading = true;\n  }\n\n  return { loading, type, elements };\n}\n\n/**\n * Detect error state from page signals\n */\nexport async function detectErrorState(page: Page): Promise<ErrorState> {\n  const errors: ErrorInfo[] = [];\n\n  const checks = await page.evaluate(() => {\n    const doc = document;\n    const text = doc.body?.innerText || '';\n\n    // Validation errors\n    const validationErrors = doc.querySelectorAll(\n      '[class*=\"error\"]:not([class*=\"error-boundary\"]), ' +\n      '[class*=\"invalid\"], [aria-invalid=\"true\"], ' +\n      '.field-error, .form-error, .validation-error'\n    );\n\n    // API/Server errors\n    const apiErrors = doc.querySelectorAll(\n      '[class*=\"api-error\"], [class*=\"server-error\"], ' +\n      '[class*=\"fetch-error\"], [class*=\"network-error\"]'\n    );\n\n    // Permission errors\n    const permissionText = text.match(/access denied|forbidden|unauthorized|not allowed/i);\n\n    // 404 errors\n    const notFoundText = text.match(/not found|404|page doesn't exist|no longer available/i);\n\n    // Server errors\n    const serverText = text.match(/500|server error|something went wrong|internal error/i);\n\n    // Toast/notification errors\n    const toastErrors = doc.querySelectorAll(\n      '[class*=\"toast\"][class*=\"error\"], [class*=\"notification\"][class*=\"error\"], ' +\n      '[role=\"alert\"][class*=\"error\"], [class*=\"snackbar\"][class*=\"error\"]'\n    );\n\n    // Extract error messages\n    const extractText = (el: Element) => el.textContent?.trim().slice(0, 200) || '';\n\n    return {\n      validationErrors: Array.from(validationErrors).map(extractText).filter(Boolean),\n      apiErrors: Array.from(apiErrors).map(extractText).filter(Boolean),\n      toastErrors: Array.from(toastErrors).map(extractText).filter(Boolean),\n      hasPermissionError: !!permissionText,\n      hasNotFoundError: !!notFoundText,\n      hasServerError: !!serverText,\n    };\n  });\n\n  // Build error list\n  if (checks.hasPermissionError) {\n    errors.push({\n      type: 'permission',\n      message: 'Access denied or unauthorized',\n    });\n  }\n\n  if (checks.hasNotFoundError) {\n    errors.push({\n      type: 'notfound',\n      message: 'Page or resource not found',\n    });\n  }\n\n  if (checks.hasServerError) {\n    errors.push({\n      type: 'server',\n      message: 'Server error occurred',\n    });\n  }\n\n  for (const msg of checks.validationErrors) {\n    errors.push({\n      type: 'validation',\n      message: msg,\n    });\n  }\n\n  for (const msg of checks.apiErrors) {\n    errors.push({\n      type: 'api',\n      message: msg,\n    });\n  }\n\n  for (const msg of checks.toastErrors) {\n    errors.push({\n      type: 'unknown',\n      message: msg,\n    });\n  }\n\n  // Determine severity\n  let severity: ErrorState['severity'] = 'none';\n  if (errors.length > 0) {\n    const hasCritical = errors.some(e =>\n      e.type === 'server' || e.type === 'permission'\n    );\n    const hasError = errors.some(e =>\n      e.type === 'api' || e.type === 'notfound'\n    );\n    const hasWarning = errors.some(e => e.type === 'validation');\n\n    if (hasCritical) severity = 'critical';\n    else if (hasError) severity = 'error';\n    else if (hasWarning) severity = 'warning';\n  }\n\n  return {\n    hasErrors: errors.length > 0,\n    errors,\n    severity,\n  };\n}\n\n/**\n * Detect full page state\n */\nexport async function detectPageState(page: Page): Promise<PageState> {\n  const [auth, loading, errors] = await Promise.all([\n    detectAuthState(page),\n    detectLoadingState(page),\n    detectErrorState(page),\n  ]);\n\n  // Page is ready if not loading and no critical errors\n  const ready = !loading.loading &&\n    errors.severity !== 'critical' &&\n    errors.severity !== 'error';\n\n  return {\n    auth,\n    loading,\n    errors,\n    ready,\n  };\n}\n\n/**\n * Wait for page to be ready (not loading, no errors)\n */\nexport async function waitForPageReady(\n  page: Page,\n  options: { timeout?: number; ignoreErrors?: boolean } = {}\n): Promise<PageState> {\n  const { timeout = 10000, ignoreErrors = false } = options;\n  const startTime = Date.now();\n\n  while (Date.now() - startTime < timeout) {\n    const state = await detectPageState(page);\n\n    if (!state.loading.loading) {\n      if (ignoreErrors || !state.errors.hasErrors) {\n        return state;\n      }\n    }\n\n    // Wait a bit before checking again\n    await page.waitForTimeout(200);\n  }\n\n  // Return final state even if not ready\n  return detectPageState(page);\n}\n","/**\n * Semantic Output Formatter\n *\n * Transforms raw page data into AI-friendly semantic output.\n * Provides verdicts, recommendations, and recovery hints.\n */\n\nimport type { Page } from 'playwright';\nimport { classifyPageIntent, type PageIntent, type PageIntentResult } from './page-intent.js';\nimport { detectPageState, type PageState } from './state-detector.js';\n\nexport type SemanticVerdict = 'PASS' | 'ISSUES' | 'FAIL' | 'LOADING' | 'ERROR';\n\nexport interface SemanticIssue {\n  severity: 'critical' | 'major' | 'minor';\n  type: string;\n  element?: string;      // Human-readable description or selector\n  problem: string;\n  fix: string;\n}\n\nexport interface AvailableAction {\n  action: string;        // e.g., 'login', 'search', 'submit'\n  selector?: string;     // Best selector to use\n  description: string;   // What this action does\n}\n\nexport interface RecoveryHint {\n  suggestion: string;\n  alternatives?: string[];\n  waitFor?: string;      // Selector to wait for\n}\n\nexport interface SemanticResult {\n  // Primary verdict for decision loops\n  verdict: SemanticVerdict;\n  confidence: number;\n\n  // Page understanding\n  pageIntent: PageIntentResult;\n  state: PageState;\n\n  // What can be done on this page\n  availableActions: AvailableAction[];\n\n  // Issues found (if any)\n  issues: SemanticIssue[];\n\n  // Recovery suggestions (if failed)\n  recovery?: RecoveryHint;\n\n  // Summary for AI reasoning\n  summary: string;\n\n  // Raw data for advanced use\n  url: string;\n  title: string;\n  timestamp: string;\n}\n\n/**\n * Get semantic understanding of a page\n */\nexport async function getSemanticOutput(page: Page): Promise<SemanticResult> {\n  // Get page basics\n  const url = page.url();\n  const title = await page.title();\n  const timestamp = new Date().toISOString();\n\n  // Run semantic analysis in parallel\n  const [pageIntent, state] = await Promise.all([\n    classifyPageIntent(page),\n    detectPageState(page),\n  ]);\n\n  // Detect available actions based on intent\n  const availableActions = await detectAvailableActions(page, pageIntent.intent);\n\n  // Collect issues\n  const issues = collectIssues(state, pageIntent);\n\n  // Determine verdict\n  const verdict = determineVerdict(state, issues);\n\n  // Generate recovery hints if needed\n  const recovery = verdict === 'FAIL' || verdict === 'ERROR'\n    ? generateRecoveryHint(state, pageIntent.intent)\n    : undefined;\n\n  // Generate summary\n  const summary = generateSummary(pageIntent, state, verdict, issues.length);\n\n  return {\n    verdict,\n    confidence: pageIntent.confidence,\n    pageIntent,\n    state,\n    availableActions,\n    issues,\n    recovery,\n    summary,\n    url,\n    title,\n    timestamp,\n  };\n}\n\n/**\n * Detect available actions based on page intent\n */\nasync function detectAvailableActions(\n  page: Page,\n  intent: PageIntent\n): Promise<AvailableAction[]> {\n  const actions: AvailableAction[] = [];\n\n  const checks = await page.evaluate(() => {\n    const doc = document;\n\n    // Form actions\n    const submitButton = doc.querySelector('button[type=\"submit\"], input[type=\"submit\"]');\n    const searchInput = doc.querySelector('input[type=\"search\"], input[name*=\"search\"], input[placeholder*=\"search\"]');\n    const loginForm = doc.querySelector('form input[type=\"password\"]');\n\n    // Navigation actions\n    const mainNav = doc.querySelector('nav a, header a');\n    const backButton = doc.querySelector('a:has-text(\"back\"), button:has-text(\"back\")');\n\n    // Content actions\n    const addButton = doc.querySelector('button:has-text(\"add\"), button:has-text(\"create\"), button:has-text(\"new\")');\n    const editButton = doc.querySelector('button:has-text(\"edit\"), a:has-text(\"edit\")');\n    const deleteButton = doc.querySelector('button:has-text(\"delete\"), button:has-text(\"remove\")');\n\n    // List actions\n    const filterSelect = doc.querySelector('select[name*=\"filter\"], [class*=\"filter\"] select');\n    const sortSelect = doc.querySelector('select[name*=\"sort\"], [class*=\"sort\"] select');\n    const pagination = doc.querySelector('[class*=\"pagination\"] a, [class*=\"pager\"] button');\n\n    return {\n      hasSubmit: !!submitButton,\n      submitSelector: submitButton ? getSelector(submitButton) : null,\n      hasSearch: !!searchInput,\n      searchSelector: searchInput ? getSelector(searchInput) : null,\n      hasLogin: !!loginForm,\n      hasNav: !!mainNav,\n      hasBack: !!backButton,\n      hasAdd: !!addButton,\n      addSelector: addButton ? getSelector(addButton) : null,\n      hasEdit: !!editButton,\n      hasDelete: !!deleteButton,\n      hasFilter: !!filterSelect,\n      hasSort: !!sortSelect,\n      hasPagination: !!pagination,\n    };\n\n    function getSelector(el: Element): string {\n      if (el.id) return `#${el.id}`;\n      if (el.getAttribute('data-testid')) return `[data-testid=\"${el.getAttribute('data-testid')}\"]`;\n      if (el.className) return `.${el.className.split(' ')[0]}`;\n      return el.tagName.toLowerCase();\n    }\n  });\n\n  // Build actions based on intent and available elements\n  if (intent === 'auth' && checks.hasLogin) {\n    actions.push({\n      action: 'login',\n      selector: 'form',\n      description: 'Submit login credentials',\n    });\n  }\n\n  if (checks.hasSearch) {\n    actions.push({\n      action: 'search',\n      selector: checks.searchSelector || 'input[type=\"search\"]',\n      description: 'Search for content',\n    });\n  }\n\n  if (checks.hasSubmit && intent !== 'auth') {\n    actions.push({\n      action: 'submit',\n      selector: checks.submitSelector || 'button[type=\"submit\"]',\n      description: 'Submit form',\n    });\n  }\n\n  if (checks.hasAdd) {\n    actions.push({\n      action: 'create',\n      selector: checks.addSelector || 'button:has-text(\"add\")',\n      description: 'Create new item',\n    });\n  }\n\n  if (intent === 'listing') {\n    if (checks.hasFilter) {\n      actions.push({\n        action: 'filter',\n        description: 'Filter results',\n      });\n    }\n    if (checks.hasSort) {\n      actions.push({\n        action: 'sort',\n        description: 'Sort results',\n      });\n    }\n    if (checks.hasPagination) {\n      actions.push({\n        action: 'paginate',\n        description: 'Navigate to next/previous page',\n      });\n    }\n  }\n\n  if (checks.hasBack) {\n    actions.push({\n      action: 'back',\n      description: 'Go back to previous page',\n    });\n  }\n\n  return actions;\n}\n\n/**\n * Collect issues from page state\n */\nfunction collectIssues(state: PageState, intent: PageIntentResult): SemanticIssue[] {\n  const issues: SemanticIssue[] = [];\n\n  // Add error-based issues\n  for (const error of state.errors.errors) {\n    issues.push({\n      severity: error.type === 'server' || error.type === 'permission' ? 'critical' : 'major',\n      type: error.type,\n      problem: error.message,\n      fix: getErrorFix(error.type),\n    });\n  }\n\n  // Add loading issues if taking too long\n  if (state.loading.loading && state.loading.elements > 3) {\n    issues.push({\n      severity: 'minor',\n      type: 'slow-loading',\n      problem: `Page has ${state.loading.elements} loading indicators`,\n      fix: 'Wait for content to load or check network',\n    });\n  }\n\n  // Add auth issues\n  if (state.auth.authenticated === false && intent.intent === 'dashboard') {\n    issues.push({\n      severity: 'major',\n      type: 'auth-required',\n      problem: 'Dashboard requires authentication',\n      fix: 'Login first before accessing this page',\n    });\n  }\n\n  return issues;\n}\n\nfunction getErrorFix(errorType: string): string {\n  const fixes: Record<string, string> = {\n    validation: 'Fix the highlighted form fields',\n    api: 'Retry the request or check API status',\n    permission: 'Login with appropriate permissions',\n    notfound: 'Check the URL or navigate to a valid page',\n    server: 'Wait and retry, or contact support',\n    network: 'Check internet connection',\n    unknown: 'Investigate the error message',\n  };\n  return fixes[errorType] || 'Investigate the issue';\n}\n\n/**\n * Determine overall verdict\n */\nfunction determineVerdict(state: PageState, issues: SemanticIssue[]): SemanticVerdict {\n  // Check for critical issues first\n  const hasCritical = issues.some(i => i.severity === 'critical');\n  if (hasCritical) return 'ERROR';\n\n  // Check for loading state\n  if (state.loading.loading) return 'LOADING';\n\n  // Check for errors\n  if (state.errors.hasErrors) return 'FAIL';\n\n  // Check for major issues\n  const hasMajor = issues.some(i => i.severity === 'major');\n  if (hasMajor) return 'ISSUES';\n\n  // All good\n  return 'PASS';\n}\n\n/**\n * Generate recovery hints for failed states\n */\nfunction generateRecoveryHint(state: PageState, _intent: PageIntent): RecoveryHint {\n  // Auth issues\n  if (state.auth.authenticated === false) {\n    return {\n      suggestion: 'Login to access this page',\n      alternatives: ['Use ibr.flow.login()', 'Navigate to /login first'],\n      waitFor: '[class*=\"user\"], [class*=\"avatar\"]',\n    };\n  }\n\n  // Server errors\n  if (state.errors.errors.some(e => e.type === 'server')) {\n    return {\n      suggestion: 'Server error - wait and retry',\n      alternatives: ['Refresh the page', 'Check server status'],\n    };\n  }\n\n  // Not found errors\n  if (state.errors.errors.some(e => e.type === 'notfound')) {\n    return {\n      suggestion: 'Page not found - check URL',\n      alternatives: ['Navigate to homepage', 'Use search to find content'],\n    };\n  }\n\n  // Loading issues\n  if (state.loading.loading) {\n    return {\n      suggestion: 'Wait for page to finish loading',\n      waitFor: state.loading.type === 'skeleton'\n        ? ':not([class*=\"skeleton\"])'\n        : ':not([class*=\"loading\"])',\n    };\n  }\n\n  // Default\n  return {\n    suggestion: 'Investigate the page state and retry',\n  };\n}\n\n/**\n * Generate human-readable summary\n */\nfunction generateSummary(\n  intent: PageIntentResult,\n  state: PageState,\n  verdict: SemanticVerdict,\n  issueCount: number\n): string {\n  const parts: string[] = [];\n\n  // Intent\n  parts.push(`${intent.intent} page`);\n\n  // Confidence\n  if (intent.confidence < 0.5) {\n    parts.push('(low confidence)');\n  }\n\n  // Auth state\n  if (state.auth.authenticated === true) {\n    parts.push(`authenticated${state.auth.username ? ` as ${state.auth.username}` : ''}`);\n  } else if (state.auth.authenticated === false) {\n    parts.push('not authenticated');\n  }\n\n  // Loading\n  if (state.loading.loading) {\n    parts.push(`loading (${state.loading.type})`);\n  }\n\n  // Verdict\n  if (verdict === 'PASS') {\n    parts.push('ready for interaction');\n  } else if (verdict === 'ISSUES') {\n    parts.push(`${issueCount} issue${issueCount > 1 ? 's' : ''} detected`);\n  } else if (verdict === 'ERROR' || verdict === 'FAIL') {\n    parts.push(`${issueCount} error${issueCount > 1 ? 's' : ''}`);\n  }\n\n  return parts.join(', ');\n}\n\n/**\n * Format semantic result as concise text for AI consumption\n */\nexport function formatSemanticText(result: SemanticResult): string {\n  const lines: string[] = [];\n\n  lines.push(`Verdict: ${result.verdict}`);\n  lines.push(`Page: ${result.pageIntent.intent} (${Math.round(result.confidence * 100)}% confidence)`);\n  lines.push(`Summary: ${result.summary}`);\n\n  if (result.state.auth.authenticated !== null) {\n    lines.push(`Auth: ${result.state.auth.authenticated ? 'logged in' : 'logged out'}`);\n  }\n\n  if (result.availableActions.length > 0) {\n    lines.push(`Actions: ${result.availableActions.map(a => a.action).join(', ')}`);\n  }\n\n  if (result.issues.length > 0) {\n    lines.push(`Issues: ${result.issues.map(i => i.problem).join('; ')}`);\n  }\n\n  if (result.recovery) {\n    lines.push(`Recovery: ${result.recovery.suggestion}`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format semantic result as JSON for structured consumption\n */\nexport function formatSemanticJson(result: SemanticResult): string {\n  // Return a cleaned version with just the essential fields\n  return JSON.stringify({\n    verdict: result.verdict,\n    intent: result.pageIntent.intent,\n    confidence: result.confidence,\n    authenticated: result.state.auth.authenticated,\n    loading: result.state.loading.loading,\n    ready: result.state.ready,\n    actions: result.availableActions.map(a => a.action),\n    issues: result.issues.map(i => ({ severity: i.severity, problem: i.problem })),\n    recovery: result.recovery?.suggestion,\n  }, null, 2);\n}\n","/**\n * Flow Types\n *\n * Common types used across all built-in flows.\n */\n\nimport type { Page } from 'playwright';\n\nexport interface FlowStep {\n  action: string;\n  success: boolean;\n  duration?: number;\n  error?: string;\n}\n\nexport interface FlowResult {\n  success: boolean;\n  steps: FlowStep[];\n  error?: string;\n  /** Time taken in ms */\n  duration: number;\n}\n\nexport interface FlowOptions {\n  /** Timeout for the entire flow in ms */\n  timeout?: number;\n  /** Whether to take screenshots at each step */\n  debug?: boolean;\n}\n\n/**\n * Find a form field by common label patterns\n */\nexport async function findFieldByLabel(\n  page: Page,\n  labels: string[]\n): Promise<ReturnType<Page['$']>> {\n  for (const label of labels) {\n    // Try various selector patterns\n    const selectors = [\n      `input[name*=\"${label}\" i]`,\n      `input[id*=\"${label}\" i]`,\n      `input[placeholder*=\"${label}\" i]`,\n      `input[aria-label*=\"${label}\" i]`,\n      `label:has-text(\"${label}\") + input`,\n      `label:has-text(\"${label}\") input`,\n    ];\n\n    for (const selector of selectors) {\n      const element = await page.$(selector);\n      if (element) return element;\n    }\n  }\n  return null;\n}\n\n/**\n * Find a button by common patterns\n */\nexport async function findButton(\n  page: Page,\n  patterns: string[]\n): Promise<ReturnType<Page['$']>> {\n  for (const pattern of patterns) {\n    const selectors = [\n      `button:has-text(\"${pattern}\")`,\n      `input[type=\"submit\"][value*=\"${pattern}\" i]`,\n      `button[type=\"submit\"]:has-text(\"${pattern}\")`,\n      `a:has-text(\"${pattern}\")`,\n      `[role=\"button\"]:has-text(\"${pattern}\")`,\n    ];\n\n    for (const selector of selectors) {\n      const element = await page.$(selector);\n      if (element) return element;\n    }\n  }\n\n  // Fallback to generic submit button\n  return page.$('button[type=\"submit\"], input[type=\"submit\"]');\n}\n\n/**\n * Wait for navigation or network idle\n */\nexport async function waitForNavigation(\n  page: Page,\n  timeout = 10000\n): Promise<void> {\n  try {\n    await Promise.race([\n      page.waitForNavigation({ timeout }),\n      page.waitForLoadState('networkidle', { timeout }),\n    ]);\n  } catch {\n    // Timeout is acceptable - page might not navigate\n  }\n}\n\n// =============================================================================\n// AI Search Testing Types\n// =============================================================================\n\n/**\n * Screenshot captured at a specific step during search flow\n */\nexport interface StepScreenshot {\n  /** Which step this screenshot was taken at */\n  step: 'before' | 'after-query' | 'loading' | 'results';\n  /** Path to the screenshot file */\n  path: string;\n  /** ISO timestamp when captured */\n  timestamp: string;\n  /** Milliseconds since flow start */\n  timing: number;\n}\n\n/**\n * Extracted content from a single search result element\n */\nexport interface ExtractedResult {\n  /** Zero-based index in result list */\n  index: number;\n  /** Title text if identifiable */\n  title?: string;\n  /** Snippet/description text if present */\n  snippet?: string;\n  /** Full text content of the result element */\n  fullText: string;\n  /** CSS selector to locate this element */\n  selector: string;\n  /** Whether the element is visible in viewport */\n  visible: boolean;\n}\n\n/**\n * Timing breakdown for search flow phases\n */\nexport interface SearchTiming {\n  /** Total flow duration in ms */\n  total: number;\n  /** Time spent typing the query */\n  typing: number;\n  /** Time waiting for results to load */\n  waiting: number;\n  /** Time for results to render after load */\n  rendering: number;\n}\n\n/**\n * Extended options for AI search testing\n */\nexport interface AISearchOptions extends FlowOptions {\n  /** Search query to execute */\n  query: string;\n  /** CSS selector for search results container */\n  resultsSelector?: string;\n  /** Whether to submit the form or just type (for autocomplete) */\n  submit?: boolean;\n  /** Capture screenshots at each step (default: true) */\n  captureSteps?: boolean;\n  /** Extract text content from results (default: true) */\n  extractContent?: boolean;\n  /** User's intent for validation (what they expect to find) */\n  userIntent?: string;\n  /** Session directory for storing screenshots */\n  sessionDir?: string;\n}\n\n/**\n * Extended result from AI search flow with full context for validation\n */\nexport interface AISearchResult extends FlowResult {\n  /** The search query that was executed */\n  query: string;\n  /** User's stated intent for validation */\n  userIntent?: string;\n  /** Number of results found */\n  resultCount: number;\n  /** Whether any results were found */\n  hasResults: boolean;\n  /** Timing breakdown for each phase */\n  timing: SearchTiming;\n  /** Screenshots captured at each step */\n  screenshots: StepScreenshot[];\n  /** Extracted content from result elements */\n  extractedResults: ExtractedResult[];\n  /** Directory where search artifacts are stored */\n  artifactDir?: string;\n}\n","/**\n * Login Flow\n *\n * Handles common login patterns with semantic field detection.\n */\n\nimport type { Page } from 'playwright';\nimport { findFieldByLabel, findButton, waitForNavigation, type FlowResult, type FlowStep, type FlowOptions } from './types.js';\nimport { detectAuthState } from '../semantic/state-detector.js';\n\nexport interface FlowLoginOptions extends FlowOptions {\n  /** Email or username */\n  email: string;\n  /** Password */\n  password: string;\n  /** What indicates successful login (intent like 'dashboard' or selector) */\n  successIndicator?: string;\n  /** Whether to check \"remember me\" if present */\n  rememberMe?: boolean;\n}\n\nexport interface LoginResult extends FlowResult {\n  /** Whether user is now authenticated */\n  authenticated: boolean;\n  /** Detected username after login */\n  username?: string;\n}\n\n/**\n * Execute login flow\n */\nexport async function loginFlow(\n  page: Page,\n  options: FlowLoginOptions\n): Promise<LoginResult> {\n  const startTime = Date.now();\n  const steps: FlowStep[] = [];\n  const timeout = options.timeout || 30000;\n\n  try {\n    // Step 1: Find email/username field\n    const emailField = await findFieldByLabel(page, [\n      'email',\n      'username',\n      'login',\n      'user',\n      'mail',\n    ]);\n\n    if (!emailField) {\n      return {\n        success: false,\n        authenticated: false,\n        steps,\n        error: 'Could not find email/username field',\n        duration: Date.now() - startTime,\n      };\n    }\n\n    await emailField.fill(options.email);\n    steps.push({ action: 'fill email/username', success: true });\n\n    // Step 2: Find password field\n    const passwordField = await page.$('input[type=\"password\"]');\n\n    if (!passwordField) {\n      return {\n        success: false,\n        authenticated: false,\n        steps,\n        error: 'Could not find password field',\n        duration: Date.now() - startTime,\n      };\n    }\n\n    await passwordField.fill(options.password);\n    steps.push({ action: 'fill password', success: true });\n\n    // Step 3: Handle remember me (optional)\n    if (options.rememberMe) {\n      const rememberCheckbox = await page.$(\n        'input[type=\"checkbox\"][name*=\"remember\"], ' +\n        'input[type=\"checkbox\"][id*=\"remember\"], ' +\n        'label:has-text(\"remember\") input[type=\"checkbox\"]'\n      );\n      if (rememberCheckbox) {\n        await rememberCheckbox.check();\n        steps.push({ action: 'check remember me', success: true });\n      }\n    }\n\n    // Step 4: Find and click submit button\n    const submitButton = await findButton(page, [\n      'login',\n      'sign in',\n      'log in',\n      'submit',\n      'continue',\n    ]);\n\n    if (!submitButton) {\n      return {\n        success: false,\n        authenticated: false,\n        steps,\n        error: 'Could not find submit button',\n        duration: Date.now() - startTime,\n      };\n    }\n\n    await submitButton.click();\n    steps.push({ action: 'click submit', success: true });\n\n    // Step 5: Wait for navigation/response\n    await waitForNavigation(page, timeout);\n    steps.push({ action: 'wait for response', success: true });\n\n    // Step 6: Verify authentication\n    const authState = await detectAuthState(page);\n    const authenticated = authState.authenticated === true;\n\n    // Check for success indicator if provided\n    let successVerified = authenticated;\n    if (options.successIndicator && authenticated) {\n      // Check if it's a selector or an intent\n      if (options.successIndicator.startsWith('.') ||\n          options.successIndicator.startsWith('#') ||\n          options.successIndicator.startsWith('[')) {\n        // It's a selector\n        const indicator = await page.$(options.successIndicator);\n        successVerified = !!indicator;\n      }\n      // For intents, we'd need to check page intent - simplified for now\n    }\n\n    steps.push({\n      action: 'verify authentication',\n      success: successVerified,\n    });\n\n    return {\n      success: successVerified,\n      authenticated: successVerified,\n      username: authState.username,\n      steps,\n      duration: Date.now() - startTime,\n    };\n\n  } catch (error) {\n    return {\n      success: false,\n      authenticated: false,\n      steps,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      duration: Date.now() - startTime,\n    };\n  }\n}\n","/**\n * Search Flow\n *\n * Handles common search patterns with result detection.\n * Includes AI-powered search testing with step screenshots and content extraction.\n */\n\nimport type { Page } from 'playwright';\nimport { writeFile, mkdir } from 'fs/promises';\nimport { join } from 'path';\nimport {\n  findFieldByLabel,\n  waitForNavigation,\n  type FlowResult,\n  type FlowStep,\n  type FlowOptions,\n  type AISearchOptions,\n  type AISearchResult,\n  type StepScreenshot,\n  type ExtractedResult,\n  type SearchTiming,\n} from './types.js';\n\nexport interface FlowSearchOptions extends FlowOptions {\n  /** Search query */\n  query: string;\n  /** Selector for search results container */\n  resultsSelector?: string;\n  /** Whether to submit the form or just type (for autocomplete) */\n  submit?: boolean;\n}\n\nexport interface SearchResult extends FlowResult {\n  /** Number of results found */\n  resultCount: number;\n  /** Whether results were found */\n  hasResults: boolean;\n}\n\n/**\n * Execute search flow\n */\nexport async function searchFlow(\n  page: Page,\n  options: FlowSearchOptions\n): Promise<SearchResult> {\n  const startTime = Date.now();\n  const steps: FlowStep[] = [];\n  const timeout = options.timeout || 10000;\n\n  try {\n    // Step 1: Find search input\n    const searchInput = await findFieldByLabel(page, [\n      'search',\n      'query',\n      'q',\n      'find',\n    ]);\n\n    // Also try common search input patterns\n    const searchField = searchInput || await page.$(\n      'input[type=\"search\"], ' +\n      'input[name=\"q\"], ' +\n      'input[name=\"query\"], ' +\n      'input[placeholder*=\"search\" i], ' +\n      '[role=\"searchbox\"]'\n    );\n\n    if (!searchField) {\n      return {\n        success: false,\n        resultCount: 0,\n        hasResults: false,\n        steps,\n        error: 'Could not find search input',\n        duration: Date.now() - startTime,\n      };\n    }\n\n    // Clear existing content and type query\n    await searchField.fill('');\n    await searchField.fill(options.query);\n    steps.push({ action: `type \"${options.query}\"`, success: true });\n\n    // Step 2: Submit if requested (default true)\n    if (options.submit !== false) {\n      // Try pressing Enter first\n      await searchField.press('Enter');\n      steps.push({ action: 'submit search', success: true });\n\n      // Wait for results\n      await waitForNavigation(page, timeout);\n      steps.push({ action: 'wait for results', success: true });\n    } else {\n      // Just wait for autocomplete\n      await page.waitForTimeout(500);\n      steps.push({ action: 'wait for autocomplete', success: true });\n    }\n\n    // Step 3: Count results\n    const resultsSelector = options.resultsSelector ||\n      '[class*=\"result\"], [class*=\"item\"], [class*=\"card\"], ' +\n      '[data-testid*=\"result\"], li[class*=\"search\"]';\n\n    const results = await page.$$(resultsSelector);\n    const resultCount = results.length;\n    const hasResults = resultCount > 0;\n\n    // Check for empty state\n    const emptyState = await page.$(\n      '[class*=\"no-results\"], [class*=\"empty\"], ' +\n      ':has-text(\"no results\"), :has-text(\"nothing found\")'\n    );\n\n    steps.push({\n      action: `found ${resultCount} results`,\n      success: hasResults || !!emptyState,\n    });\n\n    return {\n      success: true,\n      resultCount,\n      hasResults,\n      steps,\n      duration: Date.now() - startTime,\n    };\n\n  } catch (error) {\n    return {\n      success: false,\n      resultCount: 0,\n      hasResults: false,\n      steps,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      duration: Date.now() - startTime,\n    };\n  }\n}\n\n// =============================================================================\n// AI Search Flow - Enhanced search with screenshots, timing, and content extraction\n// =============================================================================\n\n/**\n * Capture a screenshot at a specific step\n */\nasync function captureStepScreenshot(\n  page: Page,\n  step: StepScreenshot['step'],\n  artifactDir: string,\n  startTime: number\n): Promise<StepScreenshot> {\n  const timestamp = new Date().toISOString();\n  const timing = Date.now() - startTime;\n  const stepNum = { before: '01', 'after-query': '02', loading: '03', results: '04' }[step];\n  const filename = `${stepNum}-${step}.png`;\n  const path = join(artifactDir, filename);\n\n  // Disable animations before screenshot\n  await page.addStyleTag({\n    content: `\n      *, *::before, *::after {\n        animation-duration: 0s !important;\n        animation-delay: 0s !important;\n        transition-duration: 0s !important;\n        transition-delay: 0s !important;\n      }\n    `,\n  });\n\n  await page.screenshot({\n    path,\n    fullPage: false,\n    type: 'png',\n  });\n\n  return { step, path, timestamp, timing };\n}\n\n/**\n * Extract content from search result elements\n */\nasync function extractResultContent(\n  page: Page,\n  resultsSelector: string\n): Promise<ExtractedResult[]> {\n  return page.evaluate((selector) => {\n    const elements = document.querySelectorAll(selector);\n    const results: ExtractedResult[] = [];\n\n    elements.forEach((el, index) => {\n      const htmlEl = el as HTMLElement;\n      const rect = htmlEl.getBoundingClientRect();\n\n      // Try to identify title (usually in h1-h6, strong, or first bold text)\n      const titleEl = htmlEl.querySelector('h1, h2, h3, h4, h5, h6, strong, b, [class*=\"title\"]');\n      const title = titleEl?.textContent?.trim();\n\n      // Try to identify snippet/description\n      const snippetEl = htmlEl.querySelector('p, [class*=\"snippet\"], [class*=\"description\"], [class*=\"summary\"]');\n      const snippet = snippetEl?.textContent?.trim();\n\n      // Get full text content\n      const fullText = htmlEl.textContent?.trim() || '';\n\n      // Generate a unique selector for this element\n      let selector = el.tagName.toLowerCase();\n      if (el.id) {\n        selector = `#${el.id}`;\n      } else if (el.className && typeof el.className === 'string') {\n        const classes = el.className.split(' ').filter(c => c.trim())[0];\n        if (classes) selector += `.${classes}`;\n        selector += `:nth-of-type(${index + 1})`;\n      }\n\n      results.push({\n        index,\n        title: title || undefined,\n        snippet: snippet || undefined,\n        fullText: fullText.slice(0, 500), // Limit length\n        selector,\n        visible: rect.top >= 0 && rect.top < window.innerHeight,\n      });\n    });\n\n    return results;\n  }, resultsSelector);\n}\n\n/**\n * Execute AI-enhanced search flow with screenshots and content extraction\n *\n * This function extends the basic search flow with:\n * - Step-by-step screenshots (before, after-query, results)\n * - Detailed timing breakdown\n * - Extraction of result content for AI validation\n * - User intent tracking for relevance checking\n */\nexport async function aiSearchFlow(\n  page: Page,\n  options: AISearchOptions\n): Promise<AISearchResult> {\n  const startTime = Date.now();\n  const steps: FlowStep[] = [];\n  const screenshots: StepScreenshot[] = [];\n  const timeout = options.timeout || 10000;\n  const captureSteps = options.captureSteps !== false;\n  const extractContent = options.extractContent !== false;\n\n  // Timing breakdown\n  const timing: SearchTiming = {\n    total: 0,\n    typing: 0,\n    waiting: 0,\n    rendering: 0,\n  };\n\n  // Create artifact directory if capturing screenshots\n  let artifactDir: string | undefined;\n  if (captureSteps && options.sessionDir) {\n    artifactDir = join(options.sessionDir, `search-${Date.now()}`);\n    await mkdir(artifactDir, { recursive: true });\n  }\n\n  try {\n    // Step 1: Capture \"before\" screenshot\n    if (captureSteps && artifactDir) {\n      const shot = await captureStepScreenshot(page, 'before', artifactDir, startTime);\n      screenshots.push(shot);\n      steps.push({ action: 'capture before screenshot', success: true, duration: shot.timing });\n    }\n\n    // Step 2: Find search input\n    const searchInput = await findFieldByLabel(page, ['search', 'query', 'q', 'find']);\n    const searchField = searchInput || await page.$(\n      'input[type=\"search\"], ' +\n      'input[name=\"q\"], ' +\n      'input[name=\"query\"], ' +\n      'input[placeholder*=\"search\" i], ' +\n      '[role=\"searchbox\"]'\n    );\n\n    if (!searchField) {\n      return {\n        success: false,\n        query: options.query,\n        userIntent: options.userIntent,\n        resultCount: 0,\n        hasResults: false,\n        steps,\n        screenshots,\n        extractedResults: [],\n        timing: { ...timing, total: Date.now() - startTime },\n        error: 'Could not find search input',\n        duration: Date.now() - startTime,\n        artifactDir,\n      };\n    }\n\n    // Step 3: Type query with timing\n    const typingStart = Date.now();\n    await searchField.fill('');\n    await searchField.fill(options.query);\n    timing.typing = Date.now() - typingStart;\n    steps.push({ action: `type \"${options.query}\"`, success: true, duration: timing.typing });\n\n    // Step 4: Capture \"after-query\" screenshot (for autocomplete testing)\n    if (captureSteps && artifactDir) {\n      const shot = await captureStepScreenshot(page, 'after-query', artifactDir, startTime);\n      screenshots.push(shot);\n      steps.push({ action: 'capture after-query screenshot', success: true });\n    }\n\n    // Step 5: Submit if requested (default true)\n    const waitingStart = Date.now();\n    if (options.submit !== false) {\n      await searchField.press('Enter');\n      steps.push({ action: 'submit search', success: true });\n\n      // Wait for results\n      await waitForNavigation(page, timeout);\n      steps.push({ action: 'wait for results', success: true });\n    } else {\n      // Just wait for autocomplete\n      await page.waitForTimeout(500);\n      steps.push({ action: 'wait for autocomplete', success: true });\n    }\n    timing.waiting = Date.now() - waitingStart;\n\n    // Step 6: Capture \"results\" screenshot\n    const renderingStart = Date.now();\n    if (captureSteps && artifactDir) {\n      const shot = await captureStepScreenshot(page, 'results', artifactDir, startTime);\n      screenshots.push(shot);\n      steps.push({ action: 'capture results screenshot', success: true });\n    }\n\n    // Step 7: Count and extract results\n    const resultsSelector = options.resultsSelector ||\n      '[class*=\"result\"], [class*=\"item\"], [class*=\"card\"], ' +\n      '[data-testid*=\"result\"], li[class*=\"search\"]';\n\n    const resultElements = await page.$$(resultsSelector);\n    const resultCount = resultElements.length;\n    const hasResults = resultCount > 0;\n\n    // Extract content if enabled\n    let extractedResults: ExtractedResult[] = [];\n    if (extractContent && hasResults) {\n      extractedResults = await extractResultContent(page, resultsSelector);\n      steps.push({ action: `extracted ${extractedResults.length} results`, success: true });\n    }\n\n    timing.rendering = Date.now() - renderingStart;\n    timing.total = Date.now() - startTime;\n\n    // Save results.json if we have an artifact directory\n    if (artifactDir) {\n      const resultsData = {\n        query: options.query,\n        userIntent: options.userIntent,\n        timestamp: new Date().toISOString(),\n        resultCount,\n        hasResults,\n        timing,\n        extractedResults,\n      };\n      await writeFile(\n        join(artifactDir, 'results.json'),\n        JSON.stringify(resultsData, null, 2)\n      );\n    }\n\n    steps.push({\n      action: `found ${resultCount} results`,\n      success: hasResults,\n    });\n\n    return {\n      success: true,\n      query: options.query,\n      userIntent: options.userIntent,\n      resultCount,\n      hasResults,\n      steps,\n      screenshots,\n      extractedResults,\n      timing,\n      duration: timing.total,\n      artifactDir,\n    };\n\n  } catch (error) {\n    timing.total = Date.now() - startTime;\n    return {\n      success: false,\n      query: options.query,\n      userIntent: options.userIntent,\n      resultCount: 0,\n      hasResults: false,\n      steps,\n      screenshots,\n      extractedResults: [],\n      timing,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      duration: timing.total,\n      artifactDir,\n    };\n  }\n}\n","/**\n * Form Submit Flow\n *\n * Handles generic form submission with field detection.\n */\n\nimport type { Page } from 'playwright';\nimport { findFieldByLabel, findButton, waitForNavigation, type FlowResult, type FlowStep, type FlowOptions } from './types.js';\n\nexport interface FormField {\n  /** Field name or label to search for */\n  name: string;\n  /** Value to fill */\n  value: string;\n  /** Field type (defaults to 'text') */\n  type?: 'text' | 'select' | 'checkbox' | 'radio' | 'textarea';\n}\n\nexport interface FlowFormOptions extends FlowOptions {\n  /** Fields to fill */\n  fields: FormField[];\n  /** Button text to click (defaults to 'submit') */\n  submitButton?: string;\n  /** Selector for success message */\n  successSelector?: string;\n}\n\nexport interface FormResult extends FlowResult {\n  /** Which fields were successfully filled */\n  filledFields: string[];\n  /** Which fields failed */\n  failedFields: string[];\n}\n\n/**\n * Execute form submission flow\n */\nexport async function formFlow(\n  page: Page,\n  options: FlowFormOptions\n): Promise<FormResult> {\n  const startTime = Date.now();\n  const steps: FlowStep[] = [];\n  const filledFields: string[] = [];\n  const failedFields: string[] = [];\n  const timeout = options.timeout || 10000;\n\n  try {\n    // Step 1: Fill each field\n    for (const field of options.fields) {\n      const fieldType = field.type || 'text';\n\n      let element;\n\n      if (fieldType === 'textarea') {\n        element = await page.$(`textarea[name*=\"${field.name}\" i], textarea[id*=\"${field.name}\" i]`);\n      } else if (fieldType === 'select') {\n        element = await page.$(`select[name*=\"${field.name}\" i], select[id*=\"${field.name}\" i]`);\n      } else if (fieldType === 'checkbox' || fieldType === 'radio') {\n        element = await page.$(\n          `input[type=\"${fieldType}\"][name*=\"${field.name}\" i], ` +\n          `input[type=\"${fieldType}\"][id*=\"${field.name}\" i]`\n        );\n      } else {\n        element = await findFieldByLabel(page, [field.name]);\n      }\n\n      if (element) {\n        try {\n          if (fieldType === 'select') {\n            await element.selectOption(field.value);\n          } else if (fieldType === 'checkbox') {\n            if (field.value === 'true' || field.value === '1') {\n              await element.check();\n            } else {\n              await element.uncheck();\n            }\n          } else if (fieldType === 'radio') {\n            await element.check();\n          } else {\n            await element.fill(field.value);\n          }\n          filledFields.push(field.name);\n          steps.push({ action: `fill ${field.name}`, success: true });\n        } catch (err) {\n          failedFields.push(field.name);\n          steps.push({\n            action: `fill ${field.name}`,\n            success: false,\n            error: err instanceof Error ? err.message : 'Unknown error',\n          });\n        }\n      } else {\n        failedFields.push(field.name);\n        steps.push({\n          action: `fill ${field.name}`,\n          success: false,\n          error: 'Field not found',\n        });\n      }\n    }\n\n    // Step 2: Submit the form\n    const submitPatterns = options.submitButton\n      ? [options.submitButton]\n      : ['submit', 'save', 'send', 'continue', 'confirm'];\n\n    const submitButton = await findButton(page, submitPatterns);\n\n    if (!submitButton) {\n      return {\n        success: false,\n        filledFields,\n        failedFields,\n        steps,\n        error: 'Could not find submit button',\n        duration: Date.now() - startTime,\n      };\n    }\n\n    await submitButton.click();\n    steps.push({ action: 'click submit', success: true });\n\n    // Step 3: Wait for response\n    await waitForNavigation(page, timeout);\n    steps.push({ action: 'wait for response', success: true });\n\n    // Step 4: Check for success indicator\n    let success = true;\n    if (options.successSelector) {\n      const successElement = await page.$(options.successSelector);\n      success = !!successElement;\n      steps.push({\n        action: 'verify success',\n        success,\n      });\n    }\n\n    // Also check for error indicators\n    const errorElement = await page.$(\n      '[class*=\"error\"]:not([class*=\"error-boundary\"]), ' +\n      '[role=\"alert\"][class*=\"error\"], ' +\n      '.form-error, .validation-error'\n    );\n\n    if (errorElement) {\n      const errorText = await errorElement.textContent();\n      success = false;\n      steps.push({\n        action: 'check for errors',\n        success: false,\n        error: errorText?.trim() || 'Form has errors',\n      });\n    }\n\n    return {\n      success: success && failedFields.length === 0,\n      filledFields,\n      failedFields,\n      steps,\n      duration: Date.now() - startTime,\n    };\n\n  } catch (error) {\n    return {\n      success: false,\n      filledFields,\n      failedFields,\n      steps,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      duration: Date.now() - startTime,\n    };\n  }\n}\n","/**\n * Search Validation\n *\n * Generates structured output for Claude Code to analyze search results.\n * Provides context for AI-powered relevance checking.\n */\n\nimport type { AISearchResult, ExtractedResult, SearchTiming } from './types.js';\n\n/**\n * Context for AI validation of search results\n */\nexport interface ValidationContext {\n  /** The search query executed */\n  query: string;\n  /** What the user expected to find */\n  userIntent: string;\n  /** Extracted results for analysis */\n  results: ExtractedResult[];\n  /** Paths to screenshots for visual inspection */\n  screenshotPaths: string[];\n  /** Timing metrics */\n  timing: SearchTiming;\n  /** Timestamp of the search */\n  timestamp: string;\n  /** Whether any results were found */\n  hasResults: boolean;\n  /** Total result count */\n  resultCount: number;\n}\n\n/**\n * Result from AI validation\n */\nexport interface ValidationResult {\n  /** Whether results are relevant to user intent */\n  relevant: boolean;\n  /** Confidence in the assessment (0-1) */\n  confidence: number;\n  /** Explanation of the assessment */\n  reasoning: string;\n  /** Suggestions for improvement or next steps */\n  suggestions?: string[];\n  /** Specific issues found */\n  issues?: ValidationIssue[];\n}\n\n/**\n * Specific issue found during validation\n */\nexport interface ValidationIssue {\n  /** Type of issue */\n  type: 'irrelevant' | 'partial' | 'empty' | 'error' | 'slow';\n  /** Which result index (if applicable) */\n  resultIndex?: number;\n  /** Description of the issue */\n  description: string;\n  /** Severity: low, medium, high */\n  severity: 'low' | 'medium' | 'high';\n}\n\n/**\n * Generate validation context from AI search result\n */\nexport function generateValidationContext(result: AISearchResult): ValidationContext {\n  return {\n    query: result.query,\n    userIntent: result.userIntent || `Find results related to: ${result.query}`,\n    results: result.extractedResults,\n    screenshotPaths: result.screenshots.map(s => s.path),\n    timing: result.timing,\n    timestamp: new Date().toISOString(),\n    hasResults: result.hasResults,\n    resultCount: result.resultCount,\n  };\n}\n\n/**\n * Generate a structured prompt for Claude Code to analyze search results\n *\n * This prompt provides all necessary context for AI-powered validation:\n * - The query and user intent\n * - Extracted result content\n * - Screenshots for visual inspection\n * - Timing metrics\n */\nexport function generateValidationPrompt(context: ValidationContext): string {\n  const lines: string[] = [];\n\n  lines.push('# Search Result Validation Request');\n  lines.push('');\n  lines.push('Please analyze the following search results and determine if they are relevant to the user\\'s intent.');\n  lines.push('');\n\n  // Query and Intent\n  lines.push('## Search Details');\n  lines.push(`- **Query:** \"${context.query}\"`);\n  lines.push(`- **User Intent:** ${context.userIntent}`);\n  lines.push(`- **Results Found:** ${context.resultCount}`);\n  lines.push(`- **Total Time:** ${context.timing.total}ms`);\n  lines.push('');\n\n  // Screenshots\n  if (context.screenshotPaths.length > 0) {\n    lines.push('## Screenshots');\n    lines.push('The following screenshots capture the search interaction:');\n    for (const path of context.screenshotPaths) {\n      lines.push(`- ${path}`);\n    }\n    lines.push('');\n    lines.push('*Please view these screenshots using the Read tool to see the visual state.*');\n    lines.push('');\n  }\n\n  // Extracted Results\n  if (context.results.length > 0) {\n    lines.push('## Extracted Results');\n    lines.push('');\n    for (const result of context.results.slice(0, 10)) { // Limit to first 10\n      lines.push(`### Result ${result.index + 1}`);\n      if (result.title) {\n        lines.push(`**Title:** ${result.title}`);\n      }\n      if (result.snippet) {\n        lines.push(`**Snippet:** ${result.snippet}`);\n      }\n      lines.push(`**Full Text:** ${result.fullText.slice(0, 200)}${result.fullText.length > 200 ? '...' : ''}`);\n      lines.push(`**Visible:** ${result.visible ? 'Yes' : 'No'}`);\n      lines.push('');\n    }\n\n    if (context.results.length > 10) {\n      lines.push(`*...and ${context.results.length - 10} more results*`);\n      lines.push('');\n    }\n  } else {\n    lines.push('## No Results');\n    lines.push('The search returned no results. This may indicate:');\n    lines.push('- The search query is too specific');\n    lines.push('- No matching content exists');\n    lines.push('- A bug in the search functionality');\n    lines.push('');\n  }\n\n  // Validation Questions\n  lines.push('## Validation Questions');\n  lines.push('');\n  lines.push('1. **Relevance:** Do the results match the user\\'s intent?');\n  lines.push('2. **Quality:** Are the results useful and informative?');\n  lines.push('3. **Issues:** Are there any obvious problems (e.g., unrelated content)?');\n  lines.push('4. **Suggestions:** What could improve the search experience?');\n  lines.push('');\n\n  // Response Format\n  lines.push('## Expected Response');\n  lines.push('');\n  lines.push('Please respond with:');\n  lines.push('- `relevant`: true/false - whether results match user intent');\n  lines.push('- `confidence`: 0-1 - how confident you are in the assessment');\n  lines.push('- `reasoning`: brief explanation of your assessment');\n  lines.push('- `suggestions`: (optional) array of improvement suggestions');\n  lines.push('- `issues`: (optional) array of specific issues found');\n\n  return lines.join('\\n');\n}\n\n/**\n * Generate a concise summary for quick validation\n */\nexport function generateQuickSummary(context: ValidationContext): string {\n  const lines: string[] = [];\n\n  lines.push(`Search: \"${context.query}\"`);\n  lines.push(`Intent: ${context.userIntent}`);\n  lines.push(`Results: ${context.resultCount} found in ${context.timing.total}ms`);\n\n  if (context.results.length > 0) {\n    lines.push('');\n    lines.push('Top results:');\n    for (const result of context.results.slice(0, 3)) {\n      const title = result.title || result.fullText.slice(0, 50);\n      lines.push(`  ${result.index + 1}. ${title}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Analyze results for obvious issues (pre-AI check)\n *\n * Performs quick heuristic checks before involving AI:\n * - Empty results\n * - Very slow response\n * - Results with no text content\n */\nexport function analyzeForObviousIssues(context: ValidationContext): ValidationIssue[] {\n  const issues: ValidationIssue[] = [];\n\n  // Check for empty results\n  if (!context.hasResults) {\n    issues.push({\n      type: 'empty',\n      description: 'Search returned no results',\n      severity: 'high',\n    });\n  }\n\n  // Check for slow response (>5 seconds is concerning)\n  if (context.timing.total > 5000) {\n    issues.push({\n      type: 'slow',\n      description: `Search took ${context.timing.total}ms (>5s)`,\n      severity: context.timing.total > 10000 ? 'high' : 'medium',\n    });\n  }\n\n  // Check for results with no meaningful content\n  for (const result of context.results) {\n    if (!result.fullText || result.fullText.trim().length < 10) {\n      issues.push({\n        type: 'error',\n        resultIndex: result.index,\n        description: `Result ${result.index + 1} has no meaningful content`,\n        severity: 'medium',\n      });\n    }\n  }\n\n  // Check for query terms in results (basic relevance)\n  const queryTerms = context.query.toLowerCase().split(/\\s+/).filter(t => t.length > 2);\n  for (const result of context.results) {\n    const textLower = result.fullText.toLowerCase();\n    const matchCount = queryTerms.filter(term => textLower.includes(term)).length;\n    const matchRatio = matchCount / queryTerms.length;\n\n    if (matchRatio < 0.2 && queryTerms.length > 1) {\n      issues.push({\n        type: 'irrelevant',\n        resultIndex: result.index,\n        description: `Result ${result.index + 1} may not match query (low keyword overlap)`,\n        severity: 'low',\n      });\n    }\n  }\n\n  return issues;\n}\n\n/**\n * Format validation result for display\n */\nexport function formatValidationResult(result: ValidationResult): string {\n  const lines: string[] = [];\n\n  const status = result.relevant ? 'PASS' : 'FAIL';\n  const confidence = Math.round(result.confidence * 100);\n\n  lines.push(`## Validation: ${status} (${confidence}% confidence)`);\n  lines.push('');\n  lines.push(`**Assessment:** ${result.reasoning}`);\n\n  if (result.issues && result.issues.length > 0) {\n    lines.push('');\n    lines.push('**Issues Found:**');\n    for (const issue of result.issues) {\n      const severity = issue.severity.toUpperCase();\n      lines.push(`- [${severity}] ${issue.description}`);\n    }\n  }\n\n  if (result.suggestions && result.suggestions.length > 0) {\n    lines.push('');\n    lines.push('**Suggestions:**');\n    for (const suggestion of result.suggestions) {\n      lines.push(`- ${suggestion}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Create a dev-mode prompt for user feedback\n *\n * Used when results seem questionable and user input is needed.\n */\nexport function generateDevModePrompt(\n  context: ValidationContext,\n  issues: ValidationIssue[]\n): string {\n  const lines: string[] = [];\n\n  lines.push('## Search Results Review');\n  lines.push('');\n  lines.push(`Query: \"${context.query}\"`);\n  lines.push(`Intent: ${context.userIntent}`);\n  lines.push('');\n\n  if (issues.length > 0) {\n    lines.push('**Potential issues detected:**');\n    for (const issue of issues) {\n      lines.push(`- ${issue.description}`);\n    }\n    lines.push('');\n  }\n\n  // Show sample results\n  if (context.results.length > 0) {\n    lines.push('**Sample results:**');\n    for (const result of context.results.slice(0, 3)) {\n      const title = result.title || result.fullText.slice(0, 40);\n      lines.push(`  ${result.index + 1}. ${title}`);\n    }\n    lines.push('');\n  }\n\n  lines.push('**What would you like to do?**');\n  lines.push('1. Accept results as expected');\n  lines.push('2. Refine the search query');\n  lines.push('3. Report as bug');\n  lines.push('4. Skip this test');\n\n  return lines.join('\\n');\n}\n","/**\n * IBR Built-in Flows\n *\n * Common automation patterns as single commands:\n * - login: Authenticate with email/password\n * - search: Search and verify results\n * - form: Fill and submit forms\n */\n\nexport {\n  loginFlow,\n  type FlowLoginOptions,\n  type LoginResult,\n} from './login.js';\n\nexport {\n  searchFlow,\n  aiSearchFlow,\n  type FlowSearchOptions,\n  type SearchResult,\n} from './search.js';\n\nexport {\n  formFlow,\n  type FlowFormOptions,\n  type FormField,\n  type FormResult,\n} from './form.js';\n\nexport {\n  findFieldByLabel,\n  findButton,\n  waitForNavigation,\n  type FlowResult,\n  type FlowStep,\n  type FlowOptions,\n  type AISearchOptions,\n  type AISearchResult,\n  type StepScreenshot,\n  type ExtractedResult,\n  type SearchTiming,\n} from './types.js';\n\nexport {\n  generateValidationContext,\n  generateValidationPrompt,\n  generateQuickSummary,\n  analyzeForObviousIssues,\n  formatValidationResult,\n  generateDevModePrompt,\n  type ValidationContext,\n  type ValidationResult,\n  type ValidationIssue,\n} from './search-validation.js';\n\n// Flow registry for dynamic access\nimport { loginFlow } from './login.js';\nimport { searchFlow, aiSearchFlow } from './search.js';\nimport { formFlow } from './form.js';\n\nexport const flows = {\n  login: loginFlow,\n  search: searchFlow,\n  aiSearch: aiSearchFlow,\n  form: formFlow,\n} as const;\n\nexport type FlowName = keyof typeof flows;\n","import { readFile, access } from 'fs/promises';\nimport { join } from 'path';\nimport { listSessions, deleteSession } from './session.js';\nimport type { Session } from './schemas.js';\n\n/**\n * Retention policy configuration\n * Add to .ibrrc.json to enable auto-cleanup\n */\nexport interface RetentionConfig {\n  /** Maximum number of sessions to keep (default: no limit) */\n  maxSessions?: number;\n  /** Maximum age of sessions in days (default: no limit) */\n  maxAgeDays?: number;\n  /** Keep sessions that have failed comparisons (default: true) */\n  keepFailed?: boolean;\n  /** Enable automatic cleanup on session creation (default: false) */\n  autoClean?: boolean;\n}\n\n/**\n * Default retention configuration\n */\nexport const DEFAULT_RETENTION: RetentionConfig = {\n  maxSessions: undefined,\n  maxAgeDays: undefined,\n  keepFailed: true,\n  autoClean: false,\n};\n\n/**\n * Result of retention policy enforcement\n */\nexport interface RetentionResult {\n  /** Sessions that were deleted */\n  deleted: string[];\n  /** Sessions that were kept */\n  kept: string[];\n  /** Sessions kept because they failed (if keepFailed is true) */\n  keptFailed: string[];\n  /** Total sessions before cleanup */\n  totalBefore: number;\n  /** Total sessions after cleanup */\n  totalAfter: number;\n}\n\n/**\n * Load retention config from .ibrrc.json\n */\nexport async function loadRetentionConfig(outputDir: string): Promise<RetentionConfig> {\n  const configPath = join(outputDir, '..', '.ibrrc.json');\n\n  try {\n    await access(configPath);\n    const content = await readFile(configPath, 'utf-8');\n    const config = JSON.parse(content);\n    return {\n      ...DEFAULT_RETENTION,\n      ...config.retention,\n    };\n  } catch {\n    return DEFAULT_RETENTION;\n  }\n}\n\n/**\n * Check if a session should be kept due to failed status\n */\nfunction isFailedSession(session: Session): boolean {\n  return session.analysis?.verdict === 'LAYOUT_BROKEN' ||\n         session.analysis?.verdict === 'UNEXPECTED_CHANGE';\n}\n\n/**\n * Enforce retention policy on sessions\n *\n * @example\n * ```typescript\n * // Enforce with config from .ibrrc.json\n * const result = await enforceRetentionPolicy('./.ibr');\n * console.log(`Deleted ${result.deleted.length} sessions`);\n *\n * // Enforce with explicit config\n * const result = await enforceRetentionPolicy('./.ibr', {\n *   maxSessions: 20,\n *   maxAgeDays: 7,\n *   keepFailed: true\n * });\n * ```\n */\nexport async function enforceRetentionPolicy(\n  outputDir: string,\n  config?: RetentionConfig\n): Promise<RetentionResult> {\n  // Load config if not provided\n  const retentionConfig = config || await loadRetentionConfig(outputDir);\n\n  // If no retention limits set, nothing to do\n  if (!retentionConfig.maxSessions && !retentionConfig.maxAgeDays) {\n    const sessions = await listSessions(outputDir);\n    return {\n      deleted: [],\n      kept: sessions.map(s => s.id),\n      keptFailed: [],\n      totalBefore: sessions.length,\n      totalAfter: sessions.length,\n    };\n  }\n\n  // Get all sessions sorted by creation date (newest first)\n  const sessions = await listSessions(outputDir);\n  const totalBefore = sessions.length;\n\n  const deleted: string[] = [];\n  const kept: string[] = [];\n  const keptFailed: string[] = [];\n\n  // Calculate cutoff time if maxAgeDays is set\n  const cutoffTime = retentionConfig.maxAgeDays\n    ? Date.now() - (retentionConfig.maxAgeDays * 24 * 60 * 60 * 1000)\n    : 0;\n\n  // Track how many non-failed sessions we've kept\n  let keptCount = 0;\n\n  for (const session of sessions) {\n    const sessionTime = new Date(session.createdAt).getTime();\n    const isTooOld = retentionConfig.maxAgeDays && sessionTime < cutoffTime;\n    const isOverLimit = retentionConfig.maxSessions && keptCount >= retentionConfig.maxSessions;\n    const isFailed = isFailedSession(session);\n\n    // Keep failed sessions if configured\n    if (isFailed && retentionConfig.keepFailed) {\n      kept.push(session.id);\n      keptFailed.push(session.id);\n      continue;\n    }\n\n    // Check if session should be deleted\n    if (isTooOld || isOverLimit) {\n      await deleteSession(outputDir, session.id);\n      deleted.push(session.id);\n    } else {\n      kept.push(session.id);\n      keptCount++;\n    }\n  }\n\n  return {\n    deleted,\n    kept,\n    keptFailed,\n    totalBefore,\n    totalAfter: kept.length,\n  };\n}\n\n/**\n * Run auto-cleanup if enabled in config\n * Call this after creating new sessions\n */\nexport async function maybeAutoClean(outputDir: string): Promise<RetentionResult | null> {\n  const config = await loadRetentionConfig(outputDir);\n\n  if (!config.autoClean) {\n    return null;\n  }\n\n  return enforceRetentionPolicy(outputDir, config);\n}\n\n/**\n * Get retention status summary\n */\nexport async function getRetentionStatus(outputDir: string): Promise<{\n  config: RetentionConfig;\n  currentSessions: number;\n  oldestSession: Date | null;\n  newestSession: Date | null;\n  wouldDelete: number;\n}> {\n  const config = await loadRetentionConfig(outputDir);\n  const sessions = await listSessions(outputDir);\n\n  // Calculate how many would be deleted\n  let wouldDelete = 0;\n  const cutoffTime = config.maxAgeDays\n    ? Date.now() - (config.maxAgeDays * 24 * 60 * 60 * 1000)\n    : 0;\n\n  let keptCount = 0;\n  for (const session of sessions) {\n    const sessionTime = new Date(session.createdAt).getTime();\n    const isTooOld = config.maxAgeDays && sessionTime < cutoffTime;\n    const isOverLimit = config.maxSessions && keptCount >= config.maxSessions;\n    const isFailed = isFailedSession(session);\n\n    if (isFailed && config.keepFailed) {\n      continue;\n    }\n\n    if (isTooOld || isOverLimit) {\n      wouldDelete++;\n    } else {\n      keptCount++;\n    }\n  }\n\n  return {\n    config,\n    currentSessions: sessions.length,\n    oldestSession: sessions.length > 0\n      ? new Date(sessions[sessions.length - 1].createdAt)\n      : null,\n    newestSession: sessions.length > 0\n      ? new Date(sessions[0].createdAt)\n      : null,\n    wouldDelete,\n  };\n}\n\n/**\n * Format retention status for display\n */\nexport function formatRetentionStatus(status: Awaited<ReturnType<typeof getRetentionStatus>>): string {\n  const lines: string[] = [];\n\n  lines.push('Session Retention Status');\n  lines.push('========================');\n  lines.push('');\n  lines.push(`Current sessions: ${status.currentSessions}`);\n\n  if (status.oldestSession) {\n    lines.push(`Oldest: ${status.oldestSession.toISOString()}`);\n  }\n  if (status.newestSession) {\n    lines.push(`Newest: ${status.newestSession.toISOString()}`);\n  }\n\n  lines.push('');\n  lines.push('Retention Policy:');\n\n  if (status.config.maxSessions) {\n    lines.push(`  Max sessions: ${status.config.maxSessions}`);\n  } else {\n    lines.push('  Max sessions: unlimited');\n  }\n\n  if (status.config.maxAgeDays) {\n    lines.push(`  Max age: ${status.config.maxAgeDays} days`);\n  } else {\n    lines.push('  Max age: unlimited');\n  }\n\n  lines.push(`  Keep failed: ${status.config.keepFailed ? 'yes' : 'no'}`);\n  lines.push(`  Auto-clean: ${status.config.autoClean ? 'enabled' : 'disabled'}`);\n\n  if (status.wouldDelete > 0) {\n    lines.push('');\n    lines.push(`  ${status.wouldDelete} session(s) would be deleted if cleanup runs`);\n  } else {\n    lines.push('');\n    lines.push(' All sessions within retention policy');\n  }\n\n  return lines.join('\\n');\n}\n","import { chromium, Browser } from 'playwright';\n\n/**\n * UI metrics extracted from a page for consistency checking\n */\nexport interface PageMetrics {\n  url: string;\n  path: string;\n  title: string;\n\n  // Layout metrics\n  layout: {\n    headerHeight: number | null;\n    navWidth: number | null;\n    contentPadding: { top: number; right: number; bottom: number; left: number } | null;\n    footerHeight: number | null;\n  };\n\n  // Typography metrics\n  typography: {\n    bodyFontFamily: string | null;\n    bodyFontSize: string | null;\n    headingFontFamily: string | null;\n    h1FontSize: string | null;\n    h2FontSize: string | null;\n    lineHeight: string | null;\n  };\n\n  // Color metrics\n  colors: {\n    backgroundColor: string | null;\n    textColor: string | null;\n    linkColor: string | null;\n    primaryButtonBg: string | null;\n    primaryButtonText: string | null;\n  };\n\n  // Spacing metrics (common elements)\n  spacing: {\n    buttonPadding: string | null;\n    cardPadding: string | null;\n    sectionGap: string | null;\n  };\n}\n\n/**\n * Inconsistency found between pages\n */\nexport interface Inconsistency {\n  type: 'layout' | 'typography' | 'color' | 'spacing';\n  property: string;\n  severity: 'info' | 'warning' | 'error';\n  description: string;\n  pages: Array<{\n    path: string;\n    value: string | number | null;\n  }>;\n  suggestion?: string;\n}\n\n/**\n * Consistency check result\n */\nexport interface ConsistencyResult {\n  pages: PageMetrics[];\n  inconsistencies: Inconsistency[];\n  score: number; // 0-100, higher is more consistent\n  summary: string;\n}\n\n/**\n * Consistency check options\n */\nexport interface ConsistencyOptions {\n  /** URLs to check */\n  urls: string[];\n  /** Enable verbose output */\n  verbose?: boolean;\n  /** Timeout per page (ms) */\n  timeout?: number;\n  /** Ignore certain property types */\n  ignore?: Array<'layout' | 'typography' | 'color' | 'spacing'>;\n}\n\n/**\n * Extract UI metrics from a page\n */\nasync function extractMetrics(page: import('playwright').Page, url: string): Promise<PageMetrics> {\n  const parsedUrl = new URL(url);\n\n  const metrics = await page.evaluate(() => {\n    const getComputedStyleProp = (selector: string, prop: string): string | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return window.getComputedStyle(el).getPropertyValue(prop) || null;\n    };\n\n    const getElementHeight = (selector: string): number | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return el.getBoundingClientRect().height;\n    };\n\n    const getElementWidth = (selector: string): number | null => {\n      const el = document.querySelector(selector);\n      if (!el) return null;\n      return el.getBoundingClientRect().width;\n    };\n\n    // Try multiple selectors for common elements\n    const headerSelectors = ['header', '[role=\"banner\"]', '.header', '#header', 'nav'];\n    const navSelectors = ['nav', '[role=\"navigation\"]', '.sidebar', '.nav', '#sidebar'];\n    const mainSelectors = ['main', '[role=\"main\"]', '.content', '#content', '.main'];\n    const footerSelectors = ['footer', '[role=\"contentinfo\"]', '.footer', '#footer'];\n    const buttonSelectors = ['button', '.btn', '[role=\"button\"]', 'a.button'];\n    const cardSelectors = ['.card', '[class*=\"card\"]', '.panel', '.box'];\n\n    const findFirst = (selectors: string[], fn: (s: string) => string | number | null) => {\n      for (const sel of selectors) {\n        const result = fn(sel);\n        if (result !== null) return result;\n      }\n      return null;\n    };\n\n    // Get padding from main content\n    const getContentPadding = (): { top: number; right: number; bottom: number; left: number } | null => {\n      for (const sel of mainSelectors) {\n        const el = document.querySelector(sel);\n        if (el) {\n          const style = window.getComputedStyle(el);\n          return {\n            top: parseFloat(style.paddingTop) || 0,\n            right: parseFloat(style.paddingRight) || 0,\n            bottom: parseFloat(style.paddingBottom) || 0,\n            left: parseFloat(style.paddingLeft) || 0,\n          };\n        }\n      }\n      return null;\n    };\n\n    return {\n      title: document.title,\n      layout: {\n        headerHeight: findFirst(headerSelectors, getElementHeight) as number | null,\n        navWidth: findFirst(navSelectors, getElementWidth) as number | null,\n        contentPadding: getContentPadding(),\n        footerHeight: findFirst(footerSelectors, getElementHeight) as number | null,\n      },\n      typography: {\n        bodyFontFamily: getComputedStyleProp('body', 'font-family'),\n        bodyFontSize: getComputedStyleProp('body', 'font-size'),\n        headingFontFamily: getComputedStyleProp('h1, h2, h3', 'font-family'),\n        h1FontSize: getComputedStyleProp('h1', 'font-size'),\n        h2FontSize: getComputedStyleProp('h2', 'font-size'),\n        lineHeight: getComputedStyleProp('body', 'line-height'),\n      },\n      colors: {\n        backgroundColor: getComputedStyleProp('body', 'background-color'),\n        textColor: getComputedStyleProp('body', 'color'),\n        linkColor: getComputedStyleProp('a', 'color'),\n        primaryButtonBg: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'background-color')) as string | null,\n        primaryButtonText: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'color')) as string | null,\n      },\n      spacing: {\n        buttonPadding: findFirst(buttonSelectors, s => getComputedStyleProp(s, 'padding')) as string | null,\n        cardPadding: findFirst(cardSelectors, s => getComputedStyleProp(s, 'padding')) as string | null,\n        sectionGap: getComputedStyleProp('main > *', 'margin-bottom'),\n      },\n    };\n  });\n\n  return {\n    url,\n    path: parsedUrl.pathname,\n    ...metrics,\n  };\n}\n\n/**\n * Compare metrics across pages and find inconsistencies\n */\nfunction findInconsistencies(pages: PageMetrics[], ignore: string[] = []): Inconsistency[] {\n  const inconsistencies: Inconsistency[] = [];\n\n  // Helper to check if values are consistent\n  const checkProperty = (\n    type: Inconsistency['type'],\n    property: string,\n    getValue: (p: PageMetrics) => string | number | null,\n    description: string,\n    severity: Inconsistency['severity'] = 'warning'\n  ) => {\n    if (ignore.includes(type)) return;\n\n    const values = pages.map(p => ({\n      path: p.path,\n      value: getValue(p),\n    }));\n\n    // Filter out null values\n    const nonNullValues = values.filter(v => v.value !== null);\n    if (nonNullValues.length < 2) return;\n\n    // Check if all values are the same\n    const uniqueValues = new Set(nonNullValues.map(v => String(v.value)));\n    if (uniqueValues.size > 1) {\n      inconsistencies.push({\n        type,\n        property,\n        severity,\n        description,\n        pages: values,\n      });\n    }\n  };\n\n  // Layout checks\n  checkProperty('layout', 'headerHeight', p => p.layout.headerHeight, 'Header height differs across pages');\n  checkProperty('layout', 'navWidth', p => p.layout.navWidth, 'Navigation width differs across pages');\n  checkProperty('layout', 'footerHeight', p => p.layout.footerHeight, 'Footer height differs across pages');\n\n  // Typography checks\n  checkProperty('typography', 'bodyFontFamily', p => p.typography.bodyFontFamily, 'Body font family differs across pages', 'error');\n  checkProperty('typography', 'bodyFontSize', p => p.typography.bodyFontSize, 'Body font size differs across pages');\n  checkProperty('typography', 'headingFontFamily', p => p.typography.headingFontFamily, 'Heading font family differs across pages', 'error');\n  checkProperty('typography', 'h1FontSize', p => p.typography.h1FontSize, 'H1 font size differs across pages');\n  checkProperty('typography', 'lineHeight', p => p.typography.lineHeight, 'Line height differs across pages');\n\n  // Color checks\n  checkProperty('color', 'backgroundColor', p => p.colors.backgroundColor, 'Background color differs across pages');\n  checkProperty('color', 'textColor', p => p.colors.textColor, 'Text color differs across pages', 'error');\n  checkProperty('color', 'linkColor', p => p.colors.linkColor, 'Link color differs across pages');\n  checkProperty('color', 'primaryButtonBg', p => p.colors.primaryButtonBg, 'Primary button background differs across pages');\n\n  // Spacing checks\n  checkProperty('spacing', 'buttonPadding', p => p.spacing.buttonPadding, 'Button padding differs across pages');\n  checkProperty('spacing', 'cardPadding', p => p.spacing.cardPadding, 'Card padding differs across pages');\n\n  return inconsistencies;\n}\n\n/**\n * Calculate consistency score based on inconsistencies\n */\nfunction calculateScore(inconsistencies: Inconsistency[]): number {\n  if (inconsistencies.length === 0) return 100;\n\n  const weights = { error: 10, warning: 5, info: 1 };\n  const totalPenalty = inconsistencies.reduce((sum, i) => sum + weights[i.severity], 0);\n\n  // Score decreases based on penalty, minimum 0\n  return Math.max(0, 100 - totalPenalty);\n}\n\n/**\n * Check UI consistency across multiple pages\n */\nexport async function checkConsistency(options: ConsistencyOptions): Promise<ConsistencyResult> {\n  const { urls, timeout = 15000, ignore = [] } = options;\n\n  let browser: Browser | null = null;\n  const pages: PageMetrics[] = [];\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const context = await browser.newContext({\n      viewport: { width: 1920, height: 1080 },\n    });\n    const page = await context.newPage();\n\n    for (const url of urls) {\n      try {\n        await page.goto(url, {\n          waitUntil: 'domcontentloaded',\n          timeout,\n        });\n\n        const metrics = await extractMetrics(page, url);\n        pages.push(metrics);\n      } catch (error) {\n        console.error(`Failed to analyze ${url}:`, error instanceof Error ? error.message : error);\n      }\n    }\n\n    await browser.close();\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n\n  if (pages.length < 2) {\n    return {\n      pages,\n      inconsistencies: [],\n      score: 100,\n      summary: 'Need at least 2 pages to check consistency',\n    };\n  }\n\n  const inconsistencies = findInconsistencies(pages, ignore);\n  const score = calculateScore(inconsistencies);\n\n  const errorCount = inconsistencies.filter(i => i.severity === 'error').length;\n  const warningCount = inconsistencies.filter(i => i.severity === 'warning').length;\n\n  let summary: string;\n  if (score === 100) {\n    summary = `All ${pages.length} pages are consistent.`;\n  } else if (score >= 80) {\n    summary = `Minor inconsistencies found across ${pages.length} pages. ${warningCount} warning(s).`;\n  } else if (score >= 50) {\n    summary = `Notable inconsistencies found. ${errorCount} error(s), ${warningCount} warning(s).`;\n  } else {\n    summary = `Significant style inconsistencies detected. ${errorCount} error(s), ${warningCount} warning(s). Review recommended.`;\n  }\n\n  return {\n    pages,\n    inconsistencies,\n    score,\n    summary,\n  };\n}\n\n/**\n * Format consistency result for display\n */\nexport function formatConsistencyReport(result: ConsistencyResult): string {\n  const lines: string[] = [];\n\n  lines.push('');\n  lines.push('  UI CONSISTENCY REPORT');\n  lines.push('');\n  lines.push('');\n  lines.push(`Score: ${result.score}/100`);\n  lines.push(`Pages analyzed: ${result.pages.length}`);\n  lines.push(`Summary: ${result.summary}`);\n  lines.push('');\n\n  if (result.inconsistencies.length === 0) {\n    lines.push(' No inconsistencies found');\n  } else {\n    lines.push('Inconsistencies:');\n    lines.push('');\n\n    for (const issue of result.inconsistencies) {\n      const icon = issue.severity === 'error' ? '' : issue.severity === 'warning' ? '!' : '';\n      lines.push(`  ${icon} [${issue.type}] ${issue.description}`);\n\n      for (const page of issue.pages) {\n        if (page.value !== null) {\n          lines.push(`      ${page.path}: ${page.value}`);\n        }\n      }\n      lines.push('');\n    }\n  }\n\n  lines.push('');\n  lines.push('Pages analyzed:');\n  for (const page of result.pages) {\n    lines.push(`   ${page.path} (${page.title})`);\n  }\n\n  return lines.join('\\n');\n}\n","import { chromium, Browser } from 'playwright';\nimport { URL } from 'url';\n\nexport interface CrawlOptions {\n  /** Starting URL */\n  url: string;\n  /** Maximum number of pages to discover (default: 5) */\n  maxPages?: number;\n  /** Only crawl pages under this path prefix */\n  pathPrefix?: string;\n  /** Timeout per page in ms (default: 10000) */\n  timeout?: number;\n  /** Include external links (default: false) */\n  includeExternal?: boolean;\n}\n\nexport interface DiscoveredPage {\n  url: string;\n  path: string;\n  title: string;\n  linkText?: string;\n  depth: number;\n}\n\nexport interface CrawlResult {\n  baseUrl: string;\n  pages: DiscoveredPage[];\n  totalLinks: number;\n  crawlTime: number;\n}\n\n/**\n * Discover pages on a website by crawling from the starting URL\n * Returns up to maxPages unique pages within the same origin\n */\nexport async function discoverPages(options: CrawlOptions): Promise<CrawlResult> {\n  const {\n    url,\n    maxPages = 5,\n    pathPrefix,\n    timeout = 10000,\n    includeExternal = false,\n  } = options;\n\n  const startTime = Date.now();\n  const startUrl = new URL(url);\n  const origin = startUrl.origin;\n\n  const discovered: Map<string, DiscoveredPage> = new Map();\n  const visited: Set<string> = new Set();\n  const queue: { url: string; depth: number; linkText?: string }[] = [\n    { url: url, depth: 0 }\n  ];\n\n  let browser: Browser | null = null;\n  let totalLinks = 0;\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const context = await browser.newContext();\n    const page = await context.newPage();\n\n    while (queue.length > 0 && discovered.size < maxPages) {\n      const current = queue.shift();\n      if (!current) break;\n\n      const currentUrl = normalizeUrl(current.url);\n      if (visited.has(currentUrl)) continue;\n      visited.add(currentUrl);\n\n      try {\n        // Navigate to page\n        await page.goto(current.url, {\n          waitUntil: 'domcontentloaded',\n          timeout,\n        });\n\n        // Get page title\n        const title = await page.title();\n\n        // Add to discovered pages\n        const parsedUrl = new URL(current.url);\n        discovered.set(currentUrl, {\n          url: current.url,\n          path: parsedUrl.pathname,\n          title: title || parsedUrl.pathname,\n          linkText: current.linkText,\n          depth: current.depth,\n        });\n\n        // Only continue crawling if we haven't reached max\n        if (discovered.size >= maxPages) break;\n\n        // Find all links on the page\n        const links = await page.evaluate((): { href: string; text: string }[] => {\n          const anchors = Array.from(document.querySelectorAll('a[href]'));\n          return anchors.map((a: Element) => ({\n            href: (a as HTMLAnchorElement).getAttribute('href') || '',\n            text: a.textContent?.trim() || '',\n          }));\n        });\n\n        totalLinks += links.length;\n\n        // Process links\n        for (const link of links) {\n          if (discovered.size >= maxPages) break;\n\n          try {\n            const absoluteUrl = new URL(link.href, current.url);\n            const normalizedUrl = normalizeUrl(absoluteUrl.href);\n\n            // Skip if already visited or queued\n            if (visited.has(normalizedUrl)) continue;\n\n            // Check if same origin\n            if (!includeExternal && absoluteUrl.origin !== origin) continue;\n\n            // Check path prefix if specified\n            if (pathPrefix && !absoluteUrl.pathname.startsWith(pathPrefix)) continue;\n\n            // Skip common non-page URLs\n            if (shouldSkipUrl(absoluteUrl)) continue;\n\n            // Add to queue\n            queue.push({\n              url: absoluteUrl.href,\n              depth: current.depth + 1,\n              linkText: link.text,\n            });\n          } catch {\n            // Invalid URL, skip\n          }\n        }\n      } catch (error) {\n        // Page failed to load, continue with next\n        console.error(`Failed to load ${current.url}:`, error instanceof Error ? error.message : error);\n      }\n    }\n\n    await browser.close();\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n\n  const crawlTime = Date.now() - startTime;\n\n  return {\n    baseUrl: origin,\n    pages: Array.from(discovered.values()).sort((a, b) => {\n      // Sort by depth first, then by path\n      if (a.depth !== b.depth) return a.depth - b.depth;\n      return a.path.localeCompare(b.path);\n    }),\n    totalLinks,\n    crawlTime,\n  };\n}\n\n/**\n * Normalize URL for comparison (remove trailing slash, hash, query params)\n */\nfunction normalizeUrl(url: string): string {\n  try {\n    const parsed = new URL(url);\n    // Remove hash and query, normalize trailing slash\n    let normalized = `${parsed.origin}${parsed.pathname}`;\n    if (normalized.endsWith('/') && normalized.length > 1) {\n      normalized = normalized.slice(0, -1);\n    }\n    return normalized;\n  } catch {\n    return url;\n  }\n}\n\n/**\n * Check if URL should be skipped (non-page resources)\n */\nfunction shouldSkipUrl(url: URL): boolean {\n  const path = url.pathname.toLowerCase();\n  const skipExtensions = [\n    '.pdf', '.jpg', '.jpeg', '.png', '.gif', '.svg', '.webp',\n    '.css', '.js', '.json', '.xml', '.ico', '.woff', '.woff2',\n    '.mp3', '.mp4', '.webm', '.zip', '.tar', '.gz',\n  ];\n\n  if (skipExtensions.some(ext => path.endsWith(ext))) return true;\n\n  // Skip common non-content paths\n  const skipPaths = [\n    '/api/', '/static/', '/assets/', '/_next/', '/fonts/',\n    '/images/', '/img/', '/cdn/', '/admin/', '/auth/',\n  ];\n\n  if (skipPaths.some(p => path.includes(p))) return true;\n\n  // Skip hash-only links\n  if (url.hash && url.pathname === '/') return true;\n\n  return false;\n}\n\n/**\n * Quick scan to get navigation links from a page\n * Useful for finding main pages without full crawl\n */\nexport async function getNavigationLinks(url: string): Promise<DiscoveredPage[]> {\n  let browser: Browser | null = null;\n\n  try {\n    browser = await chromium.launch({ headless: true });\n    const page = await browser.newPage();\n\n    await page.goto(url, {\n      waitUntil: 'domcontentloaded',\n      timeout: 15000,\n    });\n\n    const origin = new URL(url).origin;\n\n    // Find links in navigation elements\n    const navLinks = await page.evaluate((): { href: string; text: string }[] => {\n      const selectors = [\n        'nav a[href]',\n        'header a[href]',\n        '[role=\"navigation\"] a[href]',\n        '.nav a[href]',\n        '.navbar a[href]',\n        '.sidebar a[href]',\n        '.menu a[href]',\n      ];\n\n      const links: { href: string; text: string }[] = [];\n      const seen = new Set<string>();\n\n      for (const selector of selectors) {\n        const anchors = Array.from(document.querySelectorAll(selector));\n        for (const a of anchors) {\n          const href = (a as HTMLAnchorElement).getAttribute('href');\n          const text = a.textContent?.trim();\n          if (href && text && !seen.has(href)) {\n            seen.add(href);\n            links.push({ href, text });\n          }\n        }\n      }\n\n      return links;\n    });\n\n    await browser.close();\n\n    // Convert to DiscoveredPage format\n    const pages: DiscoveredPage[] = [];\n\n    for (const link of navLinks) {\n      try {\n        const absoluteUrl = new URL(link.href, url);\n\n        // Only include same-origin links\n        if (absoluteUrl.origin !== origin) continue;\n\n        // Skip resources\n        if (shouldSkipUrl(absoluteUrl)) continue;\n\n        pages.push({\n          url: absoluteUrl.href,\n          path: absoluteUrl.pathname,\n          title: link.text,\n          linkText: link.text,\n          depth: 1,\n        });\n      } catch {\n        // Invalid URL\n      }\n    }\n\n    // Remove duplicates by path\n    const uniquePages = new Map<string, DiscoveredPage>();\n    for (const page of pages) {\n      if (!uniquePages.has(page.path)) {\n        uniquePages.set(page.path, page);\n      }\n    }\n\n    return Array.from(uniquePages.values());\n  } catch (error) {\n    if (browser) await browser.close();\n    throw error;\n  }\n}\n","/**\n * integration.ts\n * Extract API calls from TypeScript/React component files\n *\n * Detects:\n * - fetch() calls\n * - axios methods (get, post, put, delete, patch, etc.)\n * - Template literals and variable URLs\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\n\nexport interface ApiCall {\n  endpoint: string;       // \"/api/users\" or \"https://...\" or \"${dynamic}\"\n  method: string;         // GET, POST, PUT, DELETE, PATCH, etc.\n  sourceFile: string;     // File where call was found\n  lineNumber?: number;    // Line number in source\n  callerContext?: string; // Function/component name containing the call\n  isDynamic?: boolean;    // True if endpoint uses template literals or variables\n}\n\n/**\n * Represents an API route discovered in the project\n */\nexport interface ApiRoute {\n  route: string;          // \"/api/users\", \"/api/posts/[id]\"\n  method: string[];       // [\"GET\", \"POST\"] based on exports\n  sourceFile: string;     // \"app/api/users/route.ts\"\n  isDynamic: boolean;     // Has [param] segments\n}\n\n/**\n * Extract the function/component context around a line number\n */\nfunction extractCallerContext(content: string, targetLine: number): string | undefined {\n  const lines = content.split('\\n');\n\n  // Search backwards from target line to find function/component declaration\n  for (let i = targetLine - 1; i >= Math.max(0, targetLine - 30); i--) {\n    const line = lines[i];\n\n    // Match function declarations, arrow functions, and React components\n    const functionMatch = line.match(/(?:export\\s+)?(?:async\\s+)?function\\s+(\\w+)/);\n    const arrowMatch = line.match(/(?:export\\s+)?const\\s+(\\w+)\\s*=\\s*(?:async\\s*)?\\(/);\n    const componentMatch = line.match(/(?:export\\s+)?(?:const|function)\\s+([A-Z]\\w+)/);\n\n    if (functionMatch) return functionMatch[1];\n    if (arrowMatch) return arrowMatch[1];\n    if (componentMatch) return componentMatch[1];\n  }\n\n  return undefined;\n}\n\n/**\n * Parse endpoint string, detecting dynamic parts\n */\nfunction parseEndpoint(rawEndpoint: string): { endpoint: string; isDynamic: boolean } {\n  // Check for template literal patterns\n  const hasTemplateLiteral = rawEndpoint.includes('${') || rawEndpoint.includes('`');\n\n  // Check for concatenation patterns\n  const hasConcatenation = /['\"].*\\+|^\\w+$/.test(rawEndpoint);\n\n  if (hasTemplateLiteral || hasConcatenation) {\n    return {\n      endpoint: rawEndpoint.replace(/`/g, '').replace(/\\$\\{[^}]+\\}/g, '{dynamic}'),\n      isDynamic: true\n    };\n  }\n\n  // Clean up quotes\n  return {\n    endpoint: rawEndpoint.replace(/['\"]/g, ''),\n    isDynamic: false\n  };\n}\n\n/**\n * Extract API calls from file content\n */\nfunction extractFromContent(content: string, sourceFile: string): ApiCall[] {\n  const calls: ApiCall[] = [];\n  const lines = content.split('\\n');\n\n  // Pattern 1: fetch() calls\n  // Matches: fetch('/api/users'), fetch(\"/api/users\"), fetch(`/api/${id}`)\n  const fetchPattern = /fetch\\s*\\(\\s*(['\"`])([^'\"`]+)\\1/g;\n  const fetchWithOptionsPattern = /fetch\\s*\\(\\s*(['\"`])([^'\"`]+)\\1\\s*,\\s*\\{[^}]*method\\s*:\\s*['\"](\\w+)['\"]/g;\n\n  // Pattern 2: axios method calls\n  // Matches: axios.get('/api/users'), axios.post('/api/users', data)\n  const axiosPattern = /axios\\.(get|post|put|delete|patch|head|options)\\s*\\(\\s*(['\"`])([^'\"`]+)\\2/g;\n\n  // Pattern 3: axios with method in config\n  // Matches: axios({ url: '/api/users', method: 'POST' })\n  const axiosConfigPattern = /axios\\s*\\(\\s*\\{[^}]*url\\s*:\\s*(['\"`])([^'\"`]+)\\1[^}]*method\\s*:\\s*['\"](\\w+)['\"]/g;\n\n  // Pattern 4: Template literals (more complex)\n  const templateLiteralPattern = /(?:fetch|axios(?:\\.\\w+)?)\\s*\\(\\s*`([^`]+)`/g;\n\n  // Pattern 5: Variable URLs\n  const urlVariablePattern = /const\\s+(\\w*[Uu]rl\\w*)\\s*=\\s*(['\"`])([^'\"`]+)\\2/g;\n  const urlUsagePattern = /(?:fetch|axios(?:\\.\\w+)?)\\s*\\(\\s*(\\w+)/g;\n\n  // Track URL variables\n  const urlVariables = new Map<string, { endpoint: string; lineNumber: number }>();\n\n  // First pass: collect URL variables\n  lines.forEach((line, index) => {\n    let match;\n    const urlVarRegex = new RegExp(urlVariablePattern.source, 'g');\n    while ((match = urlVarRegex.exec(line)) !== null) {\n      urlVariables.set(match[1], {\n        endpoint: match[3],\n        lineNumber: index + 1\n      });\n    }\n  });\n\n  // Second pass: extract API calls\n  lines.forEach((line, index) => {\n    const lineNumber = index + 1;\n\n    // Match fetch with explicit method\n    let match;\n    const fetchOptsRegex = new RegExp(fetchWithOptionsPattern.source, 'g');\n    while ((match = fetchOptsRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[2]);\n      calls.push({\n        endpoint,\n        method: match[3].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match basic fetch (default GET)\n    const fetchRegex = new RegExp(fetchPattern.source, 'g');\n    while ((match = fetchRegex.exec(line)) !== null) {\n      // Skip if already matched with options\n      if (!line.includes('method:')) {\n        const { endpoint, isDynamic } = parseEndpoint(match[2]);\n        calls.push({\n          endpoint,\n          method: 'GET',\n          sourceFile,\n          lineNumber,\n          callerContext: extractCallerContext(content, lineNumber),\n          isDynamic\n        });\n      }\n    }\n\n    // Match axios method calls\n    const axiosRegex = new RegExp(axiosPattern.source, 'g');\n    while ((match = axiosRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[3]);\n      calls.push({\n        endpoint,\n        method: match[1].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match axios config object\n    const axiosConfigRegex = new RegExp(axiosConfigPattern.source, 'g');\n    while ((match = axiosConfigRegex.exec(line)) !== null) {\n      const { endpoint, isDynamic } = parseEndpoint(match[2]);\n      calls.push({\n        endpoint,\n        method: match[3].toUpperCase(),\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic\n      });\n    }\n\n    // Match template literals\n    const templateRegex = new RegExp(templateLiteralPattern.source, 'g');\n    while ((match = templateRegex.exec(line)) !== null) {\n      const { endpoint } = parseEndpoint(match[1]);\n\n      // Try to determine method\n      let method = 'GET';\n      const methodMatch = line.match(/method\\s*:\\s*['\"](\\w+)['\"]/);\n      if (methodMatch) {\n        method = methodMatch[1].toUpperCase();\n      }\n\n      calls.push({\n        endpoint,\n        method,\n        sourceFile,\n        lineNumber,\n        callerContext: extractCallerContext(content, lineNumber),\n        isDynamic: true // Template literals are always dynamic\n      });\n    }\n\n    // Match variable usage\n    const urlUsageRegex = new RegExp(urlUsagePattern.source, 'g');\n    while ((match = urlUsageRegex.exec(line)) !== null) {\n      const varName = match[1];\n      if (urlVariables.has(varName)) {\n        const urlInfo = urlVariables.get(varName)!;\n        const { endpoint, isDynamic } = parseEndpoint(urlInfo.endpoint);\n\n        // Try to determine method\n        let method = 'GET';\n        const methodMatch = line.match(/method\\s*:\\s*['\"](\\w+)['\"]/);\n        if (methodMatch) {\n          method = methodMatch[1].toUpperCase();\n        }\n\n        calls.push({\n          endpoint,\n          method,\n          sourceFile,\n          lineNumber,\n          callerContext: extractCallerContext(content, lineNumber),\n          isDynamic\n        });\n      }\n    }\n  });\n\n  // Deduplicate calls (same endpoint, method, and line)\n  const uniqueCalls = calls.filter((call, index, self) =>\n    index === self.findIndex((c) =>\n      c.endpoint === call.endpoint &&\n      c.method === call.method &&\n      c.lineNumber === call.lineNumber\n    )\n  );\n\n  return uniqueCalls;\n}\n\n/**\n * Parse a single file for fetch/axios calls\n *\n * @param filePath - Absolute path to TypeScript/React file\n * @returns Array of API calls found in the file\n */\nexport async function extractApiCalls(filePath: string): Promise<ApiCall[]> {\n  try {\n    const content = await fs.readFile(filePath, 'utf-8');\n    return extractFromContent(content, filePath);\n  } catch (error) {\n    console.error(`Error reading file ${filePath}:`, error);\n    return [];\n  }\n}\n\n/**\n * Recursively scan directory for TypeScript/React files and extract API calls\n *\n * @param dir - Directory to scan\n * @param pattern - File pattern to match (default: TypeScript/React files)\n * @returns Array of all API calls found\n */\nexport async function scanDirectoryForApiCalls(\n  dir: string,\n  _pattern: string = '**/*.{ts,tsx,js,jsx}'\n): Promise<ApiCall[]> {\n  const allCalls: ApiCall[] = [];\n\n  async function scanDir(currentDir: string): Promise<void> {\n    try {\n      const entries = await fs.readdir(currentDir, { withFileTypes: true });\n\n      for (const entry of entries) {\n        const fullPath = path.join(currentDir, entry.name);\n\n        if (entry.isDirectory()) {\n          // Skip node_modules, dist, build, .next, etc.\n          const skipDirs = ['node_modules', 'dist', 'build', '.git', 'coverage', '.next', '__tests__', '__mocks__'];\n          if (!skipDirs.includes(entry.name)) {\n            await scanDir(fullPath);\n          }\n        } else if (entry.isFile()) {\n          // Check if file matches pattern\n          const ext = path.extname(entry.name);\n          if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n            // Skip test files, spec files, and files with example patterns\n            const isTestFile = entry.name.includes('.test.') ||\n                              entry.name.includes('.spec.') ||\n                              entry.name.includes('.mock.') ||\n                              entry.name === 'integration.ts'; // Skip self (contains example patterns)\n            if (!isTestFile) {\n              const calls = await extractApiCalls(fullPath);\n              allCalls.push(...calls);\n            }\n          }\n        }\n      }\n    } catch (error) {\n      console.error(`Error scanning directory ${currentDir}:`, error);\n    }\n  }\n\n  await scanDir(dir);\n  return allCalls;\n}\n\n/**\n * Group API calls by endpoint\n */\nexport function groupByEndpoint(calls: ApiCall[]): Map<string, ApiCall[]> {\n  const grouped = new Map<string, ApiCall[]>();\n\n  for (const call of calls) {\n    const key = call.endpoint;\n    if (!grouped.has(key)) {\n      grouped.set(key, []);\n    }\n    grouped.get(key)!.push(call);\n  }\n\n  return grouped;\n}\n\n/**\n * Group API calls by source file\n */\nexport function groupByFile(calls: ApiCall[]): Map<string, ApiCall[]> {\n  const grouped = new Map<string, ApiCall[]>();\n\n  for (const call of calls) {\n    const key = call.sourceFile;\n    if (!grouped.has(key)) {\n      grouped.set(key, []);\n    }\n    grouped.get(key)!.push(call);\n  }\n\n  return grouped;\n}\n\n/**\n * Filter calls to only include specific HTTP methods\n */\nexport function filterByMethod(calls: ApiCall[], methods: string[]): ApiCall[] {\n  const upperMethods = methods.map(m => m.toUpperCase());\n  return calls.filter(call => upperMethods.includes(call.method));\n}\n\n/**\n * Filter calls to only include specific endpoints (supports wildcards)\n */\nexport function filterByEndpoint(calls: ApiCall[], endpointPattern: string): ApiCall[] {\n  const regex = new RegExp(\n    '^' + endpointPattern.replace(/\\*/g, '.*').replace(/\\?/g, '.') + '$'\n  );\n  return calls.filter(call => regex.test(call.endpoint));\n}\n\n/**\n * Discover API routes from Next.js/Remix file structure\n * Supports Next.js App Router (app/api) and Pages Router (pages/api)\n * Also searches subdirectories (like web-ui/) for nested Next.js apps\n */\nexport async function discoverApiRoutes(projectDir: string): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  // Discover routes in a specific directory\n  async function discoverInDir(dir: string): Promise<void> {\n    // Check for Next.js App Router (app/api/**/route.ts)\n    const appApiDir = path.join(dir, 'app', 'api');\n    if (await directoryExists(appApiDir)) {\n      const appRoutes = await discoverAppRouterRoutes(appApiDir, dir);\n      routes.push(...appRoutes);\n    }\n\n    // Check for Next.js Pages Router (pages/api/**/*.ts)\n    const pagesApiDir = path.join(dir, 'pages', 'api');\n    if (await directoryExists(pagesApiDir)) {\n      const pagesRoutes = await discoverPagesRouterRoutes(pagesApiDir, dir);\n      routes.push(...pagesRoutes);\n    }\n\n    // Check for src directory variants\n    const srcAppApiDir = path.join(dir, 'src', 'app', 'api');\n    if (await directoryExists(srcAppApiDir)) {\n      const srcAppRoutes = await discoverAppRouterRoutes(srcAppApiDir, dir);\n      routes.push(...srcAppRoutes);\n    }\n\n    const srcPagesApiDir = path.join(dir, 'src', 'pages', 'api');\n    if (await directoryExists(srcPagesApiDir)) {\n      const srcPagesRoutes = await discoverPagesRouterRoutes(srcPagesApiDir, dir);\n      routes.push(...srcPagesRoutes);\n    }\n  }\n\n  // Discover in project root\n  await discoverInDir(projectDir);\n\n  // Also check subdirectories for nested apps (e.g., web-ui/, frontend/, client/)\n  try {\n    const entries = await fs.readdir(projectDir, { withFileTypes: true });\n    const skipDirs = ['node_modules', 'dist', 'build', '.git', 'coverage', '.next'];\n\n    for (const entry of entries) {\n      if (entry.isDirectory() && !skipDirs.includes(entry.name)) {\n        const subDir = path.join(projectDir, entry.name);\n\n        // Check if this subdir has a package.json (indicating it's a sub-project)\n        const hasPackageJson = await fileExists(path.join(subDir, 'package.json'));\n        if (hasPackageJson) {\n          await discoverInDir(subDir);\n        }\n      }\n    }\n  } catch {\n    // Ignore errors reading directory\n  }\n\n  return routes;\n}\n\n/**\n * Check if a file exists\n */\nasync function fileExists(filePath: string): Promise<boolean> {\n  try {\n    const stat = await fs.stat(filePath);\n    return stat.isFile();\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Convert file path to API route\n * Examples:\n * - app/api/users/route.ts -> /api/users\n * - app/api/users/[id]/route.ts -> /api/users/[id]\n * - pages/api/users.ts -> /api/users\n * - pages/api/users/[id].ts -> /api/users/[id]\n */\nexport function filePathToRoute(filePath: string, projectDir: string): string {\n  // Normalize paths\n  const normalizedFilePath = path.normalize(filePath);\n  const normalizedProjectDir = path.normalize(projectDir);\n\n  // Get relative path from project root\n  const relativePath = path.relative(normalizedProjectDir, normalizedFilePath);\n\n  // Remove file extension\n  let routePath = relativePath.replace(/\\.(ts|tsx|js|jsx)$/, '');\n\n  // Handle App Router (remove 'route' filename)\n  routePath = routePath.replace(/\\/route$/, '');\n  routePath = routePath.replace(/\\\\route$/, ''); // Windows paths\n\n  // Extract the API portion\n  let apiPath = '';\n\n  if (routePath.includes('app/api/') || routePath.includes('app\\\\api\\\\')) {\n    apiPath = routePath.split(/app[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('src/app/api/') || routePath.includes('src\\\\app\\\\api\\\\')) {\n    apiPath = routePath.split(/src[/\\\\]app[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('pages/api/') || routePath.includes('pages\\\\api\\\\')) {\n    apiPath = routePath.split(/pages[/\\\\]api[/\\\\]/)[1] || '';\n  } else if (routePath.includes('src/pages/api/') || routePath.includes('src\\\\pages\\\\api\\\\')) {\n    apiPath = routePath.split(/src[/\\\\]pages[/\\\\]api[/\\\\]/)[1] || '';\n  }\n\n  // Convert to route format (normalize path separators)\n  const route = '/api/' + (apiPath ? apiPath.replace(/\\\\/g, '/') : '');\n\n  return route;\n}\n\n/**\n * Cross-reference API calls against routes, return orphans\n */\nexport function findOrphanEndpoints(\n  apiCalls: ApiCall[],\n  apiRoutes: ApiRoute[]\n): { call: ApiCall; searchedLocations: string[] }[] {\n  const orphans: { call: ApiCall; searchedLocations: string[] }[] = [];\n\n  for (const call of apiCalls) {\n    const endpoint = call.endpoint;\n\n    // Skip non-API endpoints (external URLs, relative paths without /api)\n    if (!endpoint.startsWith('/api') && !endpoint.includes('/api/')) {\n      continue;\n    }\n\n    // Skip dynamic endpoints that are just placeholders\n    if (endpoint.includes('{dynamic}')) {\n      continue;\n    }\n\n    // Extract the API path\n    let apiPath = endpoint;\n    if (endpoint.includes('/api/')) {\n      apiPath = '/api/' + endpoint.split('/api/')[1].split('?')[0]; // Remove query params\n    }\n\n    // Try to match against routes\n    const matchedRoute = apiRoutes.find(route => {\n      // Check if methods match\n      const methodMatches = route.method.includes(call.method) ||\n                           route.method.includes('ALL');\n      if (!methodMatches) {\n        return false;\n      }\n      // Check if route pattern matches endpoint\n      return routeMatchesEndpoint(route.route, apiPath);\n    });\n\n    if (!matchedRoute) {\n      // Generate possible file locations\n      const searchedLocations = generatePossibleRouteFiles(apiPath);\n\n      orphans.push({\n        call,\n        searchedLocations\n      });\n    }\n  }\n\n  return orphans;\n}\n\n/**\n * Check if a route pattern matches an endpoint\n * Handles dynamic segments like [id], [slug], etc.\n */\nfunction routeMatchesEndpoint(routePattern: string, endpoint: string): boolean {\n  const routeParts = routePattern.split('/').filter(Boolean);\n  const endpointParts = endpoint.split('/').filter(Boolean);\n\n  if (routeParts.length !== endpointParts.length) {\n    return false;\n  }\n\n  for (let i = 0; i < routeParts.length; i++) {\n    const routePart = routeParts[i];\n    const endpointPart = endpointParts[i];\n\n    // Dynamic segment matches anything\n    if (routePart.startsWith('[') && routePart.endsWith(']')) {\n      continue;\n    }\n\n    // Static segment must match exactly\n    if (routePart !== endpointPart) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Generate possible file locations for an API endpoint\n */\nfunction generatePossibleRouteFiles(apiPath: string): string[] {\n  const pathWithoutApi = apiPath.replace(/^\\/api\\//, '');\n  const locations: string[] = [];\n\n  // Next.js App Router possibilities\n  locations.push(`app/api/${pathWithoutApi}/route.ts`);\n  locations.push(`app/api/${pathWithoutApi}/route.js`);\n  locations.push(`src/app/api/${pathWithoutApi}/route.ts`);\n  locations.push(`src/app/api/${pathWithoutApi}/route.js`);\n\n  // Next.js Pages Router possibilities\n  locations.push(`pages/api/${pathWithoutApi}.ts`);\n  locations.push(`pages/api/${pathWithoutApi}.js`);\n  locations.push(`src/pages/api/${pathWithoutApi}.ts`);\n  locations.push(`src/pages/api/${pathWithoutApi}.js`);\n\n  return locations;\n}\n\n/**\n * Discover routes in Next.js App Router format\n */\nasync function discoverAppRouterRoutes(\n  apiDir: string,\n  projectDir: string\n): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  try {\n    const files = await findRouteFiles(apiDir, 'route');\n\n    for (const file of files) {\n      const content = await fs.readFile(file, 'utf-8');\n      const methods = extractHttpMethods(content);\n      const route = filePathToRoute(file, projectDir);\n      const isDynamic = route.includes('[') && route.includes(']');\n\n      if (methods.length > 0) {\n        routes.push({\n          route,\n          method: methods,\n          sourceFile: file,\n          isDynamic\n        });\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return routes;\n}\n\n/**\n * Discover routes in Next.js Pages Router format\n */\nasync function discoverPagesRouterRoutes(\n  apiDir: string,\n  projectDir: string\n): Promise<ApiRoute[]> {\n  const routes: ApiRoute[] = [];\n\n  try {\n    const files = await findRouteFiles(apiDir);\n\n    for (const file of files) {\n      const content = await fs.readFile(file, 'utf-8');\n      const methods = extractHttpMethods(content);\n      const route = filePathToRoute(file, projectDir);\n      const isDynamic = route.includes('[') && route.includes(']');\n\n      // Pages Router typically uses default export with req.method check\n      // If we find method checks or it has a default export, include it\n      if (methods.length > 0 || content.includes('export default')) {\n        routes.push({\n          route,\n          method: methods.length > 0 ? methods : ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n          sourceFile: file,\n          isDynamic\n        });\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return routes;\n}\n\n/**\n * Find all route files in a directory recursively\n */\nasync function findRouteFiles(\n  dir: string,\n  filename?: string\n): Promise<string[]> {\n  const files: string[] = [];\n\n  try {\n    const entries = await fs.readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = path.join(dir, entry.name);\n\n      if (entry.isDirectory()) {\n        const subFiles = await findRouteFiles(fullPath, filename);\n        files.push(...subFiles);\n      } else if (entry.isFile()) {\n        const ext = path.extname(entry.name);\n        const baseName = path.basename(entry.name, ext);\n\n        if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n          if (filename) {\n            // Looking for specific filename (e.g., 'route.ts')\n            if (baseName === filename) {\n              files.push(fullPath);\n            }\n          } else {\n            // Include all TypeScript/JavaScript files\n            files.push(fullPath);\n          }\n        }\n      }\n    }\n  } catch (error) {\n    // Directory doesn't exist or not accessible\n  }\n\n  return files;\n}\n\n/**\n * Extract HTTP method exports from file content\n */\nfunction extractHttpMethods(content: string): string[] {\n  const methods: string[] = [];\n  const httpMethods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS'];\n\n  for (const method of httpMethods) {\n    // Look for exported functions: export async function GET\n    const exportPattern = new RegExp(`export\\\\s+(?:async\\\\s+)?function\\\\s+${method}\\\\s*\\\\(`, 'g');\n    if (exportPattern.test(content)) {\n      methods.push(method);\n    }\n  }\n\n  return methods;\n}\n\n/**\n * Check if a directory exists\n */\nasync function directoryExists(dir: string): Promise<boolean> {\n  try {\n    const stat = await fs.stat(dir);\n    return stat.isDirectory();\n  } catch {\n    return false;\n  }\n}\n\n// TODO: Iteration 3 - Add matching between frontend API calls and backend routes (DONE via findOrphanEndpoints)\n// TODO: Iteration 4 - Add OpenAPI/Swagger schema generation from discovered routes\n","import { nanoid } from 'nanoid';\nimport { readFile, writeFile, mkdir } from 'fs/promises';\nimport { join, dirname } from 'path';\n\nconst OPERATION_PREFIX = 'op_';\n\n/**\n * Pending operation types\n */\nexport type OperationType = 'screenshot' | 'type' | 'click' | 'navigate' | 'evaluate' | 'fill' | 'hover' | 'wait';\n\n/**\n * A pending operation that's currently running\n */\nexport interface PendingOperation {\n  id: string;\n  type: OperationType;\n  sessionId: string;\n  startedAt: string;\n  pid: number;\n  command?: string;\n}\n\n/**\n * State file structure\n */\nexport interface OperationState {\n  pending: PendingOperation[];\n  lastUpdated: string;\n}\n\n/**\n * Get the path to the operations state file\n */\nfunction getOperationsPath(outputDir: string): string {\n  return join(outputDir, 'operations.json');\n}\n\n/**\n * Read the current operation state\n */\nasync function readState(outputDir: string): Promise<OperationState> {\n  const path = getOperationsPath(outputDir);\n  try {\n    const content = await readFile(path, 'utf-8');\n    return JSON.parse(content) as OperationState;\n  } catch {\n    return { pending: [], lastUpdated: new Date().toISOString() };\n  }\n}\n\n/**\n * Write the operation state\n */\nasync function writeState(outputDir: string, state: OperationState): Promise<void> {\n  const path = getOperationsPath(outputDir);\n  await mkdir(dirname(path), { recursive: true });\n  state.lastUpdated = new Date().toISOString();\n  await writeFile(path, JSON.stringify(state, null, 2));\n}\n\n/**\n * Register a new pending operation\n * Returns the operation ID\n */\nexport async function registerOperation(\n  outputDir: string,\n  options: {\n    type: OperationType;\n    sessionId: string;\n    command?: string;\n  }\n): Promise<string> {\n  const state = await readState(outputDir);\n\n  // Clean up stale operations from dead processes\n  state.pending = await cleanupStaleOperations(state.pending);\n\n  const operation: PendingOperation = {\n    id: `${OPERATION_PREFIX}${nanoid(8)}`,\n    type: options.type,\n    sessionId: options.sessionId,\n    startedAt: new Date().toISOString(),\n    pid: process.pid,\n    command: options.command,\n  };\n\n  state.pending.push(operation);\n  await writeState(outputDir, state);\n\n  return operation.id;\n}\n\n/**\n * Mark an operation as complete (remove from pending)\n */\nexport async function completeOperation(\n  outputDir: string,\n  operationId: string\n): Promise<void> {\n  const state = await readState(outputDir);\n  state.pending = state.pending.filter(op => op.id !== operationId);\n  await writeState(outputDir, state);\n}\n\n/**\n * Get all pending operations\n */\nexport async function getPendingOperations(\n  outputDir: string\n): Promise<PendingOperation[]> {\n  const state = await readState(outputDir);\n  // Clean up stale operations before returning\n  const activeOps = await cleanupStaleOperations(state.pending);\n\n  // Update state if we cleaned up anything\n  if (activeOps.length !== state.pending.length) {\n    state.pending = activeOps;\n    await writeState(outputDir, state);\n  }\n\n  return activeOps;\n}\n\n/**\n * Check if a process is still running\n */\nfunction isProcessAlive(pid: number): boolean {\n  try {\n    process.kill(pid, 0);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Remove operations from dead processes\n */\nasync function cleanupStaleOperations(\n  operations: PendingOperation[]\n): Promise<PendingOperation[]> {\n  return operations.filter(op => isProcessAlive(op.pid));\n}\n\n/**\n * Wait for all pending operations to complete\n * Returns true if all completed, false if timeout reached\n */\nexport async function waitForCompletion(\n  outputDir: string,\n  options: {\n    timeout?: number;\n    pollInterval?: number;\n    onProgress?: (remaining: number) => void;\n  } = {}\n): Promise<boolean> {\n  const timeout = options.timeout ?? 30000;\n  const pollInterval = options.pollInterval ?? 500;\n  const startTime = Date.now();\n\n  while (Date.now() - startTime < timeout) {\n    const pending = await getPendingOperations(outputDir);\n\n    if (pending.length === 0) {\n      return true;\n    }\n\n    if (options.onProgress) {\n      options.onProgress(pending.length);\n    }\n\n    await new Promise(resolve => setTimeout(resolve, pollInterval));\n  }\n\n  return false;\n}\n\n/**\n * Format pending operations for display\n */\nexport function formatPendingOperations(operations: PendingOperation[]): string {\n  if (operations.length === 0) {\n    return 'No pending operations';\n  }\n\n  const lines = operations.map(op => {\n    const age = Math.round((Date.now() - new Date(op.startedAt).getTime()) / 1000);\n    return `  ${op.id.slice(0, 11)} | ${op.type.padEnd(10)} | ${op.sessionId.slice(0, 12)} | ${age}s`;\n  });\n\n  return [\n    '  ID          | Type       | Session      | Age',\n    '  ----------- | ---------- | ------------ | ---',\n    ...lines,\n  ].join('\\n');\n}\n\n/**\n * Higher-order function to wrap an async operation with tracking\n */\nexport function withOperationTracking<T>(\n  outputDir: string,\n  options: {\n    type: OperationType;\n    sessionId: string;\n    command?: string;\n  }\n) {\n  return async (fn: () => Promise<T>): Promise<T> => {\n    const opId = await registerOperation(outputDir, options);\n    try {\n      return await fn();\n    } finally {\n      await completeOperation(outputDir, opId);\n    }\n  };\n}\n","import { ConfigSchema, VIEWPORTS, type Config, type Session, type SessionQuery, type ComparisonReport, type Viewport } from './schemas.js';\nimport { captureScreenshot, captureWithLandmarks, closeBrowser } from './capture.js';\nimport { compareImages, analyzeComparison } from './compare.js';\nimport {\n  createSession,\n  getSession,\n  updateSession,\n  markSessionCompared,\n  listSessions,\n  getMostRecentSession,\n  deleteSession,\n  cleanSessions,\n  getSessionPaths,\n  findSessions,\n  getTimeline,\n  getSessionsByRoute,\n  getSessionStats,\n} from './session.js';\nimport { generateReport } from './report.js';\nimport type { StartSessionOptions, StartSessionResult, CleanOptions } from './types.js';\nimport { getSemanticOutput, formatSemanticText, type SemanticResult } from './semantic/index.js';\nimport { loginFlow, searchFlow, formFlow, type FlowLoginOptions, type FlowSearchOptions, type FlowFormOptions } from './flows/index.js';\nimport { chromium, type Page, type Browser, type BrowserContext } from 'playwright';\nimport { mkdir, access } from 'fs/promises';\nimport { join, dirname } from 'path';\nimport { tmpdir } from 'os';\nimport { maybeAutoClean } from './cleanup.js';\n\n// ============================================================================\n// STANDALONE PROGRAMMATIC API\n// These functions provide first-class programmatic comparison without\n// requiring session management or CLI wrappers.\n// ============================================================================\n\n/**\n * Options for standalone compare function\n */\nexport interface CompareInput {\n  /** URL to capture and compare (will auto-capture current state) */\n  url?: string;\n  /** Path to baseline image (required if no url) */\n  baselinePath?: string;\n  /** Path to current image (auto-captured if url provided) */\n  currentPath?: string;\n  /** Pixel difference threshold (0-100, default 1.0) */\n  threshold?: number;\n  /** Output directory for diff and temp files */\n  outputDir?: string;\n  /** Viewport configuration */\n  viewport?: 'desktop' | 'mobile' | 'tablet' | Viewport;\n  /** Capture full page */\n  fullPage?: boolean;\n  /** Wait for network idle before capture */\n  waitForNetworkIdle?: boolean;\n  /** Capture timeout in ms */\n  timeout?: number;\n}\n\n/**\n * Result from standalone compare function\n */\nexport interface CompareResult {\n  /** Whether images match within threshold */\n  match: boolean;\n  /** Percentage of pixels that differ */\n  diffPercent: number;\n  /** Number of differing pixels */\n  diffPixels: number;\n  /** Total pixels compared */\n  totalPixels: number;\n  /** Analysis verdict: MATCH, EXPECTED_CHANGE, UNEXPECTED_CHANGE, LAYOUT_BROKEN */\n  verdict: string;\n  /** Human-readable summary */\n  summary: string;\n  /** Regions with changes */\n  changedRegions: Array<{\n    location: string;\n    description: string;\n    severity: 'expected' | 'unexpected' | 'critical';\n  }>;\n  /** Recommendation for fixing issues */\n  recommendation: string | null;\n  /** Path to diff image (if generated) */\n  diffPath?: string;\n  /** Path to baseline used */\n  baselinePath: string;\n  /** Path to current image used */\n  currentPath: string;\n}\n\n/**\n * Standalone compare function - compare images without session management\n *\n * @example\n * ```typescript\n * // Compare by URL (auto-captures current state)\n * const result = await compare({\n *   url: 'http://localhost:3000',\n *   baselinePath: './baseline.png'\n * });\n *\n * // Compare two existing images\n * const result = await compare({\n *   baselinePath: './baseline.png',\n *   currentPath: './current.png'\n * });\n *\n * // Compare URL with auto threshold\n * const result = await compare({\n *   url: 'http://localhost:3000',\n *   baselinePath: './baseline.png',\n *   threshold: 0.5  // 0.5% difference allowed\n * });\n * ```\n */\nexport async function compare(options: CompareInput): Promise<CompareResult> {\n  const {\n    url,\n    baselinePath,\n    currentPath,\n    threshold = 1.0,\n    outputDir = join(tmpdir(), 'ibr-compare'),\n    viewport = 'desktop',\n    fullPage = true,\n    waitForNetworkIdle = true,\n    timeout = 30000,\n  } = options;\n\n  // Validate inputs\n  if (!baselinePath && !url) {\n    throw new Error('Either baselinePath or url must be provided');\n  }\n\n  // Resolve viewport\n  const resolvedViewport: Viewport = typeof viewport === 'string'\n    ? VIEWPORTS[viewport] || VIEWPORTS.desktop\n    : viewport;\n\n  // Create output directory\n  await mkdir(outputDir, { recursive: true });\n\n  // Determine paths\n  const timestamp = Date.now();\n  const actualBaselinePath = baselinePath || join(outputDir, `baseline-${timestamp}.png`);\n  let actualCurrentPath = currentPath || join(outputDir, `current-${timestamp}.png`);\n  const diffPath = join(outputDir, `diff-${timestamp}.png`);\n\n  // If URL provided but no baseline, capture baseline first\n  if (url && !baselinePath) {\n    await captureScreenshot({\n      url,\n      outputPath: actualBaselinePath,\n      viewport: resolvedViewport,\n      fullPage,\n      waitForNetworkIdle,\n      timeout,\n    });\n  }\n\n  // If URL provided, capture current state\n  if (url && !currentPath) {\n    await captureScreenshot({\n      url,\n      outputPath: actualCurrentPath,\n      viewport: resolvedViewport,\n      fullPage,\n      waitForNetworkIdle,\n      timeout,\n    });\n  }\n\n  // Verify files exist\n  try {\n    await access(actualBaselinePath);\n  } catch {\n    throw new Error(`Baseline image not found: ${actualBaselinePath}`);\n  }\n  try {\n    await access(actualCurrentPath);\n  } catch {\n    throw new Error(`Current image not found: ${actualCurrentPath}`);\n  }\n\n  // Compare images\n  const comparison = await compareImages({\n    baselinePath: actualBaselinePath,\n    currentPath: actualCurrentPath,\n    diffPath,\n    threshold: threshold / 100, // Convert percentage to 0-1 for pixelmatch\n  });\n\n  // Analyze results\n  const analysis = analyzeComparison(comparison, threshold);\n\n  // Close browser if we opened one\n  await closeBrowser();\n\n  return {\n    match: comparison.match,\n    diffPercent: comparison.diffPercent,\n    diffPixels: comparison.diffPixels,\n    totalPixels: comparison.totalPixels,\n    verdict: analysis.verdict,\n    summary: analysis.summary,\n    changedRegions: analysis.changedRegions.map(r => ({\n      location: r.location,\n      description: r.description,\n      severity: r.severity,\n    })),\n    recommendation: analysis.recommendation,\n    diffPath: comparison.match ? undefined : diffPath,\n    baselinePath: actualBaselinePath,\n    currentPath: actualCurrentPath,\n  };\n}\n\n/**\n * Options for batch comparison\n */\nexport interface CompareAllInput {\n  /** Session ID to compare (uses most recent if not provided) */\n  sessionId?: string;\n  /** Output directory (defaults to .ibr) */\n  outputDir?: string;\n  /** Only compare sessions matching this URL pattern */\n  urlPattern?: string | RegExp;\n  /** Only compare sessions with these statuses */\n  statuses?: Array<'baseline' | 'compared' | 'pending'>;\n  /** Maximum number of sessions to compare */\n  limit?: number;\n}\n\n/**\n * Batch compare all sessions or a filtered subset\n *\n * @example\n * ```typescript\n * // Compare all sessions\n * const results = await compareAll();\n *\n * // Compare sessions matching URL\n * const results = await compareAll({\n *   urlPattern: /\\/dashboard/\n * });\n *\n * // Compare specific session\n * const results = await compareAll({\n *   sessionId: 'sess_abc123'\n * });\n * ```\n */\nexport async function compareAll(options: CompareAllInput = {}): Promise<CompareResult[]> {\n  const {\n    sessionId,\n    outputDir = './.ibr',\n    urlPattern,\n    statuses = ['baseline'],\n    limit = 50,\n  } = options;\n\n  const results: CompareResult[] = [];\n\n  if (sessionId) {\n    // Compare single session\n    const session = await getSession(outputDir, sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${sessionId}`);\n    }\n    const paths = getSessionPaths(outputDir, session.id);\n\n    const result = await compare({\n      url: session.url,\n      baselinePath: paths.baseline,\n      outputDir: dirname(paths.diff),\n      viewport: session.viewport,\n    });\n\n    results.push(result);\n  } else {\n    // Get all matching sessions\n    let sessions = await listSessions(outputDir);\n\n    // Filter by status\n    sessions = sessions.filter(s => statuses.includes(s.status as 'baseline' | 'compared' | 'pending'));\n\n    // Filter by URL pattern\n    if (urlPattern) {\n      const pattern = typeof urlPattern === 'string' ? new RegExp(urlPattern) : urlPattern;\n      sessions = sessions.filter(s => pattern.test(s.url));\n    }\n\n    // Apply limit\n    sessions = sessions.slice(0, limit);\n\n    // Compare each session\n    for (const session of sessions) {\n      try {\n        const paths = getSessionPaths(outputDir, session.id);\n        const result = await compare({\n          url: session.url,\n          baselinePath: paths.baseline,\n          outputDir: dirname(paths.diff),\n          viewport: session.viewport,\n        });\n        results.push(result);\n      } catch (err) {\n        // Continue on individual session failures\n        console.warn(`Failed to compare session ${session.id}: ${err}`);\n      }\n    }\n  }\n\n  // Close browser after all comparisons\n  await closeBrowser();\n\n  return results;\n}\n\n// ============================================================================\n// CLASS-BASED API (Original)\n// ============================================================================\n\nexport class InterfaceBuiltRight {\n  private config: Config;\n\n  constructor(options: Partial<Config> = {}) {\n    // Validate and merge with defaults\n    this.config = ConfigSchema.parse(options);\n  }\n\n  /**\n   * Start a visual session by capturing a baseline screenshot\n   */\n  async startSession(path: string, options: StartSessionOptions = {}): Promise<StartSessionResult> {\n    const {\n      name = this.generateSessionName(path),\n      viewport = this.config.viewport,\n      fullPage = this.config.fullPage,\n      selector,\n      waitFor,\n    } = options;\n\n    const url = this.resolveUrl(path);\n\n    // Create session\n    const session = await createSession(this.config.outputDir, url, name, viewport);\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture baseline with landmark detection (outputDir enables auth state loading)\n    const captureResult = await captureWithLandmarks({\n      url,\n      outputPath: paths.baseline,\n      viewport,\n      fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n      selector,\n      waitFor,\n    });\n\n    // Update session with detected landmarks and page intent\n    const updatedSession = await updateSession(this.config.outputDir, session.id, {\n      landmarkElements: captureResult.landmarkElements,\n      pageIntent: captureResult.pageIntent,\n    });\n\n    // Run auto-cleanup if enabled in retention config\n    await maybeAutoClean(this.config.outputDir);\n\n    return {\n      sessionId: session.id,\n      baseline: paths.baseline,\n      session: updatedSession,\n    };\n  }\n\n  /**\n   * Check current state against baseline\n   */\n  async check(sessionId?: string): Promise<ComparisonReport> {\n    // Get session\n    const session = sessionId\n      ? await getSession(this.config.outputDir, sessionId)\n      : await getMostRecentSession(this.config.outputDir);\n\n    if (!session) {\n      throw new Error(sessionId\n        ? `Session not found: ${sessionId}`\n        : 'No sessions found. Run startSession first.');\n    }\n\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture current screenshot (outputDir enables auth state loading)\n    await captureScreenshot({\n      url: session.url,\n      outputPath: paths.current,\n      viewport: session.viewport,\n      fullPage: this.config.fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n    });\n\n    // Compare images\n    const comparison = await compareImages({\n      baselinePath: paths.baseline,\n      currentPath: paths.current,\n      diffPath: paths.diff,\n      threshold: this.config.threshold / 100, // Convert percentage to 0-1 range for pixelmatch\n    });\n\n    // Analyze results\n    const analysis = analyzeComparison(comparison, this.config.threshold);\n\n    // Update session\n    await markSessionCompared(this.config.outputDir, session.id, comparison, analysis);\n\n    // Generate report\n    return generateReport(session, comparison, analysis, this.config.outputDir);\n  }\n\n  /**\n   * Get a session by ID\n   */\n  async getSession(sessionId: string): Promise<Session | null> {\n    return getSession(this.config.outputDir, sessionId);\n  }\n\n  /**\n   * Get the most recent session\n   */\n  async getMostRecentSession(): Promise<Session | null> {\n    return getMostRecentSession(this.config.outputDir);\n  }\n\n  /**\n   * List all sessions\n   */\n  async listSessions(): Promise<Session[]> {\n    return listSessions(this.config.outputDir);\n  }\n\n  /**\n   * Delete a session\n   */\n  async deleteSession(sessionId: string): Promise<boolean> {\n    return deleteSession(this.config.outputDir, sessionId);\n  }\n\n  /**\n   * Clean old sessions\n   */\n  async clean(options: CleanOptions = {}): Promise<{ deleted: string[]; kept: string[] }> {\n    return cleanSessions(this.config.outputDir, options);\n  }\n\n  /**\n   * Find sessions matching query criteria\n   */\n  async find(query: Partial<SessionQuery> = {}): Promise<Session[]> {\n    return findSessions(this.config.outputDir, query);\n  }\n\n  /**\n   * Get timeline of sessions for a specific route\n   * Returns sessions in chronological order (oldest first)\n   */\n  async getTimeline(route: string, limit: number = 10): Promise<Session[]> {\n    return getTimeline(this.config.outputDir, route, limit);\n  }\n\n  /**\n   * Get sessions grouped by route\n   */\n  async getSessionsByRoute(): Promise<Record<string, Session[]>> {\n    return getSessionsByRoute(this.config.outputDir);\n  }\n\n  /**\n   * Get session statistics\n   */\n  async getStats(): Promise<{\n    total: number;\n    byStatus: Record<string, number>;\n    byViewport: Record<string, number>;\n    byVerdict: Record<string, number>;\n  }> {\n    return getSessionStats(this.config.outputDir);\n  }\n\n  /**\n   * Update baseline with current screenshot\n   */\n  async updateBaseline(sessionId?: string): Promise<Session> {\n    const session = sessionId\n      ? await getSession(this.config.outputDir, sessionId)\n      : await getMostRecentSession(this.config.outputDir);\n\n    if (!session) {\n      throw new Error(sessionId\n        ? `Session not found: ${sessionId}`\n        : 'No sessions found.');\n    }\n\n    const paths = getSessionPaths(this.config.outputDir, session.id);\n\n    // Capture new baseline (outputDir enables auth state loading)\n    await captureScreenshot({\n      url: session.url,\n      outputPath: paths.baseline,\n      viewport: session.viewport,\n      fullPage: this.config.fullPage,\n      waitForNetworkIdle: this.config.waitForNetworkIdle,\n      timeout: this.config.timeout,\n      outputDir: this.config.outputDir,\n    });\n\n    // Reset session status\n    return updateSession(this.config.outputDir, session.id, {\n      status: 'baseline',\n      comparison: undefined,\n      analysis: undefined,\n    });\n  }\n\n  /**\n   * Start a simplified session with semantic understanding\n   *\n   * This is the new simpler API - one line to start:\n   * ```typescript\n   * const session = await ibr.start('http://localhost:3000');\n   * const understanding = await session.understand();\n   * ```\n   */\n  async start(url: string, options: {\n    viewport?: 'desktop' | 'mobile' | 'tablet';\n    waitFor?: string;\n    timeout?: number;\n  } = {}): Promise<IBRSession> {\n    const fullUrl = this.resolveUrl(url);\n    const viewportName = options.viewport || 'desktop';\n    const viewport = VIEWPORTS[viewportName];\n\n    // Launch browser\n    const browser = await chromium.launch({ headless: true });\n    const context = await browser.newContext({\n      viewport,\n      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',\n    });\n    const page = await context.newPage();\n\n    // Navigate\n    await page.goto(fullUrl, {\n      waitUntil: 'domcontentloaded',\n      timeout: options.timeout || this.config.timeout,\n    });\n\n    // Wait for network idle\n    if (this.config.waitForNetworkIdle) {\n      await page.waitForLoadState('networkidle', { timeout: 10000 }).catch(() => {});\n    }\n\n    // Wait for specific selector if provided\n    if (options.waitFor) {\n      await page.waitForSelector(options.waitFor, { timeout: 10000 }).catch(() => {});\n    }\n\n    return new IBRSession(page, browser, context, this.config);\n  }\n\n  /**\n   * Close the browser instance\n   */\n  async close(): Promise<void> {\n    await closeBrowser();\n  }\n\n  /**\n   * Get configuration\n   */\n  getConfig(): Config {\n    return { ...this.config };\n  }\n\n  /**\n   * Resolve a path to full URL\n   */\n  private resolveUrl(path: string): string {\n    if (path.startsWith('http://') || path.startsWith('https://')) {\n      return path;\n    }\n    return `${this.config.baseUrl}${path.startsWith('/') ? path : `/${path}`}`;\n  }\n\n  /**\n   * Generate a session name from path\n   */\n  private generateSessionName(path: string): string {\n    // Remove leading slash and replace remaining slashes with dashes\n    return path\n      .replace(/^\\/+/, '')\n      .replace(/\\//g, '-')\n      .replace(/[^a-zA-Z0-9-_]/g, '')\n      || 'homepage';\n  }\n}\n\n/**\n * IBRSession - Simplified session with semantic understanding\n *\n * Provides a cleaner API for interacting with pages and getting\n * AI-friendly semantic output.\n */\nexport class IBRSession {\n  /** Raw Playwright page for advanced use */\n  readonly page: Page;\n\n  private browser: Browser;\n  private context: BrowserContext;\n  private config: Config;\n\n  constructor(page: Page, browser: Browser, context: BrowserContext, config: Config) {\n    this.page = page;\n    this.browser = browser;\n    this.context = context;\n    this.config = config;\n  }\n\n  /**\n   * Get semantic understanding of the current page\n   */\n  async understand(): Promise<SemanticResult> {\n    return getSemanticOutput(this.page);\n  }\n\n  /**\n   * Get semantic understanding as formatted text\n   */\n  async understandText(): Promise<string> {\n    const result = await getSemanticOutput(this.page);\n    return formatSemanticText(result);\n  }\n\n  /**\n   * Click an element by selector\n   */\n  async click(selector: string): Promise<void> {\n    await this.page.click(selector);\n  }\n\n  /**\n   * Type text into an element\n   */\n  async type(selector: string, text: string): Promise<void> {\n    await this.page.fill(selector, text);\n  }\n\n  /**\n   * Navigate to a new URL\n   */\n  async goto(url: string): Promise<void> {\n    await this.page.goto(url, {\n      waitUntil: 'domcontentloaded',\n      timeout: this.config.timeout,\n    });\n  }\n\n  /**\n   * Wait for a selector to appear\n   */\n  async waitFor(selector: string, timeout = 10000): Promise<void> {\n    await this.page.waitForSelector(selector, { timeout });\n  }\n\n  /**\n   * Take a screenshot\n   */\n  async screenshot(path?: string): Promise<Buffer> {\n    return this.page.screenshot({\n      path,\n      fullPage: this.config.fullPage,\n    });\n  }\n\n  /**\n   * Mock a network request (thin wrapper on page.route)\n   */\n  async mock(pattern: string | RegExp, response: {\n    status?: number;\n    body?: string | object;\n    headers?: Record<string, string>;\n  }): Promise<void> {\n    await this.page.route(pattern, async (route) => {\n      const body = typeof response.body === 'object'\n        ? JSON.stringify(response.body)\n        : response.body || '';\n\n      await route.fulfill({\n        status: response.status || 200,\n        body,\n        headers: {\n          'Content-Type': typeof response.body === 'object'\n            ? 'application/json'\n            : 'text/plain',\n          ...response.headers,\n        },\n      });\n    });\n  }\n\n  /**\n   * Built-in flows for common automation patterns\n   */\n  readonly flow = {\n    /**\n     * Login with email/password\n     * @example\n     * const result = await session.flow.login({ email: 'test@test.com', password: 'secret' });\n     */\n    login: (options: Omit<FlowLoginOptions, 'timeout'>) =>\n      loginFlow(this.page, { ...options, timeout: this.config.timeout }),\n\n    /**\n     * Search for content\n     * @example\n     * const result = await session.flow.search({ query: 'test' });\n     */\n    search: (options: Omit<FlowSearchOptions, 'timeout'>) =>\n      searchFlow(this.page, { ...options, timeout: this.config.timeout }),\n\n    /**\n     * Fill and submit a form\n     * @example\n     * const result = await session.flow.form({\n     *   fields: [{ name: 'email', value: 'test@test.com' }]\n     * });\n     */\n    form: (options: Omit<FlowFormOptions, 'timeout'>) =>\n      formFlow(this.page, { ...options, timeout: this.config.timeout }),\n  };\n\n  /**\n   * Measure Web Vitals performance metrics\n   * @example\n   * const result = await session.measurePerformance();\n   * console.log(result.ratings.LCP); // { value: 1200, rating: 'good' }\n   */\n  async measurePerformance() {\n    const { measurePerformance: mp } = await import('./performance.js');\n    return mp(this.page);\n  }\n\n  /**\n   * Test interactivity of buttons, links, and forms\n   * @example\n   * const result = await session.testInteractivity();\n   * console.log(result.issues); // List of issues with buttons/links\n   */\n  async testInteractivity() {\n    const { testInteractivity: ti } = await import('./interactivity.js');\n    return ti(this.page);\n  }\n\n  /**\n   * Start tracking API request timing\n   * Call before actions, then call stop() to get results\n   * @example\n   * const tracker = session.trackApiTiming({ filter: /\\/api\\// });\n   * tracker.start();\n   * await session.click('button');\n   * const result = tracker.stop();\n   */\n  trackApiTiming(options?: { filter?: RegExp; includeStatic?: boolean; minDuration?: number }) {\n    // Import synchronously for tracker creation\n    const createTracker = async () => {\n      const { createApiTracker } = await import('./api-timing.js');\n      return createApiTracker(this.page, options);\n    };\n    // Return a promise that resolves to the tracker\n    return createTracker();\n  }\n\n  /**\n   * Close the session and browser\n   */\n  async close(): Promise<void> {\n    await this.context.close();\n    await this.browser.close();\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\n// Standalone programmatic API (recommended for most users)\n// compare() and compareAll() are exported inline above\n// Types re-exported for convenience\n\n// Export everything for programmatic use\nexport * from './schemas.js';\nexport * from './types.js';\nexport { DEFAULT_DYNAMIC_SELECTORS } from './types.js';\nexport type { MaskOptions } from './types.js';\nexport { captureScreenshot, closeBrowser, getViewport, captureWithDiagnostics } from './capture.js';\nexport type { CaptureResult } from './capture.js';\nexport { checkConsistency, formatConsistencyReport } from './consistency.js';\nexport type { ConsistencyOptions, ConsistencyResult, PageMetrics, Inconsistency } from './consistency.js';\nexport { compareImages, analyzeComparison, getVerdictDescription, detectChangedRegions } from './compare.js';\nexport type { ExtendedComparisonResult } from './compare.js';\nexport { discoverPages, getNavigationLinks } from './crawl.js';\nexport type { CrawlOptions, CrawlResult, DiscoveredPage } from './crawl.js';\nexport {\n  createSession,\n  getSession,\n  updateSession,\n  markSessionCompared,\n  listSessions,\n  getMostRecentSession,\n  deleteSession,\n  cleanSessions,\n  getSessionPaths,\n  generateSessionId,\n  findSessions,\n  getTimeline,\n  getSessionsByRoute,\n  getSessionStats,\n} from './session.js';\nexport { generateReport, formatReportText, formatReportJson, formatReportMinimal, formatSessionSummary } from './report.js';\nexport {\n  extractApiCalls,\n  scanDirectoryForApiCalls,\n  discoverApiRoutes,\n  filePathToRoute,\n  findOrphanEndpoints,\n  groupByEndpoint,\n  groupByFile,\n  filterByMethod,\n  filterByEndpoint,\n} from './integration.js';\nexport type { ApiCall, ApiRoute } from './integration.js';\nexport { VIEWPORTS };\nexport {\n  registerOperation,\n  completeOperation,\n  getPendingOperations,\n  waitForCompletion,\n  formatPendingOperations,\n  withOperationTracking,\n} from './operation-tracker.js';\nexport type { PendingOperation, OperationState, OperationType } from './operation-tracker.js';\n\n// Semantic layer exports\nexport * from './semantic/index.js';\n\n// Flows exports\nexport * from './flows/index.js';\n\n// Cleanup and retention exports\nexport {\n  enforceRetentionPolicy,\n  maybeAutoClean,\n  getRetentionStatus,\n  formatRetentionStatus,\n  loadRetentionConfig,\n  DEFAULT_RETENTION,\n} from './cleanup.js';\nexport type { RetentionConfig, RetentionResult } from './cleanup.js';\n\n// Performance testing exports\nexport {\n  measureWebVitals,\n  measurePerformance,\n  formatPerformanceResult,\n  PERFORMANCE_THRESHOLDS,\n} from './performance.js';\nexport type {\n  WebVitals,\n  PerformanceResult,\n  PerformanceRating,\n  RatedMetric,\n} from './performance.js';\n\n// Interactivity testing exports\nexport {\n  testInteractivity,\n  formatInteractivityResult,\n} from './interactivity.js';\nexport type {\n  InteractivityResult,\n  InteractiveElement,\n  ButtonInfo,\n  LinkInfo,\n  FormInfo,\n  FormFieldInfo,\n  InteractivityIssue,\n} from './interactivity.js';\n\n// API timing exports\nexport {\n  measureApiTiming,\n  createApiTracker,\n  formatApiTimingResult,\n} from './api-timing.js';\nexport type {\n  ApiTimingResult,\n  ApiRequestTiming,\n  ApiTimingOptions,\n} from './api-timing.js';\n\n// Responsive testing exports\nexport {\n  testResponsive,\n  formatResponsiveResult,\n} from './responsive.js';\nexport type {\n  ResponsiveResult,\n  ViewportResult,\n  LayoutIssue,\n  TouchTargetIssue,\n  TextIssue,\n  ResponsiveTestOptions,\n} from './responsive.js';\n\n// Memory system exports\nexport {\n  initMemory,\n  loadSummary,\n  saveSummary,\n  addPreference,\n  getPreference,\n  removePreference,\n  listPreferences,\n  learnFromSession,\n  listLearned,\n  promoteToPreference,\n  rebuildSummary,\n  archiveSummary,\n  queryMemory,\n  preferencesToRules,\n  createMemoryPreset,\n  formatMemorySummary,\n  formatPreference,\n} from './memory.js';\n","import { chromium, type Page, type Browser } from 'playwright';\nimport { VIEWPORTS, type Viewport } from './schemas.js';\n\n/**\n * Layout issue detected during responsive testing\n */\nexport interface LayoutIssue {\n  element: string;\n  issue: 'overflow' | 'hidden' | 'truncated' | 'overlap' | 'too-small' | 'off-screen';\n  description: string;\n  bounds: { x: number; y: number; width: number; height: number };\n}\n\n/**\n * Touch target analysis\n */\nexport interface TouchTargetIssue {\n  element: string;\n  selector: string;\n  size: { width: number; height: number };\n  minimumSize: number;\n  isTooSmall: boolean;\n}\n\n/**\n * Text readability issue\n */\nexport interface TextIssue {\n  element: string;\n  issue: 'too-small' | 'low-contrast';\n  fontSize?: number;\n  contrastRatio?: number;\n}\n\n/**\n * Single viewport test result\n */\nexport interface ViewportResult {\n  viewport: Viewport;\n  viewportName: string;\n  layoutIssues: LayoutIssue[];\n  touchTargets: TouchTargetIssue[];\n  textIssues: TextIssue[];\n  screenshot?: string;\n}\n\n/**\n * Full responsive test result\n */\nexport interface ResponsiveResult {\n  url: string;\n  results: ViewportResult[];\n  summary: {\n    totalIssues: number;\n    viewportsWithIssues: number;\n    criticalIssues: number;\n  };\n}\n\n/**\n * Responsive test options\n */\nexport interface ResponsiveTestOptions {\n  /** Viewports to test. Defaults to desktop, tablet, mobile */\n  viewports?: Array<'desktop' | 'tablet' | 'mobile' | Viewport>;\n  /** Capture screenshots for each viewport */\n  captureScreenshots?: boolean;\n  /** Output directory for screenshots */\n  outputDir?: string;\n  /** Minimum touch target size (default: 44px per WCAG) */\n  minTouchTarget?: number;\n  /** Minimum font size (default: 12px) */\n  minFontSize?: number;\n  /** Timeout for page load */\n  timeout?: number;\n}\n\n/**\n * Test responsive behavior across multiple viewports\n */\nexport async function testResponsive(\n  url: string,\n  options: ResponsiveTestOptions = {}\n): Promise<ResponsiveResult> {\n  const {\n    viewports = ['desktop', 'tablet', 'mobile'],\n    captureScreenshots = false,\n    outputDir = './.ibr/responsive',\n    minTouchTarget = 44,\n    minFontSize = 12,\n    timeout = 30000,\n  } = options;\n\n  const results: ViewportResult[] = [];\n  let browser: Browser | null = null;\n\n  try {\n    browser = await chromium.launch({ headless: true });\n\n    for (const viewportSpec of viewports) {\n      // Resolve viewport\n      let viewport: Viewport;\n      let viewportName: string;\n\n      if (typeof viewportSpec === 'string') {\n        viewport = VIEWPORTS[viewportSpec];\n        viewportName = viewportSpec;\n      } else {\n        viewport = viewportSpec;\n        viewportName = `${viewportSpec.width}x${viewportSpec.height}`;\n      }\n\n      const context = await browser.newContext({\n        viewport: { width: viewport.width, height: viewport.height },\n        reducedMotion: 'reduce',\n      });\n\n      const page = await context.newPage();\n\n      try {\n        await page.goto(url, {\n          waitUntil: 'networkidle',\n          timeout,\n        });\n\n        // Wait for animations\n        await page.waitForTimeout(500);\n\n        // Run viewport-specific tests\n        const result = await analyzeViewport(page, viewport, viewportName, {\n          minTouchTarget,\n          minFontSize,\n        });\n\n        // Capture screenshot if requested\n        if (captureScreenshots) {\n          const { mkdir } = await import('fs/promises');\n          await mkdir(outputDir, { recursive: true });\n          const screenshotPath = `${outputDir}/${viewportName}.png`;\n          await page.screenshot({ path: screenshotPath, fullPage: true });\n          result.screenshot = screenshotPath;\n        }\n\n        results.push(result);\n      } finally {\n        await context.close();\n      }\n    }\n  } finally {\n    if (browser) {\n      await browser.close();\n    }\n  }\n\n  // Calculate summary\n  const totalIssues = results.reduce(\n    (sum, r) => sum + r.layoutIssues.length + r.touchTargets.filter(t => t.isTooSmall).length + r.textIssues.length,\n    0\n  );\n  const viewportsWithIssues = results.filter(\n    r => r.layoutIssues.length > 0 || r.touchTargets.some(t => t.isTooSmall) || r.textIssues.length > 0\n  ).length;\n  const criticalIssues = results.reduce(\n    (sum, r) => sum + r.layoutIssues.filter(i => i.issue === 'overflow' || i.issue === 'hidden').length,\n    0\n  );\n\n  return {\n    url,\n    results,\n    summary: {\n      totalIssues,\n      viewportsWithIssues,\n      criticalIssues,\n    },\n  };\n}\n\n/**\n * Analyze a single viewport for responsive issues\n */\nasync function analyzeViewport(\n  page: Page,\n  viewport: Viewport,\n  viewportName: string,\n  options: { minTouchTarget: number; minFontSize: number }\n): Promise<ViewportResult> {\n  const isMobile = viewport.width < 768;\n\n  const analysisResult = await page.evaluate(({ viewportWidth, minTouchTarget, minFontSize, isMobile }) => {\n    const layoutIssues: LayoutIssue[] = [];\n    const touchTargets: TouchTargetIssue[] = [];\n    const textIssues: TextIssue[] = [];\n\n    // Helper to get unique selector\n    function getSelector(el: Element): string {\n      if ((el as HTMLElement).id) return `#${(el as HTMLElement).id}`;\n      const classes = Array.from(el.classList).slice(0, 2).join('.');\n      const tag = el.tagName.toLowerCase();\n      if (classes) return `${tag}.${classes}`;\n      return tag;\n    }\n\n    // Check for horizontal overflow\n    const bodyWidth = document.body.scrollWidth;\n    if (bodyWidth > viewportWidth) {\n      layoutIssues.push({\n        element: 'body',\n        issue: 'overflow',\n        description: `Page has horizontal overflow (${bodyWidth}px > ${viewportWidth}px viewport)`,\n        bounds: { x: 0, y: 0, width: bodyWidth, height: document.body.scrollHeight },\n      });\n    }\n\n    // Check all elements for layout issues\n    const allElements = Array.from(document.querySelectorAll('*'));\n    for (const el of allElements) {\n      const rect = el.getBoundingClientRect();\n      const style = window.getComputedStyle(el);\n\n      // Skip invisible elements\n      if (style.display === 'none' || style.visibility === 'hidden' || rect.width === 0 || rect.height === 0) {\n        continue;\n      }\n\n      // Check for elements extending beyond viewport\n      if (rect.right > viewportWidth + 10) { // 10px tolerance\n        layoutIssues.push({\n          element: getSelector(el),\n          issue: 'overflow',\n          description: `Element extends ${Math.round(rect.right - viewportWidth)}px beyond viewport`,\n          bounds: { x: rect.x, y: rect.y, width: rect.width, height: rect.height },\n        });\n      }\n\n      // Check for truncated text (text-overflow: ellipsis with overflow)\n      if (style.textOverflow === 'ellipsis' && style.overflow === 'hidden') {\n        const scrollWidth = (el as HTMLElement).scrollWidth;\n        const clientWidth = (el as HTMLElement).clientWidth;\n        if (scrollWidth > clientWidth) {\n          layoutIssues.push({\n            element: getSelector(el),\n            issue: 'truncated',\n            description: 'Text is truncated with ellipsis',\n            bounds: { x: rect.x, y: rect.y, width: rect.width, height: rect.height },\n          });\n        }\n      }\n    }\n\n    // Check touch targets (only on mobile-sized viewports)\n    if (isMobile) {\n      const interactiveElements = Array.from(document.querySelectorAll(\n        'a, button, [role=\"button\"], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n      ));\n\n      for (const el of interactiveElements) {\n        const rect = el.getBoundingClientRect();\n        const style = window.getComputedStyle(el);\n\n        if (style.display === 'none' || style.visibility === 'hidden') {\n          continue;\n        }\n\n        const width = rect.width;\n        const height = rect.height;\n        const isTooSmall = width < minTouchTarget || height < minTouchTarget;\n\n        touchTargets.push({\n          element: el.textContent?.trim().slice(0, 30) || getSelector(el),\n          selector: getSelector(el),\n          size: { width: Math.round(width), height: Math.round(height) },\n          minimumSize: minTouchTarget,\n          isTooSmall,\n        });\n      }\n    }\n\n    // Check text sizes\n    const textElements = Array.from(document.querySelectorAll('p, span, a, li, td, th, label, h1, h2, h3, h4, h5, h6'));\n    for (const el of textElements) {\n      const style = window.getComputedStyle(el);\n      const fontSize = parseFloat(style.fontSize);\n\n      if (fontSize < minFontSize && el.textContent?.trim()) {\n        textIssues.push({\n          element: getSelector(el),\n          issue: 'too-small',\n          fontSize: Math.round(fontSize),\n        });\n      }\n    }\n\n    return { layoutIssues, touchTargets, textIssues };\n  }, {\n    viewportWidth: viewport.width,\n    minTouchTarget: options.minTouchTarget,\n    minFontSize: options.minFontSize,\n    isMobile,\n  });\n\n  return {\n    viewport,\n    viewportName,\n    ...analysisResult,\n  };\n}\n\n/**\n * Format responsive test result for console output\n */\nexport function formatResponsiveResult(result: ResponsiveResult): string {\n  const lines: string[] = [];\n\n  lines.push('Responsive Test Results');\n  lines.push('=======================');\n  lines.push('');\n  lines.push(`URL: ${result.url}`);\n  lines.push(`Viewports tested: ${result.results.length}`);\n  lines.push('');\n\n  // Summary\n  const icon = result.summary.criticalIssues > 0 ? '\\x1b[31m\\x1b[0m' :\n               result.summary.totalIssues > 0 ? '\\x1b[33m!\\x1b[0m' : '\\x1b[32m\\x1b[0m';\n  lines.push(`${icon} Total issues: ${result.summary.totalIssues}`);\n  lines.push(`   Critical: ${result.summary.criticalIssues}`);\n  lines.push(`   Viewports with issues: ${result.summary.viewportsWithIssues}/${result.results.length}`);\n  lines.push('');\n\n  // Per-viewport results\n  for (const vr of result.results) {\n    const issueCount = vr.layoutIssues.length +\n                       vr.touchTargets.filter(t => t.isTooSmall).length +\n                       vr.textIssues.length;\n\n    const vpIcon = issueCount === 0 ? '\\x1b[32m\\x1b[0m' : '\\x1b[33m!\\x1b[0m';\n    lines.push(`${vpIcon} ${vr.viewportName} (${vr.viewport.width}x${vr.viewport.height})`);\n\n    if (issueCount === 0) {\n      lines.push('   No issues detected');\n    } else {\n      // Layout issues\n      if (vr.layoutIssues.length > 0) {\n        lines.push('   Layout issues:');\n        for (const issue of vr.layoutIssues.slice(0, 5)) {\n          lines.push(`     ! ${issue.issue}: ${issue.description}`);\n        }\n        if (vr.layoutIssues.length > 5) {\n          lines.push(`     ... and ${vr.layoutIssues.length - 5} more`);\n        }\n      }\n\n      // Touch targets\n      const smallTargets = vr.touchTargets.filter(t => t.isTooSmall);\n      if (smallTargets.length > 0) {\n        lines.push('   Small touch targets:');\n        for (const target of smallTargets.slice(0, 5)) {\n          lines.push(`     ! \"${target.element}\" is ${target.size.width}x${target.size.height}px (min: ${target.minimumSize}px)`);\n        }\n        if (smallTargets.length > 5) {\n          lines.push(`     ... and ${smallTargets.length - 5} more`);\n        }\n      }\n\n      // Text issues\n      if (vr.textIssues.length > 0) {\n        lines.push('   Text issues:');\n        for (const issue of vr.textIssues.slice(0, 5)) {\n          lines.push(`     ! ${issue.element}: ${issue.issue} (${issue.fontSize}px)`);\n        }\n        if (vr.textIssues.length > 5) {\n          lines.push(`     ... and ${vr.textIssues.length - 5} more`);\n        }\n      }\n    }\n\n    if (vr.screenshot) {\n      lines.push(`   Screenshot: ${vr.screenshot}`);\n    }\n\n    lines.push('');\n  }\n\n  return lines.join('\\n');\n}\n","/**\n * Memory System - Persistent UI/UX preferences with eviction and summarization\n *\n * Follows the \"Deep Agents\" context management pattern:\n * - summary.json: Always-loaded compact file (< 2KB)\n * - preferences/: Full preference detail files\n * - learned/: Expectations extracted from approved sessions\n * - archive/: Previous summary snapshots (eviction)\n */\n\nimport { readFile, writeFile, mkdir, readdir, unlink, copyFile } from 'fs/promises';\nimport { existsSync } from 'fs';\nimport { join } from 'path';\nimport { nanoid } from 'nanoid';\nimport type {\n  MemorySummary,\n  Preference,\n  PreferenceCategory,\n  LearnedExpectation,\n  ActivePreference,\n  Observation,\n  ExpectationOperator,\n  MemorySource,\n  Violation,\n  EnhancedElement,\n  Session,\n} from './schemas.js';\nimport type { Rule, RuleContext, RulePreset } from './rules/engine.js';\n\n// ============================================================================\n// CONSTANTS\n// ============================================================================\n\nconst MEMORY_DIR = 'memory';\nconst SUMMARY_FILE = 'summary.json';\nconst PREFERENCES_DIR = 'preferences';\nconst LEARNED_DIR = 'learned';\nconst ARCHIVE_DIR = 'archive';\nconst PREF_PREFIX = 'pref_';\nconst LEARN_PREFIX = 'learn_';\nconst MAX_ACTIVE_PREFERENCES = 50;\n\n// ============================================================================\n// INITIALIZATION\n// ============================================================================\n\n/**\n * Ensure memory directory structure exists\n */\nexport async function initMemory(outputDir: string): Promise<void> {\n  const memoryDir = join(outputDir, MEMORY_DIR);\n  await mkdir(join(memoryDir, PREFERENCES_DIR), { recursive: true });\n  await mkdir(join(memoryDir, LEARNED_DIR), { recursive: true });\n  await mkdir(join(memoryDir, ARCHIVE_DIR), { recursive: true });\n}\n\n// ============================================================================\n// SUMMARY (Always-loaded compact state)\n// ============================================================================\n\nfunction getMemoryPath(outputDir: string, ...segments: string[]): string {\n  return join(outputDir, MEMORY_DIR, ...segments);\n}\n\n/**\n * Load the compact summary - the \"working memory\"\n */\nexport async function loadSummary(outputDir: string): Promise<MemorySummary> {\n  const summaryPath = getMemoryPath(outputDir, SUMMARY_FILE);\n\n  if (!existsSync(summaryPath)) {\n    return createEmptySummary();\n  }\n\n  try {\n    const content = await readFile(summaryPath, 'utf-8');\n    return JSON.parse(content) as MemorySummary;\n  } catch {\n    return createEmptySummary();\n  }\n}\n\n/**\n * Save the compact summary\n */\nexport async function saveSummary(outputDir: string, summary: MemorySummary): Promise<void> {\n  await initMemory(outputDir);\n  const summaryPath = getMemoryPath(outputDir, SUMMARY_FILE);\n  await writeFile(summaryPath, JSON.stringify(summary, null, 2));\n}\n\nfunction createEmptySummary(): MemorySummary {\n  return {\n    version: 1,\n    updatedAt: new Date().toISOString(),\n    stats: {\n      totalPreferences: 0,\n      totalLearned: 0,\n      byCategory: {},\n      bySource: {},\n    },\n    activePreferences: [],\n  };\n}\n\n// ============================================================================\n// PREFERENCE CRUD\n// ============================================================================\n\n/**\n * Add a new UI/UX preference\n */\nexport async function addPreference(\n  outputDir: string,\n  input: {\n    description: string;\n    category: PreferenceCategory;\n    source?: MemorySource;\n    route?: string;\n    componentType?: string;\n    property: string;\n    operator?: ExpectationOperator;\n    value: string;\n    confidence?: number;\n    sessionIds?: string[];\n  }\n): Promise<Preference> {\n  await initMemory(outputDir);\n\n  const now = new Date().toISOString();\n  const pref: Preference = {\n    id: `${PREF_PREFIX}${nanoid(8)}`,\n    description: input.description,\n    category: input.category,\n    source: input.source ?? 'user',\n    route: input.route,\n    componentType: input.componentType,\n    expectation: {\n      property: input.property,\n      operator: input.operator ?? 'equals',\n      value: input.value,\n    },\n    confidence: input.confidence ?? 1.0,\n    createdAt: now,\n    updatedAt: now,\n    sessionIds: input.sessionIds,\n  };\n\n  // Write full preference file\n  const prefPath = getMemoryPath(outputDir, PREFERENCES_DIR, `${pref.id}.json`);\n  await writeFile(prefPath, JSON.stringify(pref, null, 2));\n\n  // Rebuild summary\n  await rebuildSummary(outputDir);\n\n  return pref;\n}\n\n/**\n * Get full preference detail by ID\n */\nexport async function getPreference(outputDir: string, prefId: string): Promise<Preference | null> {\n  const prefPath = getMemoryPath(outputDir, PREFERENCES_DIR, `${prefId}.json`);\n\n  if (!existsSync(prefPath)) return null;\n\n  try {\n    const content = await readFile(prefPath, 'utf-8');\n    return JSON.parse(content) as Preference;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Remove a preference\n */\nexport async function removePreference(outputDir: string, prefId: string): Promise<boolean> {\n  const prefPath = getMemoryPath(outputDir, PREFERENCES_DIR, `${prefId}.json`);\n\n  if (!existsSync(prefPath)) return false;\n\n  await unlink(prefPath);\n  await rebuildSummary(outputDir);\n  return true;\n}\n\n/**\n * List preferences with optional filter\n */\nexport async function listPreferences(\n  outputDir: string,\n  filter?: { category?: PreferenceCategory; route?: string; componentType?: string }\n): Promise<Preference[]> {\n  const prefsDir = getMemoryPath(outputDir, PREFERENCES_DIR);\n\n  if (!existsSync(prefsDir)) return [];\n\n  const files = await readdir(prefsDir);\n  const prefs: Preference[] = [];\n\n  for (const file of files) {\n    if (!file.endsWith('.json')) continue;\n    try {\n      const content = await readFile(join(prefsDir, file), 'utf-8');\n      const pref = JSON.parse(content) as Preference;\n\n      if (filter?.category && pref.category !== filter.category) continue;\n      if (filter?.route && pref.route !== filter.route) continue;\n      if (filter?.componentType && pref.componentType !== filter.componentType) continue;\n\n      prefs.push(pref);\n    } catch {\n      // Skip malformed files\n    }\n  }\n\n  return prefs.sort((a, b) => b.confidence - a.confidence);\n}\n\n// ============================================================================\n// LEARNING FROM SESSIONS\n// ============================================================================\n\n/**\n * Extract and store expectations from an approved session\n */\nexport async function learnFromSession(\n  outputDir: string,\n  session: Session,\n  observations: Observation[]\n): Promise<LearnedExpectation> {\n  await initMemory(outputDir);\n\n  const route = new URL(session.url).pathname;\n  const learned: LearnedExpectation = {\n    id: `${LEARN_PREFIX}${nanoid(8)}`,\n    sessionId: session.id,\n    route,\n    observations,\n    approved: true,\n    createdAt: new Date().toISOString(),\n  };\n\n  const learnPath = getMemoryPath(outputDir, LEARNED_DIR, `${learned.id}.json`);\n  await writeFile(learnPath, JSON.stringify(learned, null, 2));\n\n  return learned;\n}\n\n/**\n * List learned expectations\n */\nexport async function listLearned(outputDir: string): Promise<LearnedExpectation[]> {\n  const learnedDir = getMemoryPath(outputDir, LEARNED_DIR);\n\n  if (!existsSync(learnedDir)) return [];\n\n  const files = await readdir(learnedDir);\n  const items: LearnedExpectation[] = [];\n\n  for (const file of files) {\n    if (!file.endsWith('.json')) continue;\n    try {\n      const content = await readFile(join(learnedDir, file), 'utf-8');\n      items.push(JSON.parse(content) as LearnedExpectation);\n    } catch {\n      // Skip malformed\n    }\n  }\n\n  return items.sort((a, b) => b.createdAt.localeCompare(a.createdAt));\n}\n\n/**\n * Promote a learned expectation to a full preference\n */\nexport async function promoteToPreference(\n  outputDir: string,\n  learnedId: string\n): Promise<Preference | null> {\n  const learnedPath = getMemoryPath(outputDir, LEARNED_DIR, `${learnedId}.json`);\n\n  if (!existsSync(learnedPath)) return null;\n\n  const content = await readFile(learnedPath, 'utf-8');\n  const learned = JSON.parse(content) as LearnedExpectation;\n\n  if (learned.observations.length === 0) return null;\n\n  // Promote first observation as the primary preference\n  const obs = learned.observations[0];\n  const pref = await addPreference(outputDir, {\n    description: obs.description,\n    category: obs.category,\n    source: 'learned',\n    route: learned.route,\n    property: obs.property,\n    value: obs.value,\n    confidence: 0.8,\n    sessionIds: [learned.sessionId],\n  });\n\n  return pref;\n}\n\n// ============================================================================\n// SUMMARIZATION & EVICTION\n// ============================================================================\n\n/**\n * Rebuild summary from all preference files (summarization pattern)\n */\nexport async function rebuildSummary(outputDir: string): Promise<MemorySummary> {\n  // Archive current summary (eviction pattern)\n  await archiveSummary(outputDir);\n\n  const prefs = await listPreferences(outputDir);\n  const learned = await listLearned(outputDir);\n\n  // Compute stats\n  const byCategory: Record<string, number> = {};\n  const bySource: Record<string, number> = {};\n\n  for (const pref of prefs) {\n    byCategory[pref.category] = (byCategory[pref.category] || 0) + 1;\n    bySource[pref.source] = (bySource[pref.source] || 0) + 1;\n  }\n\n  // Build compact active preferences (only top N by confidence)\n  const activePrefs = prefs\n    .slice(0, MAX_ACTIVE_PREFERENCES)\n    .map((pref): ActivePreference => ({\n      id: pref.id,\n      description: pref.description,\n      category: pref.category,\n      route: pref.route,\n      componentType: pref.componentType,\n      property: pref.expectation.property,\n      operator: pref.expectation.operator,\n      value: pref.expectation.value,\n      confidence: pref.confidence,\n    }));\n\n  const summary: MemorySummary = {\n    version: 1,\n    updatedAt: new Date().toISOString(),\n    stats: {\n      totalPreferences: prefs.length,\n      totalLearned: learned.length,\n      byCategory,\n      bySource,\n    },\n    activePreferences: activePrefs,\n  };\n\n  await saveSummary(outputDir, summary);\n  return summary;\n}\n\n/**\n * Archive current summary before rebuilding (eviction pattern)\n */\nexport async function archiveSummary(outputDir: string): Promise<void> {\n  const summaryPath = getMemoryPath(outputDir, SUMMARY_FILE);\n\n  if (!existsSync(summaryPath)) return;\n\n  const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n  const archivePath = getMemoryPath(outputDir, ARCHIVE_DIR, `summary_${timestamp}.json`);\n\n  try {\n    await copyFile(summaryPath, archivePath);\n  } catch {\n    // Non-critical if archive fails\n  }\n}\n\n// ============================================================================\n// QUERY\n// ============================================================================\n\n/**\n * Query memory for preferences matching criteria\n */\nexport async function queryMemory(\n  outputDir: string,\n  query: { route?: string; category?: string; componentType?: string }\n): Promise<ActivePreference[]> {\n  const summary = await loadSummary(outputDir);\n\n  return summary.activePreferences.filter(pref => {\n    if (query.route && pref.route && !query.route.includes(pref.route)) return false;\n    if (query.category && pref.category !== query.category) return false;\n    if (query.componentType && pref.componentType !== query.componentType) return false;\n    return true;\n  });\n}\n\n// ============================================================================\n// RULES BRIDGE\n// ============================================================================\n\n/**\n * Evaluate an operator against actual and expected values\n */\nfunction evaluateOperator(operator: ExpectationOperator, actual: string, expected: string): boolean {\n  switch (operator) {\n    case 'equals':\n      return actual.toLowerCase() === expected.toLowerCase();\n    case 'contains':\n      return actual.toLowerCase().includes(expected.toLowerCase());\n    case 'matches':\n      try {\n        return new RegExp(expected, 'i').test(actual);\n      } catch {\n        return false;\n      }\n    case 'gte':\n      return parseFloat(actual) >= parseFloat(expected);\n    case 'lte':\n      return parseFloat(actual) <= parseFloat(expected);\n    default:\n      return false;\n  }\n}\n\n/**\n * Convert memory preferences into Rule objects for the rules engine\n */\nexport function preferencesToRules(preferences: ActivePreference[]): Rule[] {\n  return preferences.map((pref): Rule => ({\n    id: `memory-${pref.id}`,\n    name: `Memory: ${pref.description}`,\n    description: `User preference: ${pref.description}`,\n    defaultSeverity: pref.confidence >= 0.8 ? 'error' : 'warn',\n    check: (element: EnhancedElement, context: RuleContext): Violation | null => {\n      // Route scoping\n      if (pref.route && !context.url.includes(pref.route)) return null;\n\n      // Component type scoping\n      if (pref.componentType) {\n        const matchesTag = element.tagName.toLowerCase() === pref.componentType.toLowerCase();\n        const matchesRole = element.a11y?.role?.toLowerCase() === pref.componentType.toLowerCase();\n        if (!matchesTag && !matchesRole) return null;\n      }\n\n      // Property check against computed styles\n      const styles = element.computedStyles;\n      if (!styles) return null;\n\n      const actual = styles[pref.property];\n      if (!actual) return null;\n\n      if (evaluateOperator(pref.operator, actual, pref.value)) return null;\n\n      return {\n        ruleId: `memory-${pref.id}`,\n        ruleName: `Memory: ${pref.description}`,\n        severity: pref.confidence >= 0.8 ? 'error' : 'warn',\n        message: `Expected ${pref.property} to ${pref.operator} \"${pref.value}\", got \"${actual}\". (${pref.description})`,\n        element: element.selector,\n        bounds: element.bounds,\n        fix: `Update ${pref.property} to ${pref.value}`,\n      };\n    },\n  }));\n}\n\n/**\n * Create a RulePreset from memory preferences\n */\nexport function createMemoryPreset(preferences: ActivePreference[]): RulePreset {\n  const rules = preferencesToRules(preferences);\n  const defaults: Record<string, 'warn' | 'error'> = {};\n\n  for (const rule of rules) {\n    defaults[rule.id] = rule.defaultSeverity;\n  }\n\n  return {\n    name: 'memory',\n    description: 'UI/UX preferences from IBR memory',\n    rules,\n    defaults,\n  };\n}\n\n// ============================================================================\n// FORMAT\n// ============================================================================\n\n/**\n * Format memory summary for CLI output\n */\nexport function formatMemorySummary(summary: MemorySummary): string {\n  const lines: string[] = [];\n\n  lines.push('IBR Memory');\n  lines.push(`Updated: ${summary.updatedAt}`);\n  lines.push('');\n  lines.push(`Preferences: ${summary.stats.totalPreferences}`);\n  lines.push(`Learned: ${summary.stats.totalLearned}`);\n\n  if (Object.keys(summary.stats.byCategory).length > 0) {\n    lines.push('');\n    lines.push('By category:');\n    for (const [cat, count] of Object.entries(summary.stats.byCategory)) {\n      lines.push(`  ${cat}: ${count}`);\n    }\n  }\n\n  if (summary.activePreferences.length > 0) {\n    lines.push('');\n    lines.push('Active preferences:');\n    for (const pref of summary.activePreferences) {\n      const scope = pref.route ? ` (${pref.route})` : ' (global)';\n      const conf = pref.confidence < 1.0 ? ` [${Math.round(pref.confidence * 100)}%]` : '';\n      lines.push(`  ${pref.id}: ${pref.description}${scope}${conf}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format a single preference for display\n */\nexport function formatPreference(pref: Preference): string {\n  const lines: string[] = [];\n\n  lines.push(`ID: ${pref.id}`);\n  lines.push(`Description: ${pref.description}`);\n  lines.push(`Category: ${pref.category}`);\n  lines.push(`Source: ${pref.source}`);\n  lines.push(`Confidence: ${Math.round(pref.confidence * 100)}%`);\n  lines.push(`Expectation: ${pref.expectation.property} ${pref.expectation.operator} \"${pref.expectation.value}\"`);\n\n  if (pref.route) lines.push(`Route: ${pref.route}`);\n  if (pref.componentType) lines.push(`Component: ${pref.componentType}`);\n  if (pref.sessionIds?.length) lines.push(`Sessions: ${pref.sessionIds.join(', ')}`);\n\n  lines.push(`Created: ${pref.createdAt}`);\n  lines.push(`Updated: ${pref.updatedAt}`);\n\n  return lines.join('\\n');\n}\n"]}